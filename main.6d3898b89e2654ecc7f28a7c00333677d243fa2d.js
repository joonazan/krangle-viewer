function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _createSuper(e){var t=_isNativeReflectConstruct();return function(){var n,i=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _createForOfIteratorHelper(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,o=function(){};return{s:o,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,a=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,r=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw r}}}}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function ownKeys(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function _objectSpread(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ownKeys(Object(n),!0).forEach((function(t){_defineProperty(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function _iterableToArrayLimit(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,o,r=[],a=!0,s=!1;try{for(n=n.call(e);!(a=(i=n.next()).done)&&(r.push(i.value),!t||r.length!==t);a=!0);}catch(e){s=!0,o=e}finally{try{a||null==n.return||n.return()}finally{if(s)throw o}}return r}}function _arrayWithHoles(e){if(Array.isArray(e))return e}define("PoE/Environment/Font",["require","jquery","webfont"],(function(e){for(var t=e("jquery"),n=e("webfont"),i=["FontinRegular"],o={},r=0,a=i.length;r<a;++r)o[i[r]]=t.Deferred();return{waitLoad:function(e){if(o[e])return o[e].promise();console.warn("Font not found: "+e);var n=t.Deferred();return n.reject(),n.promise()},loadFonts:function(){n.load({custom:{families:i},loading:function(){},active:function(){},inactive:function(){},fontloading:function(e,t){},fontactive:function(e,t){o[e]&&o[e].resolve()},fontinactive:function(e,t){o[e]&&o[e].reject()}})}}})),define("PoE/Loader",["require","nprogress"],(function(e){var t=e("nprogress");return{start:function(){t.start()},done:function(){t.done()},abort:function(){t.done()},follow:function(e){var t=this;return this.start(),e.then((function(){t.done()}),(function(){t.abort()}))}}})),define("PoE/Item/DisplayProperty/ValueStyle",[],(function(){return{Default:0,Augmented:1,Unmet:2,PhysicalDamage:3,FireDamage:4,ColdDamage:5,LightningDamage:6,ChaosDamage:7,MagicItem:8,RareItem:9,UniqueItem:10,NotableReminder:11,Unreachable:15,CurrencyItem:18,ItemQuantity:19,DivinationCard:20}})),define("PoE/Item/DisplayProperty/DisplayMode",[],(function(){return{NameValue:0,ValueName:1,Progress:2,Inject:3}})),define("PoE/Item/FrameType",[],(function(){return{Normal:0,Magic:1,Rare:2,Unique:3,Gem:4,Currency:5,DivinationCard:6,Quest:7,Prophecy:8,Foil:9,SupporterFoil:10}})),define("PoE/Item/Popup/Constants",[],(function(){return{MinWidth:262.88032454361,Padding:6.0851926977688,MaxWidth:742.39350912779,MaxDescriptionWidth:365.11156186613}})),define("PoE/Item/Markup",["Handlebars","jquery"],(function(e,t){return{PoEMarkup:function(e,n){n||(n=.5);var i=function(e){var n=t(t(e).parent()).css("font-size");return n=n.substr(0,n.length-2),Math.round(n)};e.find(".PoEMarkup").each((function(){var e=this,o=t(e).data("markup"),r=!1;if(o&&o.indexOf("size")>=0)(a=o.substr(o.indexOf(":")+1,o.length)).indexOf("+")>=0?a=i(e)+a.substr(1,a.length):a.indexOf("-")>=0&&(a=i(e)-a.substr(1,a.length)),r={"font-size":(a*=n)+"px"};else if(o&&o.indexOf("bigger")>=0){r={"font-size":(a=i(e)+3)+"px"}}else if(o&&o.indexOf("smaller")>=0){var a;r={"font-size":(a=i(e)-3)+"px"}}r&&t(e).css(r)}))},splitTags:function(e){for(var t={items:[],lastIndex:0,pre:[]},n=!0;e.indexOf("<")>=0||e.indexOf(">")>=0;){var i=1,o={tag:"",pre:"",content:"",post:""};"<"==e.charAt(e.indexOf("<")+1)?i=2:n=!1;var r=e.indexOf("<"),a=e.indexOf("<");n||(o.pre=e.substr(0,r),o.pre.length>0&&(0===o.pre.indexOf("{")&&(o.pre=o.pre.substr(1)),t.pre.push(o.pre))),o.tag=e.substr(r+i,e.indexOf(">")-i-a),t.lastIndex+=e.indexOf(">")+i,0==(e=e.substr(e.indexOf(">")+i)).indexOf("{")&&e.indexOf("}")>0&&(e.indexOf("}")<e.indexOf("<")||-1==e.indexOf("<"))&&(t.lastIndex+=e.indexOf("}")+1,o.content=e.substr(1,e.indexOf("}")-1),(e=e.substr(e.indexOf("}")+1)).indexOf("<")>=0&&(t.lastIndex+=e.indexOf("<"),o.post=e.substr(0,e.indexOf("<")),e=e.substr(e.indexOf("<")))),t.items.push(o)}return t},markupToObj:function(e,t){var n={pre:"",content:"",post:"",tags:{}};if(e.indexOf("<")>=0){n.pre+=e.substr(0,e.indexOf("<"));var i=0;(e=e.substr(e.indexOf("<"))).lastIndexOf("}")>0&&(i=e.lastIndexOf("}")),e.lastIndexOf(">")>0&&e.lastIndexOf(">")>i&&(i=e.lastIndexOf(">")),i>0&&(n.post=e.substr(i+1),e=e.substr(0,i+1)),e.indexOf("{")>=0?(n.tags=this.splitTags(e),e=e.substr(n.tags.lastIndex),n.content=this.markupToObj(e,n),e=""):(n.tags=this.splitTags(e),n.content=e.substr(n.tags.lastIndex),e="")}else n.content=e;if(n.tags.pre)for(var o in n.tags.pre)n.tags.pre.hasOwnProperty(o)&&(n.pre+=this.markupObjToHTML(this.markupToObj(n.tags.pre[o])));return n},markupObjToHTML:function(t){"object"==_typeof(t.content)&&(t.content=this.markupObjToHTML(t.content));var n=t.pre;if(t.tags&&t.tags.items&&t.tags.items.length>0){var i=[],o=[],r=[],a=0;for(var s in t.tags.items){0==(g=(h=t.tags.items[s]).tag).indexOf("set:")?i.push(g.substr(g.indexOf("set:")+4)):0===g.indexOf("if:")?(o[++a]=o[a]||[],o[a].push(h)):0===g.indexOf("elif:")||0===g.indexOf("else:")?o[a].push(h):(r[a]=r[a]||[],r[a].push(h))}if(o.length>0){for(var l=[],c=!1,d=[],u=1;u<=a;u++)for(var s in o[u]){var h,p=(g=(h=o[u][s]).tag).substr(0,g.indexOf(":")),f=g.substr(g.indexOf(":")+1);for(var v in i)if(o[u].hasOwnProperty(s)&&i.hasOwnProperty(v)){var m=i[v];g.pre&&(n+=g.pre),"if"==p&&m==f?l[u]=h:("elif"!=p||m!=f||l&&l[u])&&("else"!=p||l&&l[u])?"MS"!=f||c[u]&&0!=c[u].length||(c[u]=h):l[u]=h}h.post&&(d[u]||(d[u]=""),d[u]+=h.post)}for(u=1;u<=a;u++)for(var s in l&&l[u]?n+=l[u].content+l[u].post:!l&&c[u]&&(n+=c[u].content+c[u].post),d[u])n+=d[u][s]}for(var u in r){var g="";if(r.hasOwnProperty(u))for(var s in r[u])if(r[u].hasOwnProperty(s))if(""===r[u][s].content)g=r[u][s].tag;else{var y=""!==g&&-1!==g.indexOf("size"),b=y?g:r[u][s].tag,w=y?" "+g.replace(":","_"):"";n+='<span class="PoEMarkup '+r[u][s].tag.replace(":","_")+w+'" data-markup="'+b+'">'+r[u][s].content+"</span>\n",g=""}}}else n+=t.content;return(n+=t.post).length>0&&(n=new e.SafeString(n.replace(/\r/g,"<br />"))),n},recMarkup:function(e){if(e&&e.flavourText&&(e.flavourText=e.flavourText.join("\n")),e&&e.toHTML)return e;if("string"==typeof e){var t=this.markupToObj(e);return this.markupObjToHTML(t)}if("object"==_typeof(e)){for(var n in e)e.hasOwnProperty(n)&&"note"!=n&&(e[n]=this.recMarkup(e[n]));return e}return e}}})),define("PoE/Environment",[],(function(){var e="undefined"!=typeof process&&process.versions&&process.versions.node,t=null,n=null;return{isNode:function(){return e},isBrowser:function(){return!e},getAppRoot:function(){return t},getJsDir:function(){return n},config:function(e){e&&(e.appRoot&&(t=e.appRoot),e.jsDir&&(n=e.jsDir))}}})),define("PoE/Handlebars/TemplateCollection",["jquery","Handlebars","PoE/Environment"],(function(e,t,n){var i={};return{load:function(n,o){return n=n.replace(/^\/*/,""),e.Deferred((function(e){void 0===i[n]?require(["text!"+n],(function(o){i[n]=t.compile(o),e.resolve(i[n])})):e.resolve(i[n])})).promise()}}})),define("text!PoE/Item/DivinationCard.hbt",[],(function(){return'<div class="cardFace">\r\n    <img src="{{cardFace}}">\r\n</div>\r\n<div class="itemBoxContent">\r\n    <div class="itemHeader {{#if headerTwoLine}}doubleLine{{/if}}">\r\n        <span class="l"></span>\r\n        {{#if typeLine}}\r\n        <div class="itemName typeLine">\r\n            <span class="lc">{{typeLine}}</span>\r\n        </div>\r\n        {{/if}}\r\n        <span class="r"></span>\r\n    </div>\r\n    {{#if stackSize}}\r\n    <div class="stackSize">{{stackSize}}/{{maxStackSize}}</div>\r\n    {{/if}}\r\n    <div class="itemCardInfo">\r\n        {{#if explicitMods}}\r\n        <div class="itemCardInfoTop">\r\n            {{#each explicitMods}}<div class="explicitMod"><span class="lc">{{#each this}}{{#if @index}}<br>{{/if}}{{{this}}}{{/each}}</span></div>{{/each}}\r\n        </div>\r\n        {{/if}}\r\n        <div class="itemCardInfoDivider"></div>\r\n        {{#ifCond flavourText \'||\' flavourTextParsed}}\r\n        <div class="itemCardInfoBottom">\r\n            {{#if flavourTextParsed}}\r\n                {{#each (parsedMarkupDisplay flavourTextParsed)}}<div class="flavourText"><span class="lc">{{{this}}}</span></div>{{/each}}\r\n            {{/if}}\r\n            {{#if flavourText}}\r\n                {{#each flavourText}}<div class="flavourText"><span class="lc">{{{this}}}</span></div>{{/each}}\r\n            {{/if}}\r\n        </div>\r\n        {{/ifCond}}\r\n    </div>\r\n</div>\r\n{{#if note}}\r\n<div class="textCurrency itemNote">{{note}}</div>\r\n{{/if}}'})),define("PoE/Item/DivinationCard",["Handlebars","Backbone","jquery","./DisplayProperty/ValueStyle","./DisplayProperty/DisplayMode","./FrameType","./Popup/Constants","PoE/Helpers","PoE/Handlebars/TemplateCollection","text!PoE/Item/DivinationCard.hbt"],(function(e,t,n,i,o,r,a,s,l){return t.View.extend({initialize:function(e){this.context=e,this.prepare()},prepare:function(){var e=this.context;e.cardArt?e.cardFace=e.cardArt:e.artFilename&&(e.cardFace=s.distUrl("/image/divination-card/"+e.artFilename+(e.panelLayout?"_panel.png":".png")))},render:function(){var e=new n.Deferred,t=this;return l.load("PoE/Item/DivinationCard.hbt").done((function(n){e.resolve(n(t.context))})),e.promise()}})})),define("text!PoE/Item/Popup.hbt",[],(function(){return'<div class="itemBoxContent">\n    {{#with content.[0]}}\n    <div class="itemHeader{{#if headerTwoLine}} doubleLine{{/if}}">\n        <span class="l {{symbol this \'left\'}}"></span>\n        {{#if name}}\n        <div class="itemName">\n            <span class="lc">{{name}}</span>\n        </div>\n        {{/if}}\n        {{#if typeLine}}\n        <div class="itemName typeLine">\n            <span class="lc">{{typeLine}}</span>\n        </div>\n        {{/if}}\n        <span class="r {{symbol this \'right\'}}"></span>\n    </div>\n    {{/with}}\n    {{#if content.[0].hasContent}}\n    <div class="content">\n        {{separator this}}\n        {{#if content.[0].nextSockets}}\n            <div class="sockets">\n                {{#each content.[0].nextSockets}}\n                    <div class="socket {{popupSocketColor this}}"></div>\n                {{/each}}\n            </div>\n            <div class="separator"></div>\n        {{/if}}\n    {{#each content}}\n        {{#if hybrid}}\n        <div class="separator"></div>\n        <div class="{{#if isVaalGem}}vaalHeader{{else}}hybridHeader{{/if}}">\n            {{#if typeLine}}\n            <div class="itemName typeLine">\n                <span class="lc">{{typeLine}}</span>\n            </div>\n            {{/if}}\n        </div>\n        <div class="separator"></div>\n        {{/if}}\n        {{#if properties}}\n            {{#each properties}}\n            <div class="property"><span class="lc{{#if ../advanced}}{{typeToField this}}{{/if}}">{{itemDisplayProperty this ": "}}</span></div>\n            {{/each}}\n        {{/if}}\n        {{#if utilityMods}}\n            {{#each utilityMods}}<div class="utilityMod"><span class="lc">{{{this}}}</span></div>{{/each}}\n        {{/if}}\n        {{#if sep1}}<div class="separator"></div>{{/if}}\n        {{#if itemLevel}}\n            <div class="itemLevel"><span class="lc{{#if advanced}} s" data-field="ilvl{{/if}}">{{translate "Item Level"}}: <span class="colourDefault">{{itemLevel}}</span></span></div>\n        {{/if}}\n        {{#if talismanTier}}\n            <div class="talismanTier"><span class="lc{{#if advanced}} s" data-field="talisman_tier{{/if}}">{{translate "Talisman Tier"}}: <span class="colourDefault">{{talismanTier}}</span></span></div>\n        {{/if}}\n        {{#if requirements}}\n            <div class="requirements">\n                <span class="lc">\n                {{#each requirements}}{{#if first}}{{translate "Requires"}} {{else}}, {{/if}}<span{{#if ../advanced}} class="{{typeToField this}}"{{/if}}>{{itemDisplayProperty this " "}}</span>{{/each}}\n                </span>\n            </div>\n        {{/if}}\n        {{#if sep2}}<div class="separator"></div>{{/if}}\n        {{#if secDescrText}}\n            <div class="secDescrText"><span>{{secDescrText}}</span></div>\n        {{/if}}\n        {{#if sep14}}<div class="separator"></div>{{/if}}\n        {{#if enchantMods}}\n            {{#each enchantMods}}<div class="enchantMod"><span class="lc">{{#each this}}{{#if @index}}<br>{{/if}}{{this}}{{/each}}</span></div>{{/each}}\n        {{/if}}\n        {{#if sepScourge}}<div class="separator"></div>{{/if}}\n        {{#if scourgeMods}}\n            {{#each scourgeMods}}<div class="scourgeMod"><span class="lc">{{#each this}}{{#if @index}}<br>{{/if}}{{this}}{{/each}}</span></div>{{/each}}\n        {{/if}}\n        {{#if sepLogbook}}<div class="separator"></div>{{/if}}\n        {{#if logbookMods}}\n            {{#each logbookMods}}\n                {{#if @index}}<div class="separator"></div>{{/if}}\n                <div class="logbookMod">\n                    <span class="lc area">{{name}}</span><br>\n                    <span class="lc faction" faction="{{faction.id}}">{{faction.name}}</span>\n                </div>\n                {{#if mods}}\n                    {{#each mods}}<div class="implicitMod"><span class="lc">{{#each this}}{{#if @index}}<br>{{/if}}{{this}}{{/each}}</span></div>{{/each}}\n                {{/if}}\n            {{/each}}\n        {{/if}}\n        {{#if sep3}}<div class="separator"></div>{{/if}}\n        {{#if implicitMods}}\n            {{#each implicitMods}}<div class="implicitMod"><span class="lc">{{#each this}}{{#if @index}}<br>{{/if}}{{this}}{{/each}}</span></div>{{/each}}\n        {{/if}}\n        {{#if sep4}}<div class="separator"></div>{{/if}}\n        {{#if ultimatumMods}}\n            <div class="ultimatumMods{{#ifCond ultimatumMods.length ">" 5}} doubleLine{{/ifCond}}">\n            {{#each ultimatumMods}}<span class="ultimatumMod" type="{{type}}" tier="{{tier}}"></span>{{/each}}\n            </div>\n        {{/if}}\n        {{#if fracturedMods}}\n            {{#each fracturedMods}}<div class="fracturedMod"><span class="lc">{{#each this}}{{#if @index}}<br>{{/if}}{{this}}{{/each}}</span></div>{{/each}}\n        {{/if}}\n        {{#if explicitMods}}\n            {{#each explicitMods}}<div class="explicitMod"><span class="lc">{{#each this}}{{#if @index}}<br>{{/if}}{{this}}{{/each}}</span></div>{{/each}}\n        {{/if}}\n        {{#if craftedMods}}\n            {{#each craftedMods}}<div class="craftedMod"><span class="lc">{{#each this}}{{#if @index}}<br>{{/if}}{{this}}{{/each}}</span></div>{{/each}}\n        {{/if}}\n        {{#if veiledMods}}\n            {{#each veiledMods}}<div class="veiledMod">{{itemVeiledMod this}}</div>{{/each}}\n        {{/if}}\n        {{#if pseudoMods}}\n            {{#each pseudoMods}}<div class="pseudoMod"><span class="lc">{{#each this}}{{#if @index}}<br>{{/if}}{{this}}{{/each}}</span></div>{{/each}}\n        {{/if}}\n        {{#if unidentifiedText}}<div class="unmet"><span class="lc">{{unidentifiedText}}</span></div>{{/if}}\n        {{#if sep8}}<div class="separator"></div>{{/if}}\n        {{#if duplicatedText}}<div class="augmented"><span class="lc">{{duplicatedText}}</span></div>{{/if}}\n        {{#if split}}<div class="augmented"><span class="lc">{{translate "Split"}}</span></div>{{/if}}\n        {{#if unmodifiableText}}<div class="augmented"><span class="lc">{{unmodifiableText}}</span></div>{{/if}}\n        {{#if corruptedText}}<div class="unmet"><span class="lc">{{corruptedText}}</span></div>{{/if}}\n        {{#if sepNotable}}<div class="separator"></div>{{/if}}\n        {{#if notableProperties}}\n            {{#each notableProperties}}\n            <div class="notableProperty"><span class="lc{{#if ../advanced}}{{typeToField this}}{{/if}}">{{itemNotableProperty this}}</span></div>\n            {{/each}}\n        {{/if}}\n        {{#if sep5}}<div class="separator"></div>{{/if}}\n        {{#if cosmeticMods}}\n            {{#each cosmeticMods}}<div class="cosmeticMod"><span class="lc">{{this}}</span></div>{{/each}}\n        {{/if}}\n        {{#if sep6}}<div class="separator"></div>{{/if}}\n        {{#if additionalProperties}}\n            {{#each additionalProperties}}\n            <div class="additionalProperty"><span class="lc{{#if ../advanced}}{{typeToField this}}{{/if}}">{{itemDisplayProperty this ": "}}</span></div>\n            {{/each}}\n        {{/if}}\n        {{#if sep7}}<div class="separator"></div>{{/if}}\n        {{#if nextLevelRequirements}}\n        <div class="nextLevelRequirements"><span class="lc">{{translate "Next Level"}}:</span><br /><span class="lc">\n            {{#each nextLevelRequirements}}{{#if first}}{{translate "Requires"}} {{else}}, {{/if}}{{itemDisplayProperty this " "}}{{/each}}\n        </span></div>\n        {{/if}}\n        {{#if sep11}}<div class="separator"></div>{{/if}}\n        {{#if lockedToCharacterText}}<div class="unmet"><span class="lc">{{lockedToCharacterText}}</span></div>{{/if}}\n        {{#if sep12}}<div class="separator"></div>{{/if}}\n        {{#if flavourTextParsed}}\n            {{#each (parsedMarkupDisplay flavourTextParsed)}}<div class="flavourText"><span class="lc">{{{this}}}</span></div>{{/each}}\n        {{/if}}\n        {{#if flavourText}}\n            {{#each flavourText}}<div class="flavourText"><span class="lc">{{{this}}}</span></div>{{/each}}\n        {{/if}}\n        {{#if sepProphecy}}<div class="separator"></div>{{/if}}\n        {{#if prophecyText}}\n            <div class="prophecyText colourDefault"><span class="lc">{{prophecyText}}</span></div>\n        {{/if}}\n        {{#if sep13}}<div class="separator"></div>{{/if}}\n        {{#if descrText}}\n        <div class="descrText"><span>{{descrText}}</span></div>\n        {{/if}}\n        {{#if incubatedItem}}\n        <div class="separator"></div>\n        <div class="incubated">\n            <div class="text"><span>{{translate "Incubating {ITEM}" ITEM=incubatedItem.name}}</span></div>\n            <span class="progressBar"><span class="fill"><span style="width: {{incubatedItem.percent}}%;"></span></span></span>\n            <div class="descrText"><span><span class="progress">{{ numFormat incubatedItem.progress }}/{{ numFormat incubatedItem.total }}</span> {{ translate "Level {LEVEL}+ Monster Kills" LEVEL=incubatedItem.level }}</span></div>\n        </div>\n        {{/if}}\n        {{#if scourged}}\n        <div class="separator"></div>\n        <div class="scourged">\n            <div class="text"><span>{{translate "Scourged (Tier {TIER})" TIER=scourged.tier}}</span></div>\n            {{#if scourged.total}}\n            <span class="progressBar red"><span class="fill"><span style="width: {{scourged.percent}}%;"></span></span></span>\n            <div class="descrText"><span><span class="progress">{{ numFormat scourged.progress }}/{{ numFormat scourged.total }}</span> {{ translate "Level {LEVEL}+ Corruption Absorbed" LEVEL=scourged.level }}</span></div>\n            {{/if}}\n        </div>\n        {{/if}}\n        {{#if sepLockedAccount}}<div class="separator"></div>{{/if}}\n        {{#if lockedToAccountText}}<div class="locked"><span class="lc">{{lockedToAccountText}}</span></div>{{/if}}\n        {{#if sep15}}<div class="separator"></div>{{/if}}\n        {{#if note}}\n            <div class="textCurrency itemNote">{{note}}</div>\n        {{/if}}\n    {{/each}}\n    </div>\n    {{/if}}\n</div>\n'})),define("PoE/Item/Popup",["require","Handlebars","Backbone","jquery","./DisplayProperty/ValueStyle","./DisplayProperty/DisplayMode","./FrameType","./Popup/Constants","PoE/Helpers","./Markup","./DivinationCard","text!PoE/Item/Popup.hbt"],(function(e){var t=e("Handlebars"),n=e("Backbone"),i=e("jquery"),o=e("./DisplayProperty/ValueStyle"),r=e("./DisplayProperty/DisplayMode"),a=e("./FrameType"),s=e("./Popup/Constants"),l=e("PoE/Helpers"),c=e("./Markup"),d=e("./DivinationCard"),u=e("text!PoE/Item/Popup.hbt"),h=function(e){var n="";switch(e[1]){default:case o.Default:n="Default";break;case o.Augmented:n="Augmented";break;case o.Unmet:n="Unmet";break;case o.PhysicalDamage:n="PhysicalDamage";break;case o.FireDamage:n="FireDamage";break;case o.ColdDamage:n="ColdDamage";break;case o.LightningDamage:n="LightningDamage";break;case o.ChaosDamage:n="ChaosDamage";break;case o.UniqueItem:n="Unique";break;case o.Unreachable:n="Unreachable";break;case o.CurrencyItem:n="Currency";break;case o.ItemQuantity:n="RewardQuantity";break;case o.DivinationCard:n="Divination"}var i="",r=(e[0]instanceof t.SafeString?e[0].string:e[0]).split("\n");for(var a in r)a>0&&(i+="<br>"),r[a].length&&(i+='<span class="colour'+n+'">'+t.Utils.escapeExpression(r[a])+"</span>");return i};t.registerHelper("parsedMarkupDisplay",(function(e){for(var n="",i=0;i<e.length;i++)if(e[i]instanceof t.SafeString)n+=e[i].toHTML();else if("object"===_typeof(e[i])&&e[i].type&&"class"===e[i].type.toHTML())n+='<span class="PoEMarkup '+e[i].class.toHTML()+" "+e[i].id.toHTML()+'"></span>';n+="<br>";var o=[];for(var i in n=n.split("\n"))o.push(new t.SafeString(n[i]));return o})),t.registerHelper("itemNotableProperty",(function(e){for(var n='<span class="colourAugmented">'+t.Utils.escapeExpression(e.name)+"</span>",i=0,r=e.values.length;i<r;++i){var a=e.values[i],s=(a[0]instanceof t.SafeString?a[0].string:a[0]).split("\n");for(var l in s){var c=t.Utils.escapeExpression(s[l]);a[1]==o.Augmented&&(c="<em>"+c+"</em>"),n+="<br>"+c}}return new t.SafeString(n)})),t.registerHelper("itemDisplayProperty",(function(e,n){var i="",o=e.name instanceof t.SafeString?e.name.toHTML():e.name,a=e.displayMode instanceof t.SafeString?e.displayMode.toHTML():e.displayMode;if(a==r.Progress||"Progress"==a)if(58===e.type){var s=Number(e.suffix||1),l=Math.round(100*e.progress);i='<span class="progressBar sentinel">\n                    <span class="fill">\n                        <span style="width: '.concat(l,'%;"></span>\n                        <div class="segments">\n                            ').concat(Array(s-1).fill("<i></i>").join(""),"\n                        </div>\n                    </span>\n                </span>")}else i='<span class="progressBar"><span class="fill"><span style="width: '+Math.round(100*e.progress)+'%;"></span></span></span>';switch(a){case r.NameValue:case r.ValueName:case r.Progress:case"NameValue":case"ValueName":case"Progress":for(var c="",d=0,u=e.values.length;d<u;++d)c+=(d>0?", ":"")+h(e.values[d]);n=""==o||""==c?"":n,a==r.ValueName||"ValueName"==a?c+=n:o+=n,o="<span>"+t.Utils.escapeExpression(o)+"</span>",i+=a==r.ValueName||"ValueName"==a?c+o:o+c;break;case r.Inject:case"Inject":o=o.split("\n").join("<br>");for(d=0,u=e.values.length;d<u;++d)o=(o=o.replace("%"+d,h(e.values[d]))).replace("{"+d+"}",h(e.values[d]));i+=o}return new t.SafeString(i)})),t.registerHelper("itemVeiledMod",(function(e){var n=null;if((n=/\/([A-Za-z]+)_(0[0-9])\.mp4$/.exec(e))&&(n.shift(),n[0]="Preffix"==n[0]?"prefix":"suffix"),!n){(n=/([A-Za-z]+)(\d+)/.exec(e)).shift(),n[0]=String(n[0]).toLowerCase()}var i="prefix"==n[0]?l.translate("Veiled Prefix"):l.translate("Veiled Suffix");return new t.SafeString('<span class="lc '+n[0]+" "+n.join("")+'">'+i+"</span>")})),t.registerHelper("typeToField",(function(e){var n=[null,"map_tier","map_iiq","map_iir","map_packsize","gem_level","quality",null,null,"pdamage","edamage","cdamage","crit","aps",null,"block","ar","ev","es",null,"gem_level_progress",null,null,null,null,null,null,null,null,null,"monster_level","stored_experience","stack_size","durability","area_level","heist_wings","heist_escape_routes","heist_reward_rooms","heist_lockpicking","heist_brute_force","heist_perception","heist_demolition","heist_counter_thaumaturgy","heist_trap_disarmament","heist_agility","heist_deception","heist_engineering","heist_objective_value",null,null,null,null,null,null,"ward","adaptation",null,null,null,null,null,null,"lvl","str","dex","int"][e.type];return null==n?"":new t.SafeString(' s" data-field="'+n)})),t.registerHelper("separator",(function(e){return""})),t.registerHelper("symbol",(function(e,t){var n=[];if(e.fractured||e.synthesised)n.push(e.fractured?"fractured":"synthetic");else if(e.searing||e.tangled)"left"==t?n.push(e.searing?"searing":"tangled"):"right"==t&&n.push(e.tangled?"tangled":"searing");else if(e.influences||e.replica){var i=Object.keys(e.influences||{});"left"==t?n.push(e.replica?"replica":i[0]):"right"==t&&n.push(i.length?i[i.length>1&&!e.replica?1:0]:"replica")}else e.veiled&&n.push("veiled");return n.length?(n.unshift("symbol"),n.join(" ")):""})),t.registerHelper("popupSocketColor",(function(e){if(!e||!e.sColour)return"";var n="";switch(e.sColour.string){case"R":n="socketStr";break;case"G":n="socketDex";break;case"B":n="socketInt";break;case"GR":n="socketStrDex";break;case"RB":n="socketStrInt";break;case"BG":n="socketDexInt"}return new t.SafeString(n)}));var p=n.View.extend({initialize:function(){this.divinationCard=this.model.get("frameType")===a.DivinationCard||"DivinationCard"===this.model.get("frameType"),null===p.template&&(p.template=t.compile(this.tpl)),this.divinationCard||(this.template=p.template)},processContext:function(e){var n=!1,i=function(t,i){e[t]&&(n&&(e[i]=!0),n=!0)},o=function(n){if(e[n]){for(var i=e[n],o=[];i.length>0;){var r=i.shift();r instanceof t.SafeString&&(r=r.string);var a=r.split("\n");for(var s in a)a[s]=a[s].replace(/(?:\r\n|\r|\n)/g,"");o.push(a)}e[n]=o}};return e.influences||!e.shaper&&!e.elder||(e.influences={shaper:e.shaper||null,elder:e.elder||null}),e.identified||(e.unidentifiedText=l.translate("Unidentified")),e.corrupted&&(e.corruptedText=l.translate("Corrupted")),e.unmodifiable&&(e.unmodifiableText=l.translate("Unmodifiable")),e.lockedToCharacter&&(e.lockedToCharacterText=l.translate("Cannot be traded or modified")),e.duplicated&&(e.duplicatedText=l.translate("Mirrored")),e.lockedToAccount&&(e.lockedToAccountText=l.translate("Account-bound")),e.synthetic&&(e.synthesised=!0),e.raceRewardText=!1,e.cisRaceReward&&(e.raceRewardText=l.translate("CIS Race Season Reward")),e.seaRaceReward&&(e.raceRewardText=l.translate("SG Race Season Reward")),e.thRaceReward&&(e.raceRewardText=l.translate("TH Race Season Reward")),!1!==e.raceRewardText&&(e.flavourText?(e.flavourText.push("\r"),e.flavourText.push("\r")):e.flavourText=[],e.flavourText.push(e.raceRewardText)),e.incubatedItem&&(e.incubatedItem.percent=e.incubatedItem.total?Math.round(100*Math.min(1,e.incubatedItem.progress/e.incubatedItem.total)):0),e.scourged&&e.scourged.total&&(e.scourged.percent=e.scourged.total?Math.round(100*Math.min(1,e.scourged.progress/e.scourged.total)):0),e.advanced&&(e.itemLevel=e.ilvl||e.itemLevel||null),o("utilityMods"),o("enchantMods"),o("scourgeMods"),o("implicitMods"),o("fracturedMods"),o("explicitMods"),o("craftedMods"),o("pseudoMods"),o("cosmeticMods"),i("properties"),i("requirements","sep1"),i("talismanTier"),e.itemLevel&&i("itemLevel"),e.sep1=e.sep1||(e.talismanTier||e.itemLevel)&&e.properties,i("secDescrText","sep2"),i("enchantMods","sep14"),i("scourgeMods","sepScourge"),i("logbookMods","sepLogbook"),i("implicitMods","sep3"),i("fracturedMods","sep4"),i("ultimatumMods","sep4"),i("explicitMods","sep4"),i("craftedMods","sep4"),i("veiledMods","sep4"),i("pseudoMods","sep4"),i("cosmeticMods","sep5"),i("notableProperties","sepNotable"),i("additionalProperties","sep6"),i("nextLevelRequirements","sep7"),i("unidentifiedText","sep4"),i("split","sep8"),i("corruptedText","sep8"),i("unmodifiableText","sep8"),i("duplicatedText","sep8"),i("lockedToCharacterText","sep11"),i("flavourText","sep12"),e.sep12=e.sep12||e.flavourTextParsed,i("descrText","sep13"),i("prophecyText","sepProphecy"),i("note","sep15"),i("lockedToAccountText","sepLockedAccount"),(e=c.recMarkup(e)).name&&e.typeLine&&(e.headerTwoLine=!0),n&&(e.hasContent=!0),e.requirements&&e.requirements.length>0&&(e.requirements[0].first=!0),e.nextLevelRequirements&&e.nextLevelRequirements.length>0&&(e.nextLevelRequirements[0].first=!0),e},render:function(){var e=this.model.toJSON(),t=this.model.has("hybrid");if(t){t=this.model.get("hybrid");var n=e.typeLine;e.typeLine=t.baseTypeName,t.typeLine=n,t.corrupted=e.corrupted,e.corrupted=!1,t.descrText=e.descrText,e.descrText=void 0,t.additionalProperties=e.additionalProperties,e.additionalProperties=void 0,t.note=e.note,e.note=void 0,e.hybrid=!1,t.hybrid=!0,t.identified=e.identified,t.advanced=e.advanced,t=this.processContext(t)}e=this.processContext(e),this.$el.addClass("itemPopupContainer").addClass("newItemPopup"),this.model.has("ruthless")&&this.model.get("ruthless")&&this.$el.addClass("ruthless");var i=this,o="";switch(this.model.get("frameType")){default:case a.Normal:case"Normal":o="normalPopup";break;case a.Magic:case"Magic":o="magicPopup";break;case a.Rare:case"Rare":o="rarePopup";break;case a.Unique:case"Unique":o="uniquePopup";break;case a.Gem:case"Gem":o="gemPopup";break;case a.Currency:case"Currency":o="currencyPopup";break;case a.Quest:case"Quest":o="questPopup";break;case a.DivinationCard:case"DivinationCard":o="divinationCard";break;case a.Prophecy:case"Prophecy":o="prophecyPopup";break;case a.Foil:case"Foil":case"Relic":o="relicPopup";break;case a.SupporterFoil:case"SupporterFoil":o="supporterFoilPopup",e.foilVariation&&(o+=" supporterFoilPopup-"+e.foilVariation)}(this.$el.addClass(o),this.divinationCard)?new d(e).render().done((function(e){i.$el.empty().html(e),c.PoEMarkup(i.$el,.5)})):t?this.$el.empty().html(this.template({content:[e,t]})):this.$el.empty().html(this.template({content:[e]}))},updatePopupWidth:function(){this.$el.css("position","relative"),this.$el.css("top","0px"),this.$el.css("left","0px"),this.$el.css("width","auto");this.$el.find(".itemName:first");var e=0;this.$el.find(".lc").each((function(){var t=i(this).outerWidth(!0)+2;t>e&&(e=t)})),this.$el.find(".descrText span, .secDescrText span").each((function(){var t=i(this).outerWidth(!0);t>s.MaxDescriptionWidth&&(t=s.MaxDescriptionWidth),t>e&&(e=t)})),this.$el.width(e+this.$el.outerWidth(!0)-this.$el.outerWidth(!0))},close:function(){this.remove(),this.off()}});return p.template=null,p.prototype.tpl=u,p})),define("PoE/Geom/Point",[],(function(){var e=function(e,t){this.x=void 0===e?0:e,this.y=void 0===t?0:t};return e.prototype.scale=function(e){this.x*=e,this.y*=e},e.prototype.inverseTranslate=function(e){this.x-=e.x,this.y-=e.y},e.prototype.translateX=function(e){return this.x+=e,this},e.prototype.translateY=function(e){return this.y+=e,this},e.prototype.distTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},e.prototype.angleTo=function(e){return Math.atan2(e.y-this.y,e.x-this.x)},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.toString=function(){return"("+this.x+","+this.y+")"},e.prototype.eq=function(e){return this.x===e.x&&this.y===e.y},e.prototype.neq=function(e){return!this.eq(e)},e})),define("PoE/Geom/Offset",[],(function(){var e=function(e,t,n,i){this.top=e,this.left=i,this.bottom=n,this.right=t};return e.getBoundsOffset=function(t,n){return new e(t.tl.y-n.tl.y,t.br.x-n.br.x,t.br.y-n.br.y,t.tl.x-n.tl.x)},e})),define("PoE/Layout/Popup",["PoE/Geom/Point","PoE/Geom/Offset"],(function(e,t){var n={makePopup:function(e){if(void 0===n.popupContainerEl){var t=$("#poe-popup-container");0==t.length&&(t=$('<div id="poe-popup-container" style="position: absolute; width: 800px; left: -1000px"></div>'),$("body").append(t)),n.popupContainerEl=t}n.popupContainerEl.append(e)}};return n})),define("PoE/Geom/Bounds",["./Point","./Offset"],(function(e,t){var n=function(t,n){this.tl=void 0===t?new e:t,this.br=void 0===n?new e:n};return n.prototype.top=function(){return this.tl.y},n.prototype.bottom=function(){return this.br.y},n.prototype.left=function(){return this.tl.x},n.prototype.right=function(){return this.br.x},n.prototype.centerAt=function(e){this.horizontalCenterAt(e),this.verticalCenterAt(e)},n.prototype.horizontalCenterAt=function(e){var t=this.width()/2;this.tl.x=e.x-t,this.br.x=e.x+t},n.prototype.verticalCenterAt=function(e){var t=this.height()/2;this.tl.y=e.y-t,this.br.y=e.y+t},n.prototype.width=function(e){return void 0!==e?(this.br.x=this.tl.x+e,this):this.br.x-this.tl.x},n.prototype.height=function(e){return void 0!==e?(this.br.y=this.tl.y+e,this):this.br.y-this.tl.y},n.prototype.scale=function(){this.tl.scale(),this.br.scale()},n.prototype.contains=function(e){return this.containsCoords(e.x,e.y)},n.prototype.containsCoords=function(e,t){return e>=this.tl.x&&e<=this.br.x&&t>=this.tl.y&&t<=this.br.y},n.prototype.containsBounds=function(e){return this.contains(e.tl)&&this.contains(e.br)},n.prototype.translateX=function(e){return this.tl.translateX(e),this.br.translateX(e),this},n.prototype.translateY=function(e){return this.tl.translateY(e),this.br.translateY(e),this},n.prototype.grow=function(e){this.tl.x-=e,this.tl.y-=e,this.br.x+=e,this.br.y+=e},n.prototype.tr=function(){return new e(this.br.x,this.tl.y)},n.prototype.bl=function(){return new e(this.tl.x,this.br.y)},n.prototype.intersectionPoint=function(t,n,i){var o=function(e,t){var n=t.y-e.y,i=e.x-t.x;return{A:n,B:i,C:n*e.x+i*e.y,point1:e,point2:t}},r=function(t,n){var o,r,a=(r=n,(o=t).A*r.B-r.A*o.B);if(0==a)return!1;var s=function(e,t){var n=Math.min(t.point1.x,t.point2.x),o=Math.max(t.point1.x,t.point2.x),r=Math.min(t.point1.y,t.point2.y),a=Math.max(t.point1.y,t.point2.y);return e.x>=n-i&&e.x<=o+i&&e.y>=r-i&&e.y<=a+i},l=new e((n.B*t.C-t.B*n.C)/a,(t.A*n.C-n.A*t.C)/a);return!(!s(l,t)||!s(l,n))&&l},a=this.tl,s=this.tr(),l=this.bl(),c=this.br,d=o(t,n),u=r(o(a,s),d);return(!1!==u||!1!==(u=r(o(s,c),d))||!1!==(u=r(o(l,c),d))||!1!==(u=r(o(a,l),d)))&&u},n.prototype.clone=function(){return new n(this.tl.clone(),this.br.clone())},n.prototype.toString=function(){return"Bounds("+this.tl+", "+this.br+")"},n.prototype.positionAbove=function(e){e instanceof n&&this.translateY(e.tl.y-this.br.y)},n.prototype.positionBelow=function(e){e instanceof n&&this.translateY(e.br.y-this.tl.y)},n.prototype.positionLeft=function(e){e instanceof n&&this.translateX(e.tl.x-this.br.x)},n.prototype.positionRight=function(e){e instanceof n&&this.translateX(e.br.x-this.tl.x)},n.prototype.alignTop=function(e){e instanceof n&&this.translateY(e.tl.y-this.tl.y)},n.prototype.positionTopLeftX=function(e){var t=this.width();this.tl.x=e,this.width(t)},n.prototype.positionTopLeftY=function(e){var t=this.height();this.tl.y=e,this.height(t)},n.prototype.positionAtXCenter=function(e){e instanceof n&&this.positionTopLeftX(e.tl.x+e.width()/2-this.width()/2)},n.prototype.positionAtYCenter=function(e){e instanceof n&&this.positionTopLeftY(e.tl.y+e.height()/2-this.height()/2)},n.prototype.positionAtRightEdge=function(e){e instanceof n&&this.positionTopLeftX(e.tl.x+e.width()-this.width())},n.prototype.positionInsideLeftEdge=function(e){var n=t.getBoundsOffset(this,e);n.left>=0||this.translateX(-n.left)},n.prototype.positionInsideRightEdge=function(e){var n=t.getBoundsOffset(this,e);n.right<=0||this.translateX(-n.right)},n.prototype.positionInsideTopEdge=function(e){var n=t.getBoundsOffset(this,e);n.top>=0||this.translateY(-n.top)},n.prototype.positionInsideBottomEdge=function(e){var n=t.getBoundsOffset(this,e);n.bottom<=0||this.translateY(-n.bottom)},n.prototype.fitsAbove=function(e,n){return t.getBoundsOffset(e,n).top>=this.height()&&n.width()>=this.width()},n.prototype.fitsRight=function(e,n){return-t.getBoundsOffset(e,n).right>=this.width()&&n.height()>=this.height()},n.prototype.fitsLeft=function(e,n){return t.getBoundsOffset(e,n).left>=this.width()&&n.height()>=this.height()},n.prototype.fitsBelow=function(e,n){return-t.getBoundsOffset(e,n).bottom>=this.height()&&n.width()>=this.width()},n.prototype.draw=function(e){var t=this.clone();setTimeout((function(){var e=$("<div></div>").css("position","absolute").width(t.width()).height(t.height()).css("top",t.top()).css("left",t.left()).css("background","#33a").css("border","1px solid #a33").css("opacity",".6").css("z-index",5e3);$("body").append(e),setTimeout((function(){e.fadeOut(3e3,(function(){$(this).remove()}))}),3e3)}),500)},n.prototype.eq=function(e){return this.tl.eq(e.tl)&&this.br.eq(e.br)},n.prototype.neq=function(e){return!this.eq(e)},n})),define("PoE/Layout",["require","PoE/Geom/Point","PoE/Geom/Bounds","PoE/Layout/Popup"],(function(e){var t=e("PoE/Geom/Point"),n=e("PoE/Geom/Bounds"),i=e("PoE/Layout/Popup"),o={smartPositionNextTo:function(e,t,n){var i=n||o.getViewportBounds();e.fitsAbove(t,i)?(e.positionAbove(t),e.positionAtXCenter(t),e.positionInsideLeftEdge(i),e.positionInsideRightEdge(i)):e.fitsRight(t,i)?(e.positionAbove(t),e.positionRight(t),e.positionInsideTopEdge(i)):e.fitsLeft(t,i)?(e.positionAbove(t),e.positionLeft(t),e.positionInsideTopEdge(i)):e.fitsBelow(t,i)?(e.positionBelow(t),e.positionAtXCenter(t),e.positionInsideLeftEdge(i),e.positionInsideRightEdge(i)):(e.positionInsideTopEdge(i),e.positionAtRightEdge(i))},getElementBounds:function(e){var i=e.offset();return new n(new t(i.left,i.top),new t(i.left+e.outerWidth(!1),i.top+e.outerHeight(!1)))},getViewportBounds:function(){var e=$(window),i=e.scrollLeft(),o=e.scrollTop();return new n(new t(i,o),new t(i+e.width(),o+e.height()))},positionPopups:function(e,t,r){var a=null,s=new n;r&&void 0!==r.mode&&(a=r.mode);var l=o.getViewportBounds();r&&r.viewportBounds&&(l=r.viewportBounds);for(var c=t,d=o.getElementBounds(i.popupContainerEl),u=0,h=e.length;u<h;++u){var p=(m=e[u]).el.outerWidth(!0),f=m.el.outerHeight(!0);s.height(Math.max(f,s.height())),s.width(s.width()+p)}switch(a){case"smart":default:o.smartPositionNextTo(s,c,l);break;case"smartleft":s.positionBelow(c),s.positionRight(c),s.positionInsideRightEdge(l),s.positionInsideBottomEdge(l);break;case"below":s.positionBelow(c),s.positionAtXCenter(c);break;case"left":s.positionLeft(c),s.positionAtYCenter(c);break;case"right":s.positionRight(c),s.positionAtYCenter(c);break;case"rightTop":s.positionRight(c),s.alignTop(c);break;case"center":s.positionAtXCenter(c),s.positionAtYCenter(c)}s.translateX(-d.left()),s.translateY(-d.top());var v=s.left();for(u=0,h=e.length;u<h;++u){var m;(m=e[u]).el.css("left",v).css("top",s.top()),v+=m.el.outerWidth(!0)}}};return o})),define("PoE/Layout/Popup/Popup",["require","PoE/Geom/Point","PoE/Geom/Offset","PoE/Layout/Popup","PoE/Layout"],(function(e){e("PoE/Geom/Point"),e("PoE/Geom/Offset");var t=e("PoE/Layout/Popup"),n=e("PoE/Layout");return function(){function e(t,n){_classCallCheck(this,e),this.el=t instanceof jQuery?t:$(t),this.events={prePosition:function(){}},this.isPopup=!1,this.visible=!1,this.lastX=null,this.lastY=null,this.cssPosition=n&&n.useRelativePosition?"relative":"absolute"}return _createClass(e,[{key:"create",value:function(){this.isPopup||(t.makePopup(this.el),this.el.css("position",this.cssPosition),this.el.hide(),this.visible=!1,this.isPopup=!0)}},{key:"manualPosition",value:function(e){this.create(),this.show(),this.events.prePosition(this);var t=$("#passiveSkillTree").offset(),n=$("#poe-popup-container").offset(),i=$("#poe-popup-container").width(),o=$("#poe-popup-container").height()+n.top,r=this.lastX,a=this.lastY;e&&(r=this.lastX=e.x,a=this.lastY=e.y);var s=t.top+a-o-50,l=t.left+r+i;this.el.css({top:s+"px",left:l+"px",position:this.cssPosition})}},{key:"positionCenterEl",value:function(e){this.create(),this.show(),this.events.prePosition(this);var t=n.getElementBounds(e);n.positionPopups([this],t,{mode:"center"})}},{key:"smartPositionByEl",value:function(e){this.create(),this.show(),this.events.prePosition(this),this.el.css("position",this.cssPosition);var t=n.getElementBounds(e);n.positionPopups([this],t,{mode:"smart"})}},{key:"positionBelowEl",value:function(e){this.create(),this.show(),this.events.prePosition(this),this.el.css("position",this.cssPosition);var t=n.getElementBounds(e);n.positionPopups([this],t,{mode:"below"})}},{key:"positionSmartLeft",value:function(e,t){this.create(),this.show(),this.events.prePosition(this),this.el.css("position",this.cssPosition),n.positionPopups([this],e,{mode:"smartleft",viewportBounds:t})}},{key:"positionLeftEl",value:function(e){this.create(),this.show(),this.events.prePosition(this),this.el.css("position",this.cssPosition);var t=n.getElementBounds(e);n.positionPopups([this],t,{mode:"left"})}},{key:"positionRight",value:function(e){this.create(),this.show(),this.events.prePosition(this),this.el.css("position",this.cssPosition),n.positionPopups([this],e,{mode:"right"})}},{key:"positionRightTopEl",value:function(e){this.create(),this.show(),this.events.prePosition(this),this.el.css("position",this.cssPosition);var t=n.getElementBounds(e);n.positionPopups([this],t,{mode:"rightTop"})}},{key:"isVisible",value:function(){return this.visible}},{key:"show",value:function(){this.visible=!0,this.el.show()}},{key:"hide",value:function(){this.visible=!1,this.el.hide()}}]),e}()})),define("PoE/Layout/Popup/PopupGroup",["PoE/Layout","PoE/Geom/Offset"],(function(e){return function(t){this.popups=t,this.smartPositionByEl=function(n){for(var i=0,o=this.popups.length;i<o;++i){var r=this.popups[i];r.el.show(),r.events.prePosition(r),r.el.css("position","absolute")}var a=e.getElementBounds(n);e.positionPopups(t,a,{mode:"smart"})}}})),define("PoE/DOM/Util",["jquery"],(function(e){return{isNextSiblingTextNode:function(t){if(t instanceof e){if(0==t.length)return!1;t=t[0]}var n=t.nextSibling;return n&&3==n.nodeType},isPrevSiblingTextNode:function(t){if(t instanceof e){if(0==t.length)return!1;t=t[0]}var n=t.previousSibling;return n&&3==n.nodeType},getSelectedText:function(t){if(t instanceof e&&(t=t[0]),"selectionStart"in t){var n=t.selectionStart,i=t.selectionEnd-n;return t.value.substr(n,i)}if(document.selection){t.focus();var o=document.selection.createRange();return null==o?"":o.text}return""}}})),define("text!PoE/Item/Item.hbt",[],(function(){return'<div class="popupPlaceholder"></div>\r\n<div class="socketPopups"></div>\r\n<div class="iconContainer">\r\n    <div class="icon {{#if elder}} elder {{/if}}{{#if shaper}} shaper {{/if}}">\r\n        {{#if iconMp4}}\r\n        <video class="noHeight" autoplay loop muted poster="{{icon}}">\r\n            {{#each iconMp4}}\r\n            <source src="{{this}}" type="video/{{@key}}">\r\n            {{/each}}\r\n        </video>\r\n        {{else}}\r\n        <img src="{{icon}}" alt="">\r\n        {{/if}}\r\n        <div class="sockets numSockets{{numSockets}}">\r\n            {{#each sockets}}\r\n            {{#if linkNext}}<div class="socketLink socketLink{{index}}"></div>{{/if}}\r\n            <div class="socket {{socketColour this}}">\r\n            </div>\r\n            {{/each}}\r\n        </div>\r\n        {{#if stackSize}}<span class="stackSize{{#if stackSizeFull}} maxed{{/if}}">{{#if stackSizeText}}{{stackSizeText}}{{else}}{{stackSize}}{{/if}}</span>{{/if}}\r\n    </div>\r\n    {{#if enableVerified}}{{#if verified}}<div class="verifiedStatus">{{translate "Verified"}}</div>{{/if}}{{/if}}\r\n    {{#if enableLeague}}<div class="itemLeaguePopup">{{fullLeagueName}}</div>{{/if}}\r\n</div>'})),define("PoE/Item/Item",["require","Handlebars","Backbone","jquery","./Popup","PoE/Layout/Popup/Popup","PoE/Layout/Popup/PopupGroup","PoE/Layout","PoE/DOM/Util","./DivinationCard","./Markup","PoE/Helpers","text!PoE/Item/Item.hbt"],(function(e){var t=e("Handlebars"),n=e("Backbone"),i=e("jquery"),o=e("./Popup"),r=e("PoE/Layout/Popup/Popup"),a=e("PoE/Layout/Popup/PopupGroup"),s=(e("PoE/Layout"),e("PoE/DOM/Util"),e("./DivinationCard")),l=e("./Markup"),c=e("PoE/Helpers"),d=e("text!PoE/Item/Item.hbt");t.registerHelper("socketColour",(function(e){if(!e)return"";var n=[];return e.str&&n.push("socketStr"),e.dex&&n.push("socketDex"),e.int&&n.push("socketInt"),e.gen&&n.push("socketGen"),e.abyss&&n.push("socketAbyss"),e.delve&&n.push("socketDelve"),e.rightAlign&&n.push("socketRight"),e.socketed&&(n.push("socketed"),e.support&&n.push("socketSupport"),e.gemColour&&n.push(e.gemColour)),new t.SafeString(n.join(" "))}));var u=n.View.extend({initialize:function(){null===u.template&&(u.template=t.compile(this.tpl)),this.template=u.template,this.state={itemHovered:!1,inSocketHover:!1,showSocketKeyDown:!1},!0===this.options.manualPosition&&(this.manualPosition=!0),void 0===this.options.enableVerified&&(this.options.enableVerified=!1),void 0===this.options.enableLeague&&(this.options.enableLeague=!1),void 0===this.options.showSockets&&(this.options.showSockets=!1),void 0===this.options.hiddenSlotIndex&&(this.options.hiddenSlotIndex=null),this.leaguePopup=null,this.options.showSockets&&this.$el.addClass("showSockets"),this.divinationLayout=!!this.options.divinationLayout},events:{click:"itemClick"},itemClick:function(e){this.trigger("itemClick",this.model)},render:function(){var e=this.model.toJSON(),n=this;if(e.enableVerified=this.options.enableVerified,e.enableLeague=this.options.enableLeague,e.enableLeague&&(e.fullLeagueName=c.translate("{{LEAGUE}} League",{"{{LEAGUE}}":c.translate(e.league)})),e.sockets=[],e.numSockets=0,e.artFilename&&e.stackSize&&e.stackSize>=e.maxStackSize&&(e.stackSizeFull=!0),this.model.has("sockets")){var d=this.model.get("sockets");e.numSockets=d.length;for(var u=0,h=d.length-1;u<=h;++u){var p=d[u],f={index:u,str:"S"==p.attr,dex:"D"==p.attr,int:"I"==p.attr,gen:"G"==p.attr,abyss:"A"==p.sColour,delve:"DV"==p.sColour,linkNext:u<h&&p.group==d[u+1].group,rightAlign:u>=2&&u<=3};e.sockets.push(f)}this.model.has("socketedItems")&&this.model.get("socketedItems").forEach((function(t){var n=t.get("socket");e.sockets[n].socketed=!0,e.sockets[n].support=t.get("support");var i=t.get("colour");switch(i){case"S":i="strGem";break;case"D":i="dexGem";break;case"I":i="intGem";break;case"G":i="genGem";break;default:i=!1}i||(e.sockets[n].abyss&&(i="abyssJewel"),e.sockets[n].delve&&(i="delve")),e.sockets[n].gemColour=i}))}if(this.$el.addClass("newItemContainer").addClass("iW"+this.model.get("w")).addClass("iH"+this.model.get("h")),null!==n.options.hiddenSlotIndex&&(this.$el.addClass("stashHiddenSlot"),this.$el.attr("slot",n.options.hiddenSlotIndex)),!0===this.divinationLayout){this.$el.addClass("divinationCard"),this.$el.css("width","172px"),this.$el.css("height","261px");var v=i.extend(!0,{},e);this.model.get("stackSize")>=this.model.get("maxStackSize")&&this.$el.addClass("completeStack");!function(e){if(v[e]){for(var n=v[e],i=[];n.length>0;){var o=n.shift();o instanceof t.SafeString&&(o=o.string);var r=o.split("\n");for(var a in r)r[a]=r[a].replace(/(?:\r\n|\r|\n)/g,"");i.push(r)}v[e]=i}}("explicitMods"),(v=l.recMarkup(v)).panelLayout=!0,new s(v).render().done((function(e){n.$el.empty().html(e),l.PoEMarkup(n.$el,.35)}))}else this.$el.empty().html(this.template(e));var m=new o({model:this.model});this.$socketsEl=this.$el.find(".sockets"),this.socketEls=this.$socketsEl.children(".socket"),this.socketPopups=[],this.options.enableLeague&&(this.leaguePopup=new r(this.$el.find(".itemLeaguePopup:first")),this.leaguePopup.events.prePosition=function(e){e.el.width(e.el.width())}),this.model.get("socketedItems").forEach((function(e,t){var a=new o({model:e}),s=e.get("socket");a.render(),n.$el.find(".socketPopups").append(a.$el);var l=new r(a.$el);l.events.prePosition=function(e){return function(){e.updatePopupWidth()}}(a),n.socketPopups.push({view:a,popup:l,$socketEl:i(n.socketEls.get(s))})})),m.render(),this.$el.find(".popupPlaceholder:first").replaceWith(m.$el),this.mainPopup={view:m,popup:new r(m.$el)},this.mainPopup.popup.events.prePosition=function(){n.mainPopup.view.updatePopupWidth()},this.mainPopup.popup.create(),this.itemIconEl=this.$el.find(".icon:first"),this.on("displayed",(function(){this.itemIconEl.find("img:first").load((function(){var e=n.model.get("w"),t=n.model.get("h"),i=[];if(n.model.get("shaper")){n.itemIconEl=n.$el.find(".icon:first");var o=Math.floor(n.$el.position().left)%4096,r=Math.floor(n.$el.position().top)%2160,a=c.imageUrl("inventory/ShaperBackground.png?w=".concat(e,"&h=").concat(t,"&x=").concat(o,"&y=").concat(r));i.unshift("url(".concat(a,") no-repeat center"))}if(n.model.get("elder")){var s=c.imageUrl("inventory/ElderBackground.png?w=".concat(e,"&h=").concat(t));i.unshift("url(".concat(s,") no-repeat center"))}i.length&&n.itemIconEl.css("background",i.join(", "))}))})),this.$el.mouseenter((function(e){n.handleItemMouseover(e)})).mouseleave((function(e){n.handleItemMouseout(e)})),i(document).keydown((function(e){return n.handleKeyDown(e)})).keyup((function(e){return n.handleKeyUp(e)}));u=0;for(var g=n.socketPopups.length;u<g;++u){var y=n.socketPopups[u];y.popup.create(),y.$socketEl.mouseenter(function(e){return function(t){n.state.inSocketHover=!0,n.state.itemHovered=!0,i(this).addClass("socketHover"),new a([n.mainPopup.popup,e.popup]).smartPositionByEl(n.$el)}}(y)),y.$socketEl.mouseleave(function(e){return function(t){n.state.inSocketHover=!1,n.state.itemHovered=!0,i(this).removeClass("socketHover"),e.popup.hide(),n.reposition()}}(y))}this.$el.addClass("itemRendered"),this.trigger("render")},handleKeyDown:function(e){if(18==e.which){if(this.state.showSocketKeyDown=!0,this.state.itemHovered)return;return this.hideSockets(!1),!1}},handleKeyUp:function(e){if(18==e.which){if(this.state.showSocketKeyDown=!1,this.state.itemHovered)return;this.hideSockets(!0)}},reposition:function(e){this.manualPosition?this.mainPopup.popup.manualPosition(e):this.divinationLayout?this.mainPopup.popup.positionCenterEl(this.$el):this.mainPopup.popup.smartPositionByEl(this.$el)},handleItemMouseover:function(e){this.state.inSocketHover||this.state.itemHovered||(this.hideSockets(!1),this.hoverStart(),this.reposition(e))},handleItemMouseout:function(){this.state.inSocketHover||this.state.showSocketKeyDown||this.hideSockets(!0),this.state.itemHovered&&(this.mainPopup.popup.hide(),this.hoverEnd())},hoverStart:function(){this.state.itemHovered=!0,this.$el.addClass("hovered"),this.options.enableLeague&&this.leaguePopup.positionBelowEl(this.$el)},hoverEnd:function(){this.state.itemHovered=!1,this.$el.removeClass("hovered"),this.options.enableLeague&&this.leaguePopup.hide()},hideSockets:function(e){e?this.$socketsEl.hide():this.$socketsEl.show()},setPlaced:function(e,t){this.$el.addClass("itemPlaced").addClass("ipW"+e).addClass("ipH"+t),this.model.get("identified")||this.$el.addClass("unidentified"),this.model.get("corrupted")&&this.$el.addClass("corrupted"),this.model.get("lockedToCharacter")&&this.$el.addClass("lockedToCharacter")},close:function(){this.remove(),this.off(),this.mainPopup.view.close();for(var e=0,t=this.socketPopups.length;e<t;++e)this.socketPopups[e].view.close()}});return u.template=null,u.prototype.tpl=d,u})),define("PoE/BetaCountdown",["plugins"],(function(e){return function(t,n){this.countdownContEl=e(t),this.loadingEl=this.countdownContEl.find(".loading:first"),this.activeContainerEl=this.countdownContEl.find(".activeContainer:first"),this.countdownEl=this.countdownContEl.find(".countdown:first"),this.countdownLastEl=this.countdownContEl.find(".p1Status .lastInvite:first"),this.countdownNextEl=this.countdownContEl.find(".p1Status .nextInvite:first"),this.countdownLastNameEl=this.countdownLastEl.find(".name:first"),this.countdownNextNameEl=this.countdownNextEl.find(".name:first"),this.P2countdownLastEl=this.countdownContEl.find(".p2Status .lastInvite:first"),this.P2countdownNextEl=this.countdownContEl.find(".p2Status .nextInvite:first"),this.P2countdownLastNameEl=this.P2countdownLastEl.find(".name:first"),this.P2countdownNextNameEl=this.P2countdownNextEl.find(".name:first"),this.boxContainerEl=e(n),this.id=0,this.intervalId=null,this.XHR=null,this.hasCountdown=!1,this.latestName="",this.nextName="",this.upcoming=[],this.upcomingIndex=0,this.upcomingLen=0,this.P2latestName="",this.P2nextName="",this.P2upcoming=[],this.P2upcomingIndex=0,this.P2upcomingLen=0;var i=this;this.init=function(){this.loading(!0),this.next(),setInterval(this.showNextUpcoming,1500)},this.showNextUpcoming=function(){if(!1!==i.upcoming){var e=i.upcoming[i.upcomingIndex];void 0!==e&&(i.nextName!=e.name&&(i.countdownNextNameEl.empty().hide().append(e.name).slideDown("fast"),i.nextName=e.name),++i.upcomingIndex,i.upcomingIndex==i.upcomingLen&&(i.upcomingIndex=0),!1!==i.P2upcoming&&void 0!==(e=i.P2upcoming[i.P2upcomingIndex])&&(i.P2nextName!=e.name&&(i.P2countdownNextNameEl.empty().hide().append(e.name).slideDown("fast"),i.P2nextName=e.name),++i.P2upcomingIndex,i.P2upcomingIndex==i.P2upcomingLen&&(i.P2upcomingIndex=0)))}},this.loading=function(t){t?(this.loadingEl.show(),this.activeContainerEl.hide()):(this.loadingEl.hide(),this.boxContainerEl.slideDown("fast"),e("#betaInviteTimer").css("cursor","pointer"),e("#betaInviteTimer").click((function(){var t=e("#betaInviteTimer").data("url");document.location=t})),this.activeContainerEl.show())},this.expiry=function(){this.countdownEl.fadeOut(),this.countdownEl.countdown("destroy"),this.countdownEl.fadeIn(),this.next()},this.startInterval=function(){null===this.intervalId&&(this.intervalId=setInterval(function(e){return function(){e.next()}}(this),3e3))},this.endInterval=function(){null!==this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null)},this.countdown=function(e,t,n){var i=0;!1!==e&&this.latestName!=e.name&&(this.countdownLastNameEl.empty().hide().append(e.name).fadeIn(),this.latestName=e.name),!1===t?("**NONE**"!=this.nextName&&(this.countdownNextNameEl.empty().hide().append('<span class="none">None</span>').fadeIn(),this.nextName="**NONE**"),this.upcoming=!1,this.upcomingIndex=0,this.upcomingLen=0,this.startInterval()):(this.upcomingIndex=0,this.upcoming=t,this.upcomingLen=t.length,i+=n),i<=0&&(i=1),this.hasCountdown?this.countdownEl.countdown({until:i,layout:'<div class="minutes">{mn}</div><div class="seconds">{sn}</div>',onExpiry:function(e){return function(){e.expiry()}}(this)}):(this.countdownEl.countdown({until:i,layout:'<div class="minutes">{mn}</div><div class="seconds">{sn}</div>',onExpiry:function(e){return function(){e.expiry()}}(this)}),this.hasCountdown=!0)},this.next=function(){if(null===this.XHR){var t=this;this.XHR=e.ajax({url:"/scripts/beta-invite-query.php?mode=next",async:!0,cache:!1,dataType:"json",data:{id:this.id},success:function(e){switch(t.endInterval(),e.action){case"end":t.end();break;case"update":t.countdown(e.p1.last,e.p1.upcoming,e.p1.next_s),t.loading(!1)}t.XHR=null},error:function(e,n,i){t.endInterval(),t.end(),t.XHR=null}})}},this.end=function(){this.boxContainerEl.slideUp("fast",(function(){e(this).remove()}))},this.checkName=function(){},this.serverSync=function(){var t=null;return e.ajax({url:"/index/beta-invite-query/mode/sync",async:!1,dataType:"json",success:function(e){t=new Date(e)},error:function(e,n,i){t=new Date}}),t},this.init()}})),define("PoE/Backbone/Model/Item/SocketedItem",["Backbone"],(function(e){return e.RelationalModel.extend({idAttribute:"_id",relations:[{type:e.HasOne,key:"vaal"}]})})),define("PoE/Backbone/Collection/Item/SocketedItemCollection",["Backbone","PoE/Backbone/Model/Item/SocketedItem"],(function(e,t){return e.Collection.extend({model:t})})),define("PoE/Backbone/Model/Item/Item",["Backbone","./SocketedItem","PoE/Backbone/Collection/Item/SocketedItemCollection"],(function(e,t,n){return e.RelationalModel.extend({idAttribute:"_id",relations:[{type:e.HasMany,key:"socketedItems",relatedModel:t,collectionType:n},{type:e.HasOne,key:"vaal"}]})})),define("PoE/DOM/DeferredLoader",[],(function(){var e=function(e){this.threshold=e&&e.threshold?e.threshold:0,this.jobs=[],this.$window=$(window),this.viewPort={top:null,bottom:null};var t=this;this.updatePositions(),this.jobTimer=!1,this.$window.scroll((function(){this.jobTimer&&clearTimeout(this.jobTimer),this.jobTimer=setTimeout((function(){t.processJobs()}),500)}))};return e.prototype.processJobs=function(){this.updatePositions();for(var e=this.jobs.length-1;e>=0;--e){var t=this.jobs[e];this.processJob(t)&&this.jobs.splice(e,1)}},e.prototype.updatePositions=function(){this.viewPort.top=this.$window.scrollTop(),this.viewPort.bottom=this.viewPort.top+this.$window.height()},e.prototype.processJob=function(e){if(e.acceptFunc&&e.acceptFunc(e.element)){var t=e.element.offset().top,n=t+e.element.height();if(t>=this.viewPort.top-this.threshold&&n<=this.viewPort.bottom+this.threshold)return e.callback(),!0}return!1},e.prototype.deferLoad=function(e,t,n){var i={element:e instanceof $?e:$(e),callback:t};n&&n.acceptFunc&&(i.acceptFunc=n.acceptFunc),this.processJob(i)||this.jobs.push(i)},e})),define("PoE/Util/ThrottledExecutor",[],(function(){var e=function(e){this.throttle=e&&e.throttle?e.throttle:1,this.threads=e&&e.threads?e.threads:1,this.jitter=e&&e.jitter?e.jitter:0,this.jobs=[],this.numThreads=0};return e.prototype.execute=function(e){this.numThreads<this.threads?this.runThread(e):this.jobs.push(e)},e.prototype.processNextJob=function(e){this.jobs.length>0&&this.runThread(this.jobs.shift())},e.prototype.runThread=function(e){++this.numThreads;var t=e(),n=this,i=$.Deferred();i.done((function(){setTimeout((function(){--n.numThreads,n.processNextJob()}),n.throttle+(0==n.jitter?0:Math.floor(Math.random()*n.jitter+1)))})),t&&t.promise?t.done((function(){i.resolve()})):i.resolve()},e})),define("PoE/Item/LayoutManager",["PoE/DOM/Util"],(function(e){var t=function t(){var n=function(n){n.offset();var i=n.prev(),o=(n.next(),function(e){return e.hasClass("newItemContainer")||e.hasClass("itemFragment")||e.hasClass("itemUnavailable")}),r=function(e){return e.hasClass("itemRendered")||e.hasClass("itemUnavailable")},a=function(e){return e.hasClass("itemSmartLayoutStop")},s=function(e){return e.hasClass("itemSmartLayoutBreak")},l=function(e,t){e.attr("data-last-offset-top",t.top),e.attr("data-last-offset-left",t.left)},c=function(){var e=$('<div class="itemSmartLayoutBreak itemSmartLayoutStop"></div>');return t.debug&&e.css("background","cyan").css("height","2px"),e},d=function(){var e=$('<div class="itemSmartLayoutBreak"></div>');return t.debug&&e.css("background","red").css("height","2px"),e},u=function(e){for(var n,i,u,h=e;;){if(t.debug&&(h.css("background","green"),setTimeout(function(e){return function(){e.css("background","")}}(h),5e3)),0==(n=h.next()).length)return void h.after(c());if(a(n))return;if(s(n)){var p=h.offset(),f=h.data("last-offset-top"),v=h.data("last-offset-left"),m=n;m.data("last-offset-top");if(p.top==f&&p.left==v)return;if(p.left==v)return;var g=(n=m.next()).offset();m.remove();var y=n.offset();if(g.top==y.top&&g.left==y.left){l(h,p);var b=d();return n.before(b),void l(b,b.offset())}n=h}else{if(!o(n))return void n.before(c());if(!r(n))return;p=h.offset(),g=n.offset();if(i=p,(u=g).top>i.top||u.left<i.left){l(h,p);b=d();n.before(b),l(b,b.offset());var w=n.offset();if(w.top==g.top&&w.left==g.top)return}}h=n}};return e.isPrevSiblingTextNode(n)?(n.before(c()),void u(n)):e.isNextSiblingTextNode(n)?(n.after(c()),void u(n)):0!=i.length?o(i)||s(i)?void u(i):(n.before(c()),void u(n)):void u(n)};this.smartLayout=function(e){e.on("render",(function(){n(e.$el)}))},this.smartLayoutEl=function(e){n(e)}};return t.debug=!1,t})),define("PoE/Backbone/EventBus",["Backbone","Underscore"],(function(e,t){return t.extend({},e.Events)})),define("PoE/Item/DeferredItemRenderer",["PoE/Backbone/Model/Item/Item","PoE/Item/Item","PoE/DOM/DeferredLoader","PoE/Util/ThrottledExecutor","PoE/Item/LayoutManager","PoE/Backbone/EventBus"],(function(e,t,n,i,o,r){var a=function(e){this.config=e||[]};return a.prototype.run=function(){var a=new n({threshold:200}),s=new i({throttle:4,threads:6,jitter:3}),l=new o;r.on("spoilerShow",(function(){a.processJobs()}));for(var c=0,d=this.config.length;c<d;++c){var u=$("#item-fragment-"+this.config[c][0]),h=this.config[c][2],p=void 0===h.enableSmartLayout||h.enableSmartLayout,f=new t({el:u,enableVerified:void 0===h.enableVerified||h.enableVerified,enableLeague:void 0===h.enableLeague||h.enableLeague,showSockets:void 0!==h.showSockets&&h.showSockets,model:new e(this.config[c][1])});p&&l.smartLayout(f),a.deferLoad(u,function(e){return function(){s.execute((function(){e.render(),e.trigger("displayed"),e.$el.removeClass("itemFragment")}))}}(f),{acceptFunc:function(e){return e.is(":visible")}})}p&&$(".itemUnavailable").each((function(){l.smartLayoutEl($(this))}))},a})),define("PoE/Forum",["jquery","PoE/Backbone/EventBus","PoE/Helpers","moment"],(function(e,t,n,i){window.POE=window.POE||{};var o=window.POE;o.Forum={},o.Forum.SpoilerClick=function(i){var o=e(i),r=e(i).parent().parent(),a=r.children(".spoilerContent:first");return r.hasClass("spoilerHidden")?(o.val(n.translate("Hide")),a.hide(),r.removeClass("spoilerHidden").addClass("spoilerVisible"),a.slideDown(400,(function(){t.trigger("spoilerShow")}))):(o.val(n.translate("Show")),a.fadeOut("fast",(function(){r.removeClass("spoilerVisible").addClass("spoilerHidden")}))),!1},o.Forum.FaqClick=function(t){var n=e(t).next(".forum-faq-answer");return!!n&&(e(t).toggleClass("open"),n.toggleClass("hidden"),!1)},o.Forum.ShowAllFaqClick=function(t){return e(t).hasClass("show")?(e(".forum-faq-answer").each((function(t,n){e(n).addClass("hidden")})),e(".forum-faq-question").each((function(t,n){e(n).removeClass("open")}))):(e(".forum-faq-answer").each((function(t,n){e(n).removeClass("hidden")})),e(".forum-faq-question").each((function(t,n){e(n).addClass("open")}))),e(t).toggleClass("show"),e(t).find(".show-all-text, .hide-all-text").toggleClass("hidden"),!1},e(".report-post a").click((function(t){var n=e(t.target).parent().data();e('#forum-report-box #forum-report-form input[name="reported_name"]').val(n.name),e('#forum-report-box #forum-report-form input[name="forum_post_id"]').val(n.postid),e("#forum-report-box #forum-report-form .reported_name").text(n.name),e('#forum-report-box #forum-report-form textarea[name="description"]').val(""),e('#forum-report-box #forum-report-form select[name="type"]').val(""),e(this).colorbox({width:"650px",height:"380px",href:"#forum-report-box",inline:!0,className:"colorBoxTheme1",onComplete:function(t){e("#forum-report-box").show()},onCleanup:function(){e("#forum-report-box").hide()}})})),e("#forum-report-form").submit((function(t){var n=e(this).find('input[type="submit"]'),i=n.css("background"),o=n.css("color"),r=n.css("border-color"),a=n.css("padding-left"),s=n.val();n.prop("disabled",!0),n.css("background","#1f202c url('/image/UI/loader/loading-1.gif?1375395152') no-repeat 3px 3px"),n.css("padding-left","25px"),n.val("Submitting...");var l=e(this).serialize();e(this).find('select[name="type"]').val()?e.ajax({url:"/api/report",type:"POST",dataType:"json",data:l,success:function(t){n.css("background","#173517"),n.css("color","#86ff4d"),n.css("border-color","#647a64"),n.css("padding-left",a),n.val("Submitted"),setTimeout((function(){e.colorbox.close(),n.css("background",i),n.css("color",o),n.css("border-color",r),n.val(s)}),1500)},complete:function(){setTimeout((function(){n.prop("disabled",!1)}),1500)}}):(alert("Please select a Report Type"),n.css("background",i),n.css("color",o),n.css("border-color",r),n.css("padding-left",a),n.val(s),n.prop("disabled",!1)),t.preventDefault()})),e(".uiBumpButton").click((function(t){t.preventDefault();var i=e(this).data("thread"),o=e(this).data("unbump"),r=e(this),a=e(this).parentsUntil(".post_info").last().find(".bump-thread-result"),s={id:i};o&&(s.unbump=!0),e.ajax({url:"/api/forum-bump",method:"POST",dataType:"json",data:s,success:function(e){if(e.result)r.addClass("disabled"),a.addClass("success"),e.unbumped?a.html(n.translate("Thread Bump removed")):a.html(n.translate("Thread Bumped"));else{r.addClass("disabled"),a.addClass("error");var t="Thread Already bumped";e.error&&e.error.message&&(t=e.error.message),a.html(n.translate(t))}setTimeout((function(){a.fadeOut(500)}),1e3)},error:function(e){a.html(n.translate("Failed to Bump Thread"))}})})),e(".forumTable .points").on("click",(function(t){if(e(this).hasClass("disabled")||e(this).hasClass("voted"))alert(e(this).attr("title")),e(this).hasClass("guest")&&window.TencentLogin();else{var i=e(this),o=e(this).data("post");e.ajax({url:"/api/forum-points",method:"POST",dataType:"json",data:{post:o},success:function(t){if(i.addClass("disabled"),t.result){if(t.points&&i.find(".points-value").html(t.points),t.pointsRemaining){var o=n.translate("Give this post a point if you think they did a good job.");e(".points:not(.disabled):not(.voted)").attr("title",o)}else e(".points:not(.disabled):not(.voted)").addClass("disabled").attr("title",n.translate("You don't have enough points!"));i.removeClass("disabled").addClass("voted").attr("title",n.translate("Good job!"))}else alert(t.message)},error:function(e){i.addClass("disabled"),alert(e.message)}})}t.preventDefault()}));var r=function(){var t=[];e(".forumIndexTable:has(tr.expand-category) > tbody").each((function(){var n=e(this).parent(".forumIndexTable"),i=0;e(this).children("tr").each((function(){e(this).toggleClass("even",++i%2==0)}));var o=e(this).sortable("toArray",{attribute:"data-id"});o=e.map(o,(function(e,t){return+e})),t.push({id:n.data("id"),collapsed:!n.find(".expand-category").first().data("toggled"),forums:o})})),e.ajax({url:"/api/forum/preferences?type=categories-layout",type:"POST",contentType:"application/json",data:JSON.stringify(t)})};e(document).ready((function(){var t=!0;e(".forumIndexTable > thead > .expand-category").on("click",(function(i){var o=e(this).data("toggled");if(o)!function(e){var t=e.parents("table:first"),i=t.find("tr:not(.heading)"),o=t.find("tr.heading");o.find("th:not(.forum)").find("img").hide(),i.addClass("hidden").hide(),o.find("div.view-more-button").html(n.translate("[ Expand ]"))}(e(this));else{var a=e(this).parents("table:first"),s=(a.find("tr:not(.heading)"),a.find("tr.heading"));t&&(s.find("img.hidden").hide().removeClass("hidden").fadeIn("slow"),t=!1),function(e){var t=e.parents("table:first"),i=t.find("tr:not(.heading)"),o=t.find("tr.heading");o.find("th:not(.forum)").find("img").show(),i.removeClass("hidden").show(),o.find("div.view-more-button").html(n.translate("[ Collapse ]"))}(e(this))}e(this).data("toggled",!o),r(),i.preventDefault()})),e(".forumIndexTable:has(tr.expand-category) > tbody").each((function(t){e(this).sortable({containment:e(this),tolerance:"pointer",items:"tr",axis:"y",placeholder:"ui-state-highlight",cancel:"a,button",cursor:"move",opacity:.8,delay:150,start:function(e,t){t.placeholder.height(t.item.height())},update:r})}))})),e("#search-button").click((function(){e(".forumSearchForm form").submit()})),e(".clear_viewed").on("click",(function(){var t=e(this),i=t.data("id"),o=t.data("type"),r="";switch(o){case"f":r="/forum/set-forum-read/";break;case"t":r="/forum/set-thread-read/"}e.ajax({url:r+i,type:"GET",success:function(i){var r=e("<img>"),a=e("<div></div>"),s=t.parent().children(".status"),l="",c="";if("f"==o)l="/image/forum/read-no-new.png",c=n.translate("No unread posts");else{if("t"!=o)return;l="/image/forum/read-no-new.png",c=n.translate("No new posts since you last read this thread")}s.find("a").attr("title",c),r.attr("src",l),a.append(r).hide(),s.children("div").append(a),a.fadeIn(500,(function(){s.find("img").attr("src",l),a.remove()})),t.fadeOut("slow")},error:function(e){alert("There was a problem processing your request. Please try again later")}})})),e(".mark-reviewed a").click((function(t){t.preventDefault();var o=e(t.target).parent().data();o.postid||alert("No post id");var r="/api/forum-review"+("1"==o.reviewed?"/"+o.postid:""),a="1"==o.reviewed?{}:{review:[o.postid]};e.ajax({url:r,type:"1"==o.reviewed?"DELETE":"POST",data:JSON.stringify(a),dataType:"json",contentType:"application/json",success:function(r){var a=e(t.target).parents(".post_info_content");if(a.find(".reviewed-by, .reviewed-at").hide(),"0"==o.reviewed){var s="".concat(n.translate("Reviewed by"),' <span class="profile-link staff support"><a href="/account/view-profile/').concat(o.reviewer,'">').concat(o.reviewer,"</a></span>"),l="".concat(n.translate("On")," ").concat(i().format("MMM D, YYYY h:m:s A"));if(0==a.find(".reviewed-by").length){var c='<div class="reviewed-by">'.concat(s,"</div>");c+='<div class="reviewed-at">'.concat(l,"</div>"),a.find(".mark-reviewed").before(c)}else a.find(".reviewed-by").html(s).show(),a.find(".reviewed-at").text(l).show();"0"==o.canDelete&&a.find(".mark-reviewed").hide()}a.find(".mark-reviewed a").text("1"==o.reviewed?n.translate("Mark As Reviewed"):n.translate("Delete Reviewer")),a.find(".mark-reviewed").data("reviewed","1"==o.reviewed?"0":"1")},error:function(e){if(e&&e.responseText){var t=JSON.parse(e.responseText);alert(t.error.message)}},complete:function(){}})}))})),define("PoE/Forum/AutosaveWatcher",["require","jquery"],(function(e){var t=e("jquery");return function(e,n,i,o){var r=this;this.$el=t(e),this.lastSaveCharLength=this.$el.val()?this.$el.val().length:0,this.currentCharLength=this.lastSaveCharLength,this.forceSaveChars=5,this.forceSaveInterval=1e4,this.dirty=!1,this.inputTimeout=null,this.inputSaveTimeout=1e3,this.doSave=function(){r.lastSaveCharLength=r.currentCharLength,r.dirty=!1,i()};var a=this.$el.selector&&"#tags"==this.$el.selector?"change":"input";this.$el.on(a,(function(){n(),r.dirty=!0,r.currentCharLength=r.$el.val()?r.$el.val().length:0,null!==r.inputTimeout&&clearTimeout(r.inputTimeout),r.inputTimeout=setTimeout((function(){Math.abs(r.currentCharLength-r.lastSaveCharLength)>=r.forceSaveChars&&r.doSave(),r.inputTimeout=null}),r.inputSaveTimeout)})),setInterval((function(){r.dirty&&r.doSave()}),this.forceSaveInterval)}})),define("PoE/Forum/Autosave",["require","jquery","moment-tz","./AutosaveWatcher","PoE/Helpers"],(function(e){var t=e("jquery"),n=e("moment-tz"),i=e("./AutosaveWatcher"),o=e("PoE/Helpers");return function(e,r,a,s){this.$status=t(e),this.$status.addClass("forumDraftStatus");var l=this;this.saving=!1,this.repeatSave=!1,this.$savingStatus=t('<div class="savingStatus">'+o.translate("Saving draft")+'.<span class="loading-inline"></span></div>'),this.$lastSaved=t('<div class="lastSave"></div>').hide(),this.$revertible=t('<a class="revertible" href="#">'+o.translate("You are editing a saved draft. Click here to edit the original.")+"</div>"),this.$savingStatus.hide(),s.revertible&&(this.$status.append(this.$revertible),this.$revertible.on("click",(function(e){e.preventDefault(),s.revertible()&&l.$revertible.remove()}))),this.$status.append(this.$savingStatus).append(this.$lastSaved),this.modified=!1,this.lastSaveTime=null,this.showSaving=function(e){},this.setLastSaved=function(){},this.updateLastSaved=function(){l.$lastSaved.show(),l.$lastSaved.text(o.translate("Draft "+(this.modified?"out of sync":"up to date"))+"."+(null===this.lastSaveTime?"":o.translate(" Saved at ")+this.lastSaveTime.format("h:mm:ss a, MMMM Do YYYY")))},this.save=function(){if(!l.saving){l.modified=!1,l.showSaving(!0);var e=s.dataFactory();return l.saving=!0,t.ajax({url:s.url,type:"PUT",dataType:"json",data:JSON.stringify(e),contentType:"application/json",success:function(e){l.lastSaveTime=n(),l.updateLastSaved()},error:function(){}}).always((function(){l.showSaving(!1),l.saving=!1,l.repeatSave&&(l.repeatSave=!1,l.save())}))}l.repeatSave=!0},this.watchers=[];for(var c=0,d=s.watch.length;c<d;++c)this.watchers.push(new i(s.watch[c],(function(){l.modified=!0,l.updateLastSaved()}),(function(){l.save()}),{}))}})),define("PoE/Forum/Thread/Autosave",["require","jquery","moment-tz","PoE/Forum/Autosave"],(function(e){var t=e("jquery"),n=(e("moment-tz"),e("PoE/Forum/Autosave"));return function(e,i,o,r,a,s){var l,c,d=t(i),u=t(e),h=[d,u],p=s&&s.isNewsForum,f=[t("input[type=checkbox][name=notify_owner]"),t("#tags"),t("input[type=checkbox][name=sticky]"),t("input[type=checkbox][name=valued]"),t("input[type=checkbox][name=locked]"),t("input[type=checkbox][name=wide_format_news]"),t("input[type=checkbox][name=front_page]"),t("#thread_start_time")];switch(r){case"new":l="forumId";break;case"edit":l="threadId";break;default:return}c={url:"/api/forum/thread/draft",watch:p?h.concat(f):h,dataFactory:function(){var e={};return e.content=d.val(),e.title=u.val(),e[l]=a,p&&(e.settings={notify_owner:f[0].prop("checked"),tags:f[1].val(),sticky:f[2].prop("checked"),valued:f[3].prop("checked"),locked:f[4].prop("checked"),wide_format_news:f[5].prop("checked"),front_page:f[6].prop("checked"),start_time:f[7].next("input")?f[7].next("input").val():""}),e}},s.revertible&&(c.revertible=function(){return!!confirm("Revert to original thread content?")&&(u.val(s.revertible.title),d.val(s.revertible.content),!0)}),this.autosave=new n(o,r,a,c)}})),define("PoE/Forum/Thread/Tags",["plugins"],(function(e){return function(t,n){e("select#tags").select2({theme:"bootstrap",language:n,tags:!0,createTag:function(e){return!1},maximumSelectionLength:t,tokenSeparators:[","]})}})),define("PoE/Forum/Thread/DatePicker",["require","flatpickr","moment","PoE/Helpers"],(function(e){var t=e("flatpickr"),n=e("moment"),i=e("PoE/Helpers"),o=function(e,t){var o=t.input.closest(".element"),r=document.getElementById("start-time-message");!e||""==e||n(e)>n()?(o.closest(".row").classList.remove("error"),r&&(r.textContent="")):(o.closest(".row").classList.add("error"),r&&(r.textContent=i.translate("Start Time can not be in the past.")))},r=t("#thread_start_time",{format:"Y-m-dTH:i",altFormat:"Y-m-dTH:i",altInput:!0,enableTime:!0,minDate:"today",onChange:function(e,t,n){o(t,n)},onReady:function(e,t,n){o(t,n)}}),a=document.getElementById("clear-start-time");r&&a&&a.addEventListener("click",(function(e){e.preventDefault(),r.clear()}))})),define("PoE/View/Profile/Badges",["require","plugins","PoE/Helpers"],(function(e){var t=e("plugins"),n=e("PoE/Helpers");return function(e,i){this.setStatus=function(e){var n=t(".profile-badges-showcase > h4 > .message");e?n.html("&nbsp;("+e+")"):n.html("")},this.updateAvailableBadges=function(){i&&t(".badges > .showcase-badge:gt("+(i-1).toString()+")").remove();var o=t(".badges > .showcase-badge").map((function(){return t(this).data("id")})),r=(t(".badge-category").each((function(e,n){var i=!1,r=function(e,n){n||void 0===n?(t(e).removeClass("disabled"),t(e).draggable("option","disabled",!1)):(t(e).addClass("disabled"),t(e).draggable("option","disabled",!0))},a=t(n).find(".badge");a.each((function(e,n){var a=t(n).data("id");t.inArray(a,o)>=0?(i=!0,r(n,!1)):r(n,!0)})),i&&a.each((function(e,n){t(n).hasClass("custom")||r(n,!1)}))})),"");if(i){var a=o.length>=i;t(".profile-badges-showcase").toggleClass("full",a),a?r=n.translate("limit reached!"):e&&(r=n.translate("max: {MAX}",{"{MAX}":i}))}this.setStatus(r)},this.submitBadges=function(){var e=this,i=t(".badges").sortable("toArray",{attribute:"data-id"});t(".badges").sortable("disable"),t.ajax({url:"/api/badges",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({badges:i}),success:function(i){e.setStatus(n.translate("Saved!")),t(".badges").sortable("enable")},error:function(e,i,o){alert(n.translate("An error occurred. Please try again later.")),t(".badges").sortable("enable")}})},this.render=function(){var n=this;t(document).ready((function(){var i=e?"badge roleLabel":"badge";t(".badges").sortable({items:"> .badge",placeholder:i,update:function(e,i){t(i.item).removeClass("ui-draggable").removeClass("ui-draggable-handle"),t(".badges > .badge").addClass("showcase-badge").removeAttr("style"),t(this).sortable("refresh"),n.updateAvailableBadges(),n.submitBadges()},start:function(e,n){t(".badges").addClass("highlight")},stop:function(e,n){t(".badges").removeClass("highlight")}}).disableSelection(),t(".badge-category > .badge").draggable({connectToSortable:".badges",revert:"invalid",revertDuration:0,helper:"clone",appendTo:"body",zIndex:100,drag:function(e,n){t(".badges").addClass("highlight")},stop:function(e,n){t(".badges").removeClass("highlight")}}).disableSelection(),t(".profile-badges-available").droppable({accept:".showcase-badge",over:function(e,n){t(".trash-overlay").show(),t(".badges").removeClass("highlight")},out:function(e,n){t(".trash-overlay").hide(),t(".badges").addClass("highlight")},drop:function(e,i){t(i.draggable).removeClass("showcase-badge"),t(i.draggable).remove(),t(i.helper).remove(),t(".trash-overlay").hide(),n.updateAvailableBadges()}}).disableSelection(),n.updateAvailableBadges()}))},this.render()}})),define("PoE/Forum/Post/Autosave",["require","jquery","moment-tz","PoE/Forum/Autosave"],(function(e){var t=e("jquery"),n=(e("moment-tz"),e("PoE/Forum/Autosave"));return function(e,i,o,r,a){var s,l,c=t(e);switch(o){case"new":s="threadId";break;case"edit":s="postId";break;default:return}l={url:"/api/forum/post/draft",watch:[c],dataFactory:function(){var e={};return e.content=c.val(),e[s]=r,e}},a.revertible&&(l.revertible=function(){return!!confirm("Revert to original post content?")&&(c.val(a.revertible.content),!0)}),this.autosave=new n(i,o,r,l)}})),define("PoE/Form",["jquery"],(function(e){window.POE=window.POE||{},window.POE.Form=function(t,n,i){this.formEl=t,this.submit=function(){this.formEl.submit()},this.init=function(){var t=this;this.opts={successFunc:function(e){},dataPreSubmitFunc:function(e){},url:"/"},e.extend(this.opts,i),this.formEl.submit((function(){t.clearMessages();for(var i={},o=0,r=n.length;o<r;++o){var a=n[o],s=t.getValue(a);null!==s&&(i[a]=s)}return t.opts.dataPreSubmitFunc(i),e.ajax({url:t.opts.url,type:"POST",dataType:"json",data:i,success:function(e){return function(t){t.status?e.opts.successFunc(t):e.addMessages(t.messages)}}(t)}),!1}))},this.clearMessages=function(){this.formEl.find(".errors").remove()},this.addMessages=function(t){for(var i=0,o=n.length;i<o;++i){var r=n[i],a="";if(void 0!==t[r]){for(var s in t[r])a+="<li>"+t[r][s]+"</li>";var l=this.formEl.find('[name="'+r+'"]'),c=e('<ul class="errors">'+a+"</ul>").hide();l.parents("div.form-text-l:first").after(c)}}this.formEl.find("ul.errors").fadeIn("fast")},this.getValue=function(t){var n=this.formEl.find('[name="'+t+'"]'),i=n.length,o=null;return i>1?n.each((function(t,n){(n=e(n)).is(":checkbox")?n.is(":checked")&&(null===o&&(o=[]),o.push(n.val())):o.push(n.val())})):o=n.val(),o},this.init()}})),define("PoE/Widget/YoutubeVideo",["require","jquery"],(function(e){var t=e("jquery");return function(e){var n=e instanceof t?e:t(e);if(n.length&&!n.attr("src")){var i=n.data("src");if(i&&n.attr("src",i),n.hasClass("deferLoad")){var o=t("<iframe>");o.attr("width",n.data("width")),o.attr("height",n.data("height")),o.attr("src","//www.youtube.com/embed/"+n.data("id")+"?autoplay=false&rel=0&wmode=opaque&showinfo=false"),o.attr("allowfullscreen",n.data("allowfullscreen")?"":null),o.addClass("video"),n.replaceWith(o)}}}})),define("PoE/Shop",["require","plugins","PoE/Helpers","PoE/Widget/YoutubeVideo","PoE/Backbone/EventBus"],(function(e){var t=e("plugins"),n=e("PoE/Helpers"),i=e("PoE/Widget/YoutubeVideo"),o=e("PoE/Backbone/EventBus"),r={init:function(){this.shopBuyItemModalSelector=".shopBuyItemModal",this.loadingTextSelector=".loadingText",this.singleOwnedIconSelector=".singleOwnedIcon",this.buyButtonSelector=".buyButton",this.disabledButtonSelector=".buyButtonDisabled",this.buyPointsButtonSelector=".buyPointsButton",this.buyForFriendSelector=".buy-for-friend",this.contentSelector=".content",this.friendRowSelector=".friend-selector .row",this.friendCheckboxSelector=".buy-for-friend-checkbox",this.addedClass="added",this.disabledClass="disabled"},setCategoryData:function(e){this.urlId=e.urlId||null,this.accountPoints=e.accountPoints||0,this.guildPoints=e.guildPoints||0,this.isConnected=e.isConnected||!1,this.name=e.name||""},getCategory:function(){return this.urlId},toggleWatchlistItem:function(e,i,o,r){var a=this,s=n.translate("Remove from Watchlist"),l=n.translate("Add to Watchlist");return new Promise((function(n,c){o.addClass(a.disabledclass),t.ajax({url:"/shop/watchlist-item",type:"POST",dataType:"json",data:{item:e,watch:i,hideMessage:r},success:function(e){if("watchlist"==a.getCategory())location.reload();else{var t=e?s:l;o.html(t),o.toggleClass(a.addedClass,e),o.removeClass(a.disabledclass)}n(!0)},error:function(e){o.removeClass(a.disabledclass),c(!1)}})}))},setupModal:function(e,n,a,s){var l=this;e.find(l.buyButtonSelector).click((function(e){e.preventDefault();var i=t(e.currentTarget).data("quick-buy");l.buyItem(n,e.currentTarget,i)})),e.find(".variantSelector button.variant").click((function(e){var n=t(e.target).is("button")?t(e.target):t(e.target).parent("button:first");o.trigger("shop-modal:select-variant",n.data())})),e.find(".variantSelector button.variant").length>5&&e.find(".variantSelector").scrollbar({showArrows:!0,scrollx:e.find(".variantScroll").addClass("poeScroll"),ignoreMobile:!0}),e.find(l.friendCheckboxSelector).change((function(e){l.toggleFriend(e.currentTarget)})),e.find(l.friendRowSelector).click((function(e){e.preventDefault(),l.selectFriend(e.currentTarget)})),e.find(".shopBackButton").click((function(e){e.preventDefault(),l.cancelBuyItem()})),e.find("button.showVideo").click((function(){e.find("div.largeImage").hide(),e.find("div.videoEmbed").show(),new i(e.find(".video"))})),s?(e.find(".givePointsToGuild").hide(),e.find(l.buyButtonSelector).show()):(e.find(l.buyPointsButtonSelector).hide(),e.find(l.buyButtonSelector).show()),e.find(l.singleOwnedIconSelector).length>0?l.updateBuyButton(e,e.find(l.singleOwnedIconSelector).data("owned")):(e.find("".concat(l.buyButtonSelector,", .totalCost")).show(),t(l.buyForFriendSelector).show(),a||(t(l.buyForFriendSelector).hide(),s?(e.find(".givePointsToGuild").show(),e.find(l.buyButtonSelector).hide()):(e.find(l.buyPointsButtonSelector).show(),e.find(l.buyButtonSelector).hide()))),e.find("".concat(l.disabledButtonSelector,", .purchasingInfo, .shopBackButton, .purchasedInfo, .errorInfo")).hide();var c=e.find(".remove-watchlist-container");c.length>0&&t(c).find(".watchlist").click((function(e){e.preventDefault(),t(this).parents(".remove-watchlist-container").find("a").addClass(l.disabledClass);var n=t(this).hasClass("hideMessage"),i=n,o=t(this).data("item-id");r.toggleWatchlistItem(o,i,t(".shopItemBase[data-item-id='".concat(o,"']")).find(".controls .watchlist"),n).then((function(){var e=t(".shopItemBase[data-item-id='".concat(o,"']"));e.find(".remove-watchlist").length>0&&(e.find(".remove-watchlist").remove(),e.find(".purchasedInfo").removeClass("onWatchlist"))})).finally((function(){POE.Shop.cancelBuyItem()}))}))},showBuyItemModal:function(e,n,o,r){if(!t("#colorbox").is(":visible")){var a=t("#".concat(e)),s=a.find("".concat(this.shopBuyItemModalSelector,":first")),l=a.find("h1.name").text(),c=a.find(".video"),d=this;if(!a.find("".concat(this.buyButtonSelector,":First")).hasClass("buyButtonDisabled")){var u="/shop/item/".concat(e);if(window.location.pathname!==u&&(history.replaceState({itemID:e},"","".concat(u).concat(window.location.search?window.location.search:"")),this.setShopTitle("item",l)),c.length)new i(c);return t(document).bind("cbox_open",(function(){d.setupModal(s,r||e,n,o),s.show();var t=s.find(".lineItems .lineItem");s.find(".description").width("230px"),s.find(".lineItems").width("230px"),t&&s.find(".description").height()+s.find(".lineItems").height()>s.find(".poeScroll").height()&&(s.find(".description").width("215px"),s.find(".lineItems").width("211px"),s.find(".poeScroll").scrollbar({showArrows:!0,scrollx:"advanced",scrolly:"advanced",ignoreMobile:!0}))})),t(document).bind("cbox_cleanup",(function(){s.find(this.friendCheckboxSelector).prop("checked")&&s.find(this.friendCheckboxSelector).prop("checked",!1).change(),s.hide();var e=s.find(this.buyForFriendSelector);e.length&&e.find("input").prop("checked")&&e.find("input").prop("checked",!1);var n=d.getCategory(),i="watchlist"===n?"/shop/watchlist":"/shop/category/".concat(n);window.location.pathname!==i&&(history.replaceState({category:d.getCategory()},"","".concat(i).concat(window.location.search?window.location.search:"")),d.setShopTitle("category")),t(document).find(d.buyButtonSelector).unbind(),t(document).unbind("cbox_open"),t(document).unbind("cbox_cleanup")})),t.colorbox({inline:!0,href:s,className:"colorBoxTheme1 shopModal",scrolling:!1,height:function(e){var t=e.h+10;return s.hasClass("variantGroup")&&(t+=179),s.find(".variant").length>5&&(t+=40),t}}),!1}}},buyItem:function(e,n,i){n=t(n);var o=this,r=n.closest(this.shopBuyItemModalSelector),a=r.find(this.buyButtonSelector),s=r.find(this.disabledButtonSelector),l=r.find(".purchasingInfo"),c=r.find(".shopBackButton"),d=r.find(".purchasedInfo"),u=r.find(".errorInfo"),h=u.find(".message"),p=r.find(".totalCost");$savings=r.find(".savings"),$removeWatchlist=r.find(".remove-watchlist-container");var f="";return d.hide(),l.hide(),r.find(this.friendCheckboxSelector).prop("checked")&&(f=r.find("".concat(this.friendRowSelector,".selected")).html()),f&&!confirm("Are you sure you want to buy this item for "+f+"?")||(a.hide(),l.show(),p.hide(),$savings.hide(),s.show(),t(this.buyForFriendSelector).hide(),t(this.buyForFriendSelector).prop("checked",!1),t("".concat(this.shopBuyItemModalSelector," ").concat(this.contentSelector)).animate({right:"0px"},600),t("".concat(this.shopBuyItemModalSelector," ").concat(this.buyForFriendSelector)).animate({left:"650px"},600),t.ajax({url:"/shop/buy-item",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({itemID:e,friendName:f,expectedPrice:parseInt(p.text())}),success:function(t){if(l.hide(),s.hide(),i?a.show():c.show(),!1===t)h.text("An error has occurred."),u.show();else switch(t.status){case"success":d.show(),$removeWatchlist.length>0&&(c.hide(),$removeWatchlist.css("display","flex"));break;case"error":h.text(t.message),u.show()}o.reloadShopItem(e)},error:function(e,t,n){return l.hide(),c.show(),s.hide(),e.responseJSON&&e.responseJSON.message?h.text(e.responseJSON.message):h.text("An error has occurred."),u.show(),!1}})),!1},toggleFriend:function(e){var n=this,i=(e=t(e)).parents(this.shopBuyItemModalSelector),o=i.find(this.singleOwnedIconSelector).length>0;e.prop("checked")?(t(this.friendRowSelector).removeClass("selected"),i.find("".concat(this.friendRowSelector,":first-child")).addClass("selected"),o&&this.showDisableButton(e),i.find(this.contentSelector).animate({right:"200px"},600),i.find(this.buyForFriendSelector).animate({left:"450px"},600,"swing",(function(){o&&n.checkFriendTransaction(e)}))):(i.find(this.contentSelector).animate({right:"0px"},600),i.find(this.buyForFriendSelector).animate({left:"650px"},600),o&&this.updateBuyButton(i,i.find(n.singleOwnedIconSelector).length>0&&i.find(n.singleOwnedIconSelector).data("owned")))},selectFriend:function(e){e=t(e),t(this.friendRowSelector).removeClass("selected"),e.addClass("selected"),this.checkFriendTransaction(e)},checkFriendTransaction:function(e){var i=e.parents(this.shopBuyItemModalSelector);if(0!=i.find(this.singleOwnedIconSelector).length){var o=i.find("".concat(this.friendRowSelector,".selected")).data("name"),r=i.find("".concat(this.friendRowSelector,".selected")).data("item-id"),a=this,s='<div class="loadingText"><span class="loading-inline"></span>'+n.translate("Loading...")+"</div>";i.find(this.disabledButtonSelector).show(),i.find(this.loadingTextSelector).length>0?(i.find("".concat(this.singleOwnedIconSelector,", ").concat(this.buyButtonSelector)).hide(),i.find(this.loadingTextSelector).show()):(i.find(this.singleOwnedIconSelector).after(s),i.find("".concat(this.singleOwnedIconSelector,", ").concat(this.buyButtonSelector)).hide()),t.ajax({url:"/shop/check-friend-transaction",type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({itemID:r,friendName:o}),success:function(t){if("error"===t.status)a.showDisableButton(e);else{var n=i.find("".concat(a.friendRowSelector,".selected")).data("name");i.find(a.friendCheckboxSelector).prop("checked")&&n==t.friendName&&a.updateBuyButton(i,t&&t.hasTransaction)}},error:function(t,n,i){a.showDisableButton(e)}})}},showDisableButton:function(e){var t=e.parents(this.shopBuyItemModalSelector);t.find(this.loadingTextSelector).hide(),t.find(this.singleOwnedIconSelector).hide(),t.find(this.buyButtonSelector).hide(),t.find(this.disabledButtonSelector).show()},updateBuyButton:function(e,t){e.find(this.loadingTextSelector).hide(),e.find(this.disabledButtonSelector).hide(),"none"===e.find(this.buyPointsButtonSelector).css("display")&&e.find(this.singleOwnedIconSelector).length>0&&(t?(e.find(this.singleOwnedIconSelector).show(),e.find(this.buyButtonSelector).hide()):(e.find(this.singleOwnedIconSelector).hide(),e.find(this.buyButtonSelector).show()))},cancelBuyItem:function(){return t.colorbox.close(),!1},reloadShopItem:function(e){t("#mtx-list").trigger("updateMtx",{itemId:e})},setShopTitle:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",i=n.translate("Shop");"item"===e&&""!==t?i=n.translate("Buy {item}",{"{item}":t}):"category"===e&&""!==this.name&&(i=n.translate("Shop {category}",{"{category}":this.name})),document.title="".concat(i," - Path of Exile")}};return r.init(),r})),define("PoE/View/Widget/Pagination",["plugins","Backbone","Handlebars","PoE/Loader","PoE/Handlebars/Helpers"],(function(e,t,n,i){return t.View.extend({initialize:function(){this.collection.on("reset",this.doReset,this),this.collection.on("change",this.render,this),this.xhr=null},events:{"click a.gotoPage":"gotoPage","change .perPageOptions":"changePerPage"},gotoPage:function(t){var n=e(t.target).data("gotopage");this.doGoToPage(n),t.preventDefault()},doGoToPage:function(e){var t=this;this.xhr&&(this.xhr.abort(),this.xhr=null),i.start(),t.trigger("loadStart");var n=this.collection.goTo(e);this.xhr=n,n.always((function(){t.trigger("loadEnd"),t.xhr=null}))},changePerPage:function(e){i.start(),this.xhr&&(this.xhr.abort(),this.xhr=null),this.trigger("loadStart"),this.collection.howManyPer(parseInt(this.$perPageOptions.find("option:selected").val(),10))},doReset:function(){i.done(),this.render()},render:function(){var e=n.compile("{{pagination2}}"),t=this.collection.info(),i={info:t,perPageOptions:this.collection.perPageOptions};t.totalRecords<=t.perPage&&0===this.collection.perPageOptions.length?this.$el.addClass("hidden"):this.$el.removeClass("hidden"),this.$el.html(e(i)),this.$perPageOptions=this.$el.find(".perPageOptions")}})})),define("PoE/Backbone/Paginator",["jquery","Backbone"],(function(e,t){return t.Paginator.requestPager.extend({resetPaginator:function(e){var t=this;_.defaults(t.paginator_ui,{firstPage:0,currentPage:1,perPage:5,totalPages:10}),_.each(t.paginator_ui,(function(e,n){_.isUndefined(t[n])&&(t[n]=t.paginator_ui[n])})),this.reset(this.parse(e))},perPageOptions:[]})})),define("text!PoE/Profile/SelectAvatar.hbt",[],(function(){return'<div class="links">\r\n    <div class="header">{{translate "Choose Avatar"}}<span class="separator">&raquo;</span></div>\r\n    <div class="selection{{#unless custom}} selected{{/unless}}"><a href="#public">{{translate "Public Avatars"}}</a></div>\r\n    {{#if hasCustom }}\r\n    <div class="selection{{#if custom}} selected{{/if}}"><a href="#custom">{{translate "Custom Avatars"}}</a></div>\r\n    {{/if}}\r\n    <div class="clearfix"></div>\r\n</div>\r\n<div class="clear"></div>\r\n<div class="avatars">\r\n{{#each avatars}}\r\n    <a href="#" class="avatar{{#if custom}} custom{{/if}}{{#if current}} current{{/if}}" data-id="{{ avatar_id }}">\r\n        <div class="content">\r\n            <img class="avatar-img" src="{{ image }}" />\r\n            {{#if custom }}\r\n            <strong class="bright2">{{ name }}</strong>\r\n            {{/if}}\r\n        </div>\r\n        <span class="control">{{#if current}}{{translate "Current Avatar"}}{{else}}{{translate "Use Avatar"}}{{/if}}</span>\r\n    </a>\r\n{{/each}}\r\n</div>\r\n<div class="clear"></div>\r\n<div class="pagination"></div>\r\n'})),define("PoE/Profile/SelectAvatar",["require","plugins","Backbone","PoE/Handlebars/TemplateCollection","PoE/View/Widget/Pagination","PoE/Backbone/Paginator","PoE/Helpers","text!PoE/Profile/SelectAvatar.hbt"],(function(e){var t=e("plugins"),n=e("Backbone"),i=e("PoE/Handlebars/TemplateCollection"),o=e("PoE/View/Widget/Pagination"),r=e("PoE/Backbone/Paginator"),a=e("PoE/Helpers");e("text!PoE/Profile/SelectAvatar.hbt");var s=n.Model.extend({}),l=r.extend({model:s,paginator_ui:{firstPage:1,currentPage:1,perPage:8,totalPages:1,custom:!1},firstPage:1,currentPage:1,perPage:8,totalPages:1,custom:!1,paginator_core:{url:"/api/account-avatar",dataType:"json"},perPageOptions:[],server_api:{page:function(){return this.currentPage},perPage:function(){return this.perPage},custom:function(){return this.custom}},parse:function(e){return this.totalRecords=e.total,this.totalPages=Math.ceil(e.total/this.perPage),e.collection}});return n.View.extend({initialize:function(e){var t=this;this.hasCustom=e.hasCustom,this.collection=new l,this.pagination=new o({collection:this.collection}),this.collection.on("reset",(function(){t.render()})),this.fetch()},events:{"click .selection a":"changeType","click .avatar":"changeAvatar"},changeType:function(e){var n=t(e.currentTarget);t(".selection a").removeClass("selected"),n.addClass("selected"),this.collection.currentPage=1,this.fetch("#custom"===n.attr("href")),e.preventDefault()},changeAvatar:function(e){var n=t(e.currentTarget);if(!n.hasClass("current")){var i=n.data("id"),o=n.hasClass("custom");this.submitChangeAvatar(n,i,o)}e.preventDefault()},submitChangeAvatar:function(e,n,i){var o=this,r=t(".avatar.current").first();t.ajax({url:"/api/account-avatar",method:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify({id:n,custom:i}),success:function(){var s=function(e,t,n){var i=o.collection.where(e);if(i.length>0)return i[0].set(t,n),i[0]},l=s({current:!0},"current",!1),c=s({avatar_id:n,custom:i},"current",!0);l&&o.collection.add(l),c&&o.collection.add(c),r.removeClass("current").find(".control").html(a.translate("Use Avatar")),e.addClass("current").find(".control").html(a.translate("Current Avatar"));var d=e.find(".avatar-img").attr("src");t("#avatar-image-container .avatar").toggleClass("frame1",!i),t("#avatar-image-container .avatar img").attr("src",d)}})},attach:function(e){var n=this;this.button=t(e),this.button.colorbox({inline:!0,scrolling:!1,className:"inventoryManagerColorbox",onLoad:function(){n.render()}})},fetch:function(e){var t=this;this.collection.custom=e,this.collection.perPage=e?8:16,this.collection.fetch().done((function(){t.render()}))},render:function(){var e=this;i.load("PoE/Profile/SelectAvatar.hbt").done((function(t){var n={hasCustom:e.hasCustom,custom:e.collection.custom,avatars:e.collection.toJSON()};e.$el.html(t(n)),e.button.colorbox.resize(),e.pagination.render(),e.$el.find(".pagination").replaceWith(e.pagination.$el),e.button.colorbox.resize(),e.pagination.delegateEvents(),e.delegateEvents()}))}})})),define("PoE/Ladder/Ladder",["plugins"],(function(e){return function(){var t=e("#ladderStatusContainer"),n=e("#leagueStatus"),i=e("#leagueCountdownBox"),o=i.find(".countdownLabel:first"),r=i.find(".timer:first"),a=e("#leagueBeginLabel"),s=e("#leagueEndLabel");this.status=null,this.init=function(){switch(LADDER_STATUS.status){case"waitStart":this.startWait();break;case"inProgress":this.startActive();break;case"complete":return void this.complete()}},this.startWait=function(){0==LADDER_STATUS.startSecFromNow?this.startActive():(this.status="waitStart",r.countdown({until:LADDER_STATUS.startSecFromNow,onExpiry:function(e){return function(){e.startActive()}}(this)}))},this.startActive=function(){var e=function(e){return function(){e.complete()}}(this);"waitStart"==this.status?(this.status="inProgress",this.updateStatus(),r.countdown("change",{until:LADDER_STATUS.endSecFromStart,onExpiry:e})):(0==LADDER_STATUS.endSecFromNow&&this.complete(),r.countdown({until:LADDER_STATUS.endSecFromNow,onExpiry:e}))},this.updateStatus=function(){n.text(LADDER_STATUS[this.status].message).removeClass().addClass(LADDER_STATUS[this.status].class),a.text(LADDER_STATUS[this.status].beginLabel),s.text(LADDER_STATUS[this.status].endLabel),o.text(LADDER_STATUS[this.status].countdownLabel).removeClass([LADDER_STATUS.waitStart.class,LADDER_STATUS.inProgress.class]).addClass(LADDER_STATUS[this.status].class)},this.complete=function(){this.status="complete",this.updateStatus(),i.fadeOut("slow",(function(){e(this).remove(),t.removeClass("ladderStatusCountdownActive")}))},this.init()}})),define("PoE/Model/Account/Account",["Backbone"],(function(e){return e.RelationalModel.extend({relations:[]})})),define("PoE/Model/League/LadderEntry",["Backbone","PoE/Model/Account/Account"],(function(e,t){return e.RelationalModel.extend({relations:[{type:e.HasOne,key:"account",relatedModel:t}],initialize:function(){}})})),define("PoE/Collection/League/LadderEntries",["jquery","Backbone","PoE/Model/League/LadderEntry","PoE/Backbone/Paginator"],(function(e,t,n,i){return i.extend({model:n,paginator_core:{url:"/api/ladders",dataType:"json"},paginator_ui:{firstPage:1,currentPage:1,perPage:5,totalPages:10},server_api:{offset:function(){return(this.currentPage-1)*this.perPage},limit:function(){return this.perPage},id:function(){return this.id},type:"league"},perPageOptions:[5,20,50,100],setSort:function(e){e?this.server_api.sort=e:delete this.server_api.sort},parse:function(e){return e.limit&&(this.perPage=parseInt(e.limit,10)),e.leagueId&&(this.id=e.leagueId),e.pvpMatchId&&(this.id=e.pvpMatchId),this.setSort(e.sort||null),this.totalRecords=e.total,this.totalPages=Math.ceil(e.total/this.perPage),e.entries}})})),define("PoE/Widget/ProfileLink/TwitchPopup",["require","jquery","PoE/Layout/Popup/Popup"],(function(e){var t=e("jquery"),n=e("PoE/Layout/Popup/Popup");return function(e,i){var o=this;if(i&&i.stream){e.classList.add("twitchShow");var r=document.createElement("a");r.classList.add("twitch"),r.href="//www.twitch.tv/"+encodeURIComponent(i.name),r.title=i.stream.status?i.stream.status:"Streaming Now!",r.target="_blank",e.appendChild(r);var a=document.createElement("div");a.classList.add("twitchProfilePopup"),e.appendChild(a);var s=document.createElement("div");s.classList.add("name"),s.textContent=i.stream.name,a.appendChild(s);var l=document.createElement("img");l.src=i.stream.image,a.appendChild(l),this.$twitch=r,this.twitchPopup=new n(this.$twitch.nextElementSibling),r.addEventListener("mouseenter",(function(e){o.twitchPopup.smartPositionByEl(t(o.$twitch))})),r.addEventListener("mouseleave",(function(e){o.twitchPopup&&o.twitchPopup.hide()}))}}})),define("text!PoE/Widget/League/Ladder/LadderEntry.hbt",[],(function(){return'<td class="rank">{{rank}}</td>\n<td class="account">{{profileLink account}}</td>\n<td class="character">\n    {{#if public}}{{profileLink account characterName=character.name}}{{else}}{{character.name}}{{/if}}\n    {{#if dead}} (<span class="deadText">{{translate "Dead"}}</span>){{/if}}\n    {{#if retired}} (<span class="deadText">{{translate "Retired"}}</span>){{/if}}\n    {{#if ineligible}} (<span class="deadText">{{translate "Ineligible"}}</span>){{/if}}\n</td>\n<td class="class">{{translate character.class}}</td>\n<td class="level">{{character.level}}</td>\n<td class="experience">{{character.experience}}</td>\n{{#if delveEvent}}\n<td class="depth">{{#if character.depth}}{{character.depth.default}}{{/if}}</td>\n<td class="depth">{{#if character.depth}}{{character.depth.solo}}{{/if}}</td>\n{{/if}}\n{{#if timedEvent}}\n<td class="time">\n    {{#if character.time}}{{elapsed character.time}}\n    {{else if character.progress}}{{eventProgress character.progress}}\n    {{/if}}\n</td>\n{{/if}}\n{{#if scoreEvent}}\n<td class="score">{{character.score}}</td>\n{{/if}}'})),define("text!PoE/Widget/League/Ladder/PVPLadderEntry.hbt",[],(function(){return'<td class="rank">{{rank}}</td>\n<td class="members">\n    {{#if rating}}\n        {{#each members}}\n            {{profileLink account}} - {{#if public}}{{profileLink account characterName=character.name}}{{else}}{{character.name}}{{/if}}\n        {{/each}}\n    {{else}}\n        <ul>\n            {{#each members}}\n            <li>\n                {{profileLink account}} - {{#if public}}{{profileLink account characterName=character.name}}{{else}}{{character.name}}{{/if}}\n                {{#if league}}\n                    ({{league}})\n                {{/if}}\n            </li>\n            {{/each}}\n        </ul>\n    {{/if}}\n</td>\n\n{{#if rating}}\n    <td class="rating">{{rating}}</td>\n{{else}}\n    {{#ifCond style "===" "Swiss"}}\n        <td class="gamesPlayed">{{games_played}}</td>\n        <td class="points">{{points}}</td>\n    {{else}}\n        <td class="points">{{points}}</td>\n        <td class="gamesPlayed">{{games_played}}</td>\n    {{/ifCond}}\n    <td class="tiebreaker">{{cumulative_opponent_points}}</td>\n{{/if}}'})),define("text!PoE/Widget/League/Ladder/PathOfEnduranceLadderEntry.hbt",[],(function(){return'<td class="rank">{{rank}}</td>\r\n<td class="account wide">{{profileLink account}}</td>\r\n<td class="class wide">{{translate class}}</td>\r\n<td class="score">{{score}}</td>'})),define("text!PoE/Widget/League/Ladder/EventLadderEntry.hbt",[],(function(){return'<td class="rank">{{rank}}</td>\n<td class="event">\n<a href="{{private_league.url}}" target="_blank">{{private_league.name}}</a>\n{{#if ineligible}} (<span class="deadText">{{translate "Ineligible"}}</span>){{/if}}\n</td>\n<td>\n<a href="/ladders/league/{{uc private_league.name}}" target="_blank">{{translate "View Ladder..."}}</a>\n</td>\n{{#if timedEvent}}\n<td class="time">\n{{#if time}}{{elapsed time}}\n{{else if progress}}{{eventProgress progress}}\n{{/if}}\n</td>\n{{/if}}\n{{#if scoreEvent}}\n<td class="score">{{score}}</td>\n{{/if}}'})),define("PoE/Widget/League/Ladder/LadderEntry",["plugins","Backbone","PoE/Handlebars/TemplateCollection","PoE/Widget/ProfileLink/TwitchPopup","text!PoE/Widget/League/Ladder/LadderEntry.hbt","text!PoE/Widget/League/Ladder/PVPLadderEntry.hbt","text!PoE/Widget/League/Ladder/PathOfEnduranceLadderEntry.hbt","text!PoE/Widget/League/Ladder/EventLadderEntry.hbt"],(function(e,t,n,i){return t.View.extend({tagName:"tr",initialize:function(){this.$el.addClass("entry"),this.type=this.options.type?this.options.type:"league",this.pvp=!!this.options.pvp,this.style=this.options.style?this.options.style:"",this.divider=!!this.options.divider,this.timedEvent=!!this.options.timedEvent,this.delveEvent=!!this.options.delveEvent,this.scoreEvent=!!this.options.scoreEvent,this.options.altRow&&this.$el.addClass("even")},render:function(){var t=this,o=e.Deferred(),r="PoE/Widget/League/Ladder/LadderEntry.hbt";return"pvp"==this.type?r="PoE/Widget/League/Ladder/PVPLadderEntry.hbt":"path-of-endurance"==this.type?r="PoE/Widget/League/Ladder/PathOfEnduranceLadderEntry.hbt":"event"==this.type&&(r="PoE/Widget/League/Ladder/EventLadderEntry.hbt"),n.load(r).then((function(e){var n=t.model.toJSON();if(n.pvp=t.pvp,n.style=t.style,"league"==t.type?(n.timedEvent=t.timedEvent,n.delveEvent=t.delveEvent,n.scoreEvent=t.scoreEvent):"event"==t.type&&(n.timedEvent=t.timedEvent),(n.dead||n.retired||n.ineligible)&&t.$el.addClass("dead"),n.character&&n.character.time&&t.$el.addClass("finishTime"),t.divider&&t.$el.addClass("newRound"),t.$el.html(e(n)),t.model.has("account")){var r=t.model.get("account");r.has("twitch")&&new i(t.$el.find(".profile-link")[0],r.get("twitch"))}o.resolve()}),(function(){})),o.promise()}})})),define("text!PoE/Widget/League/Ladder/Ladder.hbt",[],(function(){return'{{#if options.title}}\n    <h2>{{options.title}}</h2>\n{{else}}\n    {{#unless options.hideTitle}}\n        <h2>{{translate "Ladder"}}</h2>\n    {{/unless}}\n{{/if}}\n\n<div class="controls">\n    {{#unless options.unfilterable}}\n    <label for="classFilter">{{translate "Class Filter"}}:</label>\n    <select name="classFilter">\n        <option value="null" selected>{{translate "All"}}</option>\n        <option value="0">{{translate "Scion"}}</option>\n        <option value="0-1">&nbsp;&nbsp;{{translate "Ascendant"}}</option>\n        <option value="1">{{translate "Marauder"}}</option>\n        <option value="1-1">&nbsp;&nbsp;{{translate "Juggernaut"}}</option>\n        <option value="1-2">&nbsp;&nbsp;{{translate "Berserker"}}</option>\n        <option value="1-3">&nbsp;&nbsp;{{translate "Chieftain"}}</option>\n        <option value="2">{{translate "Ranger"}}</option>\n        <option value="2-1">&nbsp;&nbsp;{{translate "Raider"}}</option>\n        <option value="2-2">&nbsp;&nbsp;{{translate "Deadeye"}}</option>\n        <option value="2-3">&nbsp;&nbsp;{{translate "Pathfinder"}}</option>\n        <option value="3">{{translate "Witch"}}</option>\n        <option value="3-1">&nbsp;&nbsp;{{translate "Occultist"}}</option>\n        <option value="3-2">&nbsp;&nbsp;{{translate "Elementalist"}}</option>\n        <option value="3-3">&nbsp;&nbsp;{{translate "Necromancer"}}</option>\n        <option value="4">{{translate "Duelist"}}</option>\n        <option value="4-1">&nbsp;&nbsp;{{translate "Slayer"}}</option>\n        <option value="4-2">&nbsp;&nbsp;{{translate "Gladiator"}}</option>\n        <option value="4-3">&nbsp;&nbsp;{{translate "Champion"}}</option>\n        <option value="5">{{translate "Templar"}}</option>\n        <option value="5-1">&nbsp;&nbsp;{{translate "Inquisitor"}}</option>\n        <option value="5-2">&nbsp;&nbsp;{{translate "Heirophant"}}</option>\n        <option value="5-3">&nbsp;&nbsp;{{translate "Guardian"}}</option>\n        <option value="6">{{translate "Shadow"}}</option>\n        <option value="6-1">&nbsp;&nbsp;{{translate "Assassin"}}</option>\n        <option value="6-2">&nbsp;&nbsp;{{translate "Trickster"}}</option>\n        <option value="6-3">&nbsp;&nbsp;{{translate "Saboteur"}}</option>\n    </select>\n    {{/unless}}\n    {{#if options.hideDelve}}\n    <label for="hideDelve">{{translate "Hide Delve Depth"}}:</label>\n    <input type="checkbox" value="1" name="hideDelve" id="hideDelve" checked="checked">\n    {{/if}}\n    <label for="autoRefresh">{{translate "Auto refresh"}}:</label>\n    <input type="checkbox" value="1" name="autoRefresh" id="autoRefresh">\n    <input type="button" class="refresh button1" value="{{translate "Refresh"}}" />\n    {{#if league}}\n        <a class="exportCsv button1" href="/ladder/export-csv/league/{{uc league.id}}?realm={{league.realm}}">{{translate "Export CSV"}}</a>\n    {{/if}}\n</div>\n<div class="loading"></div>\n<table>\n    <thead>\n            <tr>\n                <th>{{translate "Rank"}}</th>\n                <th>{{translate "Account"}}</th>\n                <th>{{translate "Character"}}</th>\n                <th>{{translate "Class"}}</th>\n                <th>{{translate "Level"}}</th>\n                {{#if league.timedEvent}}\n                <th>{{translate "Experience"}}</th>\n                {{else}}\n                <th class="sortable" data-sort>{{translate "Experience"}}</th>\n                {{/if}}\n                {{#if league.delveEvent}}\n                <th class="sortable{{#ifCond options.sort \'==\' \'depth\'}} sorted{{/ifCond}}" data-sort="depth">{{translate "Depth"}}</th>\n                <th class="sortable{{#ifCond options.sort \'==\' \'depthsolo\'}} sorted{{/ifCond}}" data-sort="depthsolo">{{translate "Depth (Solo)"}}</th>\n                {{/if}}\n                {{#if league.timedEvent}}\n                <th class="sortable" data-sort>{{translate "Time"}}</th>\n                {{/if}}\n                {{#if league.scoreEvent}}\n                <th class="sortable{{#ifCond options.sort \'==\' \'score\'}} sorted{{/ifCond}}" data-sort="score">{{translate "Score"}}</th>\n                {{/if}}\n            </tr>\n    </thead> \n    <tbody class="entries"></tbody>\n</table>\n<div class="pagination"></div>\n'})),define("text!PoE/Widget/League/Ladder/PVPLadder.hbt",[],(function(){return'{{#if options.title}}\r\n<h2>{{options.title}}</h2>\r\n{{else}}\r\n{{#unless options.hideTitle}}\r\n<h2>{{translate "Ladder"}}</h2>\r\n{{/unless}}\r\n{{/if}}\r\n\r\n<div class="controls">\r\n    <label for="autoRefresh">{{translate "Auto refresh"}}</label>\r\n    <input type="checkbox" value="1" name="autoRefresh" id="autoRefresh">\r\n    <input type="button" class="refresh button1" value="{{translate "Refresh"}}" />\r\n    {{#if league}}\r\n    <a class="exportCsv button1" href="/ladder/export-csv/league/{{uc league.id}}?realm={{league.realm}}">{{translate "Export CSV"}}</a>\r\n    {{/if}}\r\n</div>\r\n<div class="loading"></div>\r\n<table>\r\n    <thead>\r\n    <tr>\r\n        <th>{{translate "Rank"}}</th>\r\n        <th>{{translate "Members"}}</th>\r\n\r\n        {{#if league.glickoRatings}}\r\n        <th>{{translate "Rating"}}</th>\r\n        {{else}}\r\n\r\n        {{#ifCond league.style "===" "Swiss"}}\r\n        <th>{{translate "Games Played"}}</th>\r\n        <th>{{translate "Points"}}</th>\r\n        {{else}}\r\n        <th>{{translate "Points"}}</th>\r\n        <th>{{translate "Games Played"}}</th>\r\n        {{/ifCond}}\r\n        <th class="tiebreaker-hover">{{translate "Resistance"}}</th>\r\n        {{/if}}\r\n    </tr>\r\n    </thead>\r\n    <tbody class="entries"></tbody>\r\n</table>\r\n<div class="pagination"></div>\r\n'})),define("text!PoE/Widget/League/Ladder/PathOfEnduranceLadder.hbt",[],(function(){return'<div class="labyrinth-ladder-controls">\r\n    <div class="poeForm">\r\n        <button id="ladder-prev" class="button1" style="display: {{#if league.prev}}inline-block{{else}}none{{/if}};">{{translate "Prev"}}</button>\r\n        <select class="league">\r\n            {{#each league.leagueOps}}\r\n            <option value="{{this}}" {{#ifCond this "==" ../league.leagueName}} selected {{/ifCond}}>{{this}}</option>\r\n            {{/each}}\r\n        </select>\r\n        <button id="ladder-next" class="button1" style="display: {{#if league.next}}inline-block{{else}}none{{/if}};">{{translate "Next"}}</button>\r\n\r\n    </div>\r\n</div>\r\n\r\n{{#if options.title}}\r\n<h2 id="ladder-title">{{options.title}}</h2>\r\n{{else}}\r\n{{#unless options.hideTitle}}\r\n<h2>{{translate "Ladder"}}</h2>\r\n{{/unless}}\r\n{{/if}}\r\n\r\n<div class="controls">\r\n    <label for="autoRefresh">{{translate "Auto refresh"}}</label>\r\n    <input type="checkbox" value="1" name="autoRefresh" id="autoRefresh">\r\n    <input type="button" class="refresh button1" value="{{translate \'Refresh\'}}" />\r\n</div>\r\n<div class="clear"></div>\r\n{{#if league.date}}\r\n<h2 id="ladder-time">{{translate "Start"}}: {{unixMoment league.startTime format=\'lll\'}}</h2>\r\n{{/if}}\r\n<div class="loading"></div>\r\n<table>\r\n    <thead>\r\n    <tr>\r\n        <th>{{translate "Rank"}}</th>\r\n        <th>{{translate "Account"}}</th>\r\n        <th>{{translate "Class"}}</th>\r\n        <th>{{translate "Score"}}</th>\r\n    </tr>\r\n    </thead>\r\n    <tbody class="entries"></tbody>\r\n</table>\r\n<div class="pagination"></div>'})),define("text!PoE/Widget/League/Ladder/EventLadder.hbt",[],(function(){return'{{#if options.title}}\n<h2>{{options.title}}</h2>\n{{else}}\n{{#unless options.hideTitle}}\n<h2>{{translate "Ladder"}}</h2>\n{{/unless}}\n{{/if}}\n\n<div class="controls">\n<label for="autoRefresh">{{translate "Auto refresh"}}:</label>\n<input type="checkbox" value="1" name="autoRefresh" id="autoRefresh">\n<input type="button" class="refresh button1" value="{{translate "Refresh"}}" />\n{{#if false}}\n<a class="exportCsv button1" href="/ladder/export-csv/league/{{uc league.id}}?realm={{league.realm}}">{{translate "Export CSV"}}</a>\n{{/if}}\n</div>\n<div class="loading"></div>\n<table>\n<thead>\n<tr>\n  <th>{{translate "Rank"}}</th>\n  <th>{{translate "League"}}</th>\n  <th></th>\n  {{#if league.timedEvent}}\n  <th>{{translate "Time"}}</th>\n  {{/if}}\n  {{#if league.scoreEvent}}\n  <th>{{translate "Score"}}</th>\n  {{/if}}\n</tr>\n</thead>\n<tbody class="entries"></tbody>\n</table>\n<div class="pagination"></div>\n'})),define("PoE/Widget/League/Ladder/Ladder",["plugins","Backbone","moment-tz","PoE/Handlebars/TemplateCollection","PoE/Collection/League/LadderEntries","./LadderEntry","PoE/View/Widget/Pagination","PoE/Helpers","text!PoE/Widget/League/Ladder/Ladder.hbt","text!PoE/Widget/League/Ladder/PVPLadder.hbt","text!PoE/Widget/League/Ladder/PathOfEnduranceLadder.hbt","text!PoE/Widget/League/Ladder/EventLadder.hbt"],(function(e,t,n,i,o,r,a,s){return t.View.extend({initialize:function(){var e=this;this.$el.attr("class","ladderView"),this.type=this.options.type,!this.collection&&this.model&&(this.collection=this.model.get("ladder")),"path-of-endurance"===this.type&&(this.collection.server_api.id=this.model.get("id"),this.collection.server_api.leagueName=this.model.get("leagueName"),this.collection.server_api.startTime=this.model.get("startTime"),this.$el.addClass("path-of-endurance")),this.pagination=new a({collection:this.collection}),this.pagination.render(),this.collection.on("change",(function(){this.render()})),this.collection.on("reset",(function(){e.hideLoader(),e.addAll()})),this.pagination.on("loadStart",(function(){e.showLoader()})),this.pagination.on("loadEnd",(function(){e.hideLoader()})),this.autoRefreshInterval=null,this.ladderEntries=[]},showLoader:function(){this.$entries.css("opacity",.5),this.$loading.show(),this.$loading.css("top",this.$entries.offset().top-this.$el.offset().top),this.$loading.height(this.$entries.height()>0?this.$entries.height():38)},hideLoader:function(){this.$entries.css("opacity",1),this.$loading.hide()},initElementRefs:function(){this.$entries=this.$el.find(".entries"),this.$loading=this.$el.find(".loading"),this.$hideDelve=this.$el.find('input[name="hideDelve"]'),this.$autoRefresh=this.$el.find('input[name="autoRefresh"]'),this.$prev=this.$el.find("#ladder-prev"),this.$next=this.$el.find("#ladder-next"),this.$classFilter=this.$el.find('select[name="classFilter"]'),this.$table=this.$el.find("table")},events:{"click .refresh":"refresh",'change input[name="hideDelve"]':"hideDelve",'change input[name="autoRefresh"]':"autoRefresh",'change select[class="league"]':"changeOps",'change select[class="realm"]':"changeOps",'change select[name="classFilter"]':"changeOps",'click th[class="sortable"]':"sort","click button#ladder-prev":"prev","click button#ladder-next":"next"},hideDelve:function(e){e.preventDefault(),this.$table.toggleClass("hideDelve",this.$hideDelve.is(":checked"))},autoRefresh:function(e){var t=this;e.preventDefault(),this.$autoRefresh.is(":checked")&&null===this.autoRefreshInterval?this.autoRefreshInterval=setInterval((function(){t.refresh()}),3e4):null!==this.autoRefreshInterval&&(clearInterval(this.autoRefreshInterval),this.autoRefreshInterval=null)},refresh:function(t){var i=this;t&&t.preventDefault(),this.showLoader(),this.collection.fetch().done((function(t){t.title&&""!=t.title&&e("#ladder-title").text(t.title),"path-of-endurance"==i.type&&(t.startTime&&(i.model.set("startTime",t.startTime),e("#ladder-time").text(s.translate("Start")+": "+n.unix(t.startTime).format("lll"))),!1===t.next?e("#ladder-next").hide():e("#ladder-next").show(),i.model.set("next",t.next),!1===t.prev?e("#ladder-prev").hide():e("#ladder-prev").show(),i.model.set("prev",t.prev),window.history&&window.history.pushState&&window.history.pushState({},"","/path-of-endurance/"+i.model.get("leagueName")+"/"+t.start))})).fail((function(e){"path-of-endurance"==i.type&&(i.collection.models={},i.collection.totalRecords=0,i.$el.find(".pagination").empty(),i.addAll()),e.responseJSON&&e.responseJSON.error&&alert(e.responseJSON.error.message)})).always((function(){i.hideLoader()}))},sort:function(t){if("league"==this.type){this.$el.find("th.sortable").removeClass("sorted");var n=t.target?e(t.target).data("sort"):null;switch(n){case"depth":case"depthsolo":case"score":this.collection.setSort(n),e(t.target).addClass("sorted");break;default:this.collection.setSort(null)}this.collection.currentPage=1}this.refresh(t)},changeOps:function(t){if("path-of-endurance"==this.type){var n=e('select[class="league"]').first().val();this.collection.currentPage=1,this.model.set("leagueName",n),this.collection.server_api.leagueName=n}if("league"==this.type){var i=this.$classFilter.val();"null"==i?(this.model.unset("class"),delete this.collection.server_api.class):(this.model.set("class",i),this.collection.server_api.class=i),this.collection.currentPage=1}this.refresh(t)},prev:function(e){"path-of-endurance"==this.type&&(this.collection.server_api.startTime=this.model.get("prev")),this.collection.currentPage=1,this.refresh(e)},next:function(e){"path-of-endurance"==this.type&&(this.collection.server_api.startTime=this.model.get("next")),this.collection.currentPage=1,this.refresh(e)},addAll:function(){var t=this,n=[];this.$entries.empty(),this.ladderEntries=[];var i=!1;if(this.collection.each((function(e,o){var a=!1,s=!1;t.model&&"Swiss"===t.model.get("style")&&"pvp"==t.type?(a=e.get("games_played"),s=!1!==i&&a!==i):t.model&&t.model.has("timedEvent")&&!t.model.has("leagueEvent")&&(a=!e.get("character").time,s=i!=a);e=new r({model:e,altRow:o%2==1,type:t.type,style:!!t.model&&t.model.get("style"),divider:s,timedEvent:!!t.model&&t.model.has("timedEvent"),delveEvent:!!t.model&&t.model.has("delveEvent"),scoreEvent:!!t.model&&t.model.has("scoreEvent")});n.push(e.render()),t.$entries.append(e.el),i=a,t.ladderEntries.push(e)})),0==this.collection.info().totalRecords||0==this.collection.length){var o=t.$entries.parent("table").find("thead th").length;t.$entries.append('<tr><td colspan="'+o+'">'+s.translate("No results found")+"</td></tr>")}return e.when.apply(null,n)},render:function(){var e=this,t="PoE/Widget/League/Ladder/Ladder.hbt";return"pvp"==this.type?t="PoE/Widget/League/Ladder/PVPLadder.hbt":"path-of-endurance"==this.type?t="PoE/Widget/League/Ladder/PathOfEnduranceLadder.hbt":"event"==this.type&&(t="PoE/Widget/League/Ladder/EventLadder.hbt"),i.load(t).done((function(t){var n={options:{}};if(e.model&&(n.league=e.model.toJSON(),n.league.startTime&&(e.collection.startTime=n.league.startTime),e.model.has("delveEvent")&&(n.options.hideDelve=!0)),"league"===e.type){var i=e.collection.server_api.sort||null;i&&(n.options.sort=i,String(i).startsWith("depth")&&(n.options.hideDelve=!1))}e.options.hideTitle&&(n.options.hideTitle=!0),e.options.title&&(n.options.title=e.options.title),e.options.unfilterable&&(n.options.unfilterable=!0),n.type=e.type,e.$el.html(t(n)),e.initElementRefs(),e.$loading.hide(),e.$el.find(".pagination").replaceWith(e.pagination.el),e.$table.toggleClass("hideDelve",e.$hideDelve.is(":checked")),e.addAll()}))}})})),define("PoE/Backbone/Collection/Item/ItemCollection",["Backbone","PoE/Backbone/Model/Item/Item"],(function(e,t){return e.Collection.extend({model:t})})),define("PoE/Backbone/Model/Item/MTXItem",["Backbone"],(function(e){return e.RelationalModel.extend({})})),define("PoE/Backbone/Collection/Item/MTXItemCollection",["Backbone","PoE/Backbone/Model/Item/MTXItem"],(function(e,t){return e.Collection.extend({model:t})})),define("PoE/API/Character",["jquery","PoE/Backbone/Collection/Item/ItemCollection","PoE/Backbone/Collection/Item/MTXItemCollection"],(function(e,t,n){var i={};return{getItems:function(n){var i=e.Deferred();return e.ajax({url:"/character-window/get-items",type:"POST",dataType:"json",data:{accountName:n.accountName,realm:n.realm,character:n.characterName},success:function(e){e.items=new t(e.items),i.resolve(e)}}),i.promise()},getMtxItems:function(t){var o={accountName:t.accountName,realm:t.realm,character:t.characterName},r=Object.values(o).join("##");if(Object.hasOwnProperty.call(i,r))return i[r].promise();var a=e.Deferred();return i[r]=a,e.ajax({url:"/character-window/get-mtx-items",type:"POST",dataType:"json",data:{accountName:t.accountName,realm:t.realm,character:t.characterName},success:function(e){e.activeBySlot=new n(e.activeBySlot),a.resolve(e)}}),a.promise()},clearCache:function(){i={}}}})),define("PoE/Inventory/Constants",["require"],(function(e){return{gridSize:47.4645,inventory:{bodyArmour:{x:247.06,y:124.14},weapon:{x:60.85,y:29.21},offhand:{x:433.27,y:29.21},boots:{x:363.89,y:230.63},ring:{x:177.69,y:171.6},ring2:{x:363.89,y:171.6},amulet:{x:363.89,y:112.58},gloves:{x:130.22,y:230.63},belt:{x:247.06,y:278.09},helm:{x:247.06,y:17.65},trinket:{x:84.58,y:360.24},flask:{x:181.34,y:336.51},stash:{x:15.21,y:97.36},main:{x:9,y:449.57}},mtxInventory:{Weapon1Skin:{x:57.2008,y:24.3408,w:101.0142,h:195.9432},Weapon1Effect:{x:57.2008,y:221.501,w:49.8986,h:49.8986},Weapon1Other:{x:108.3164,y:221.501,w:49.8986,h:49.8986},Weapon2Skin:{x:429.6146,y:24.3408,w:101.0142,h:195.9432},Weapon2Effect:{x:429.6146,y:221.501,w:49.8986,h:49.8986},Weapon2Other:{x:480.7302,y:221.501,w:49.8986,h:49.8986},HelmetSkin:{x:243.4077,y:12.7789,w:101.0142,h:101.0142},HelmetAttachment:{x:192.9006,y:64.503,w:49.2901,h:49.2901},HelmetMask:{x:192.9006,y:13.9959,w:49.2901,h:49.2901},ArmourSkin:{x:243.4077,y:119.2698,w:101.0142,h:148.4787},BackAttachment:{x:171.6024,y:119.2698,w:70.5882,h:70.5882},GlovesSkin:{x:129.0061,y:287.8296,w:101.0142,h:101.0142},BootsSkin:{x:357.8093,y:287.8296,w:101.0142,h:101.0142},Footprints:{x:460.0406,y:287.8296,w:49.2901,h:49.2901},PeriodicCharacterEffect:{x:359.0264,y:40.1623,w:54.1582,h:54.1582},CharacterEffect:{x:242.7992,y:335.9026,w:50.5071,h:50.5071},CharacterPortrait:{x:326.7748,y:509.3306,w:76.0649,h:62.6775},CharacterFrame:{x:245.8418,y:509.3306,w:76.0649,h:62.6775},Pet1:{x:71.1968,y:401.6227,w:81.5416,h:81.5416},Pet2:{x:69.9797,y:490.4665,w:81.5416,h:81.5416},Portal:{x:435.6998,y:491.0751,w:81.5416,h:81.5416},Cursor:{x:186.8154,y:512.9817,w:54.1582,h:54.1582},BeltSkin:{x:243.4077,y:273.8337,w:101.0142,h:53.5497},AmuletSkin:{x:359.0264,y:104.0568,w:53.5497,h:53.5497},FlaskSkin1:{x:168.5598,y:402.2312,w:49.8986,h:99.1886},FlaskSkin2:{x:219.6755,y:402.2312,w:49.8986,h:99.1886},FlaskSkin3:{x:270.7911,y:402.2312,w:49.8986,h:99.1886},FlaskSkin4:{x:321.9067,y:402.2312,w:49.8986,h:99.1886},FlaskSkin5:{x:373.0223,y:402.2312,w:49.8986,h:99.1886},Ring1Skin:{x:175.2535,y:202.0284,w:53.5497,h:53.5497},Ring2Skin:{x:359.0264,y:202.0284,w:53.5497,h:53.5497},HipAttachment:{x:294.5233,y:335.9026,w:50.5071,h:50.5071},Charges:{x:78.499,y:287.8296,w:49.2901,h:49.2901},SkillGem:{x:18.2556,y:606.0852,w:547.6673,h:54.7667}}}})),define("PoE/Inventory/MainInventoryPanel",["plugins","Backbone","PoE/API/Character","PoE/Item/Item","PoE/Helpers","PoE/Backbone/EventBus","./Constants"],(function(e,t,n,i,o,r,a){return t.View.extend({initialize:function(){var e=this;this.$el.addClass("mainInventoryPanel"),this.renderedItems=[],this.activeCharacter=this.options.activeCharacter,this.equippedOnly=this.options.equippedOnly||null,this.weaponSlot=1,this.inventoryExpansion=0,r.on("activeCharacterChanged",(function(t){e.activeCharacter=t,e.render()}))},events:{"click .weaponSwap1.left":"swapWeaponSlot","click .weaponSwap2.left":"swapWeaponSlot","click .weaponSwap1.right":"swapWeaponSlot","click .weaponSwap2.right":"swapWeaponSlot","click .weaponSwapMini.left":"swapWeaponSlot","click .weaponSwapMini.right":"swapWeaponSlot","click .inventoryExpansionToggle":"toggleInventoryExpansion"},showCharacterItems:function(){var t=e.Deferred(),i=this,o={accountName:this.model.get("name"),realm:this.model.get("realm"),characterName:this.activeCharacter.get("name")};return n.getItems(o).done((function(e){i.collection=e.items,i.inventoryExpansion=0,e.inventory&&e.inventory.extra_columns&&(i.inventoryExpansion=e.inventory.extra_columns),i.showItems()})).then((function(){t.resolve()})),t.promise()},showItems:function(){var e=this;this.clearItems(),this.weapon1=null,this.weapon2=null,this.offhand1=null,this.offhand2=null,this.collection.each((function(t){var n=0,o=0,r=t.get("x"),s=t.get("y"),l=t.get("w"),c=t.get("h"),d=t.get("inventoryId"),u=new i({model:t}),h=!1;if(!e.equippedOnly||"MainInventory"!==d){switch(d){case"MainInventory":if(r>12&&e.inventoryExpansion)r=24-r+1,n=a.gridSize*e.inventoryExpansion-r*a.gridSize,h=!0,o=a.gridSize*s;else n=a.inventory.main.x+a.gridSize*r,o=a.inventory.main.y+a.gridSize*s;break;case"BodyArmour":n=a.inventory.bodyArmour.x,o=a.inventory.bodyArmour.y,l=2,c=3;break;case"Weapon":e.weapon1=u,n=a.inventory.weapon.x,o=a.inventory.weapon.y,l=2,c=4;break;case"Weapon2":e.weapon2=u,n=a.inventory.weapon.x,o=a.inventory.weapon.y,l=2,c=4;break;case"Offhand":e.offhand1=u,n=a.inventory.offhand.x,o=a.inventory.offhand.y,l=2,c=4;break;case"Offhand2":e.offhand2=u,n=a.inventory.offhand.x,o=a.inventory.offhand.y,l=2,c=4;break;case"Boots":n=a.inventory.boots.x,o=a.inventory.boots.y,l=2,c=2;break;case"Ring":n=a.inventory.ring.x,o=a.inventory.ring.y;break;case"Ring2":n=a.inventory.ring2.x,o=a.inventory.ring2.y;break;case"Amulet":n=a.inventory.amulet.x,o=a.inventory.amulet.y;break;case"Gloves":n=a.inventory.gloves.x,o=a.inventory.gloves.y;break;case"Belt":n=a.inventory.belt.x,o=a.inventory.belt.y;break;case"Helm":n=a.inventory.helm.x,o=a.inventory.helm.y;break;case"Trinket":n=a.inventory.trinket.x,o=a.inventory.trinket.y;break;case"Flask":n=a.inventory.flask.x+r*a.gridSize,o=a.inventory.flask.y}h||(n+=5,o+=82);var p={character:e.activeCharacter.get("name"),item:t,inventory:d};e.renderedItems.push(u),u.render(),u.setPlaced(l,c),u.on("itemClick",function(t){return function(){e.itemClicked(t)}}(p)),h?e.$inventoryExpansion.append(u.$el):e.$el.append(u.$el),u.$el.css("position","absolute"),u.$el.css("left",n),u.$el.css("top",o),u.trigger("displayed")}})),this.showActiveWeaponSlots()},swapWeaponSlot:function(e){1===this.weaponSlot?this.weaponSlot=2:this.weaponSlot=1,this.showActiveWeaponSlots()},showActiveWeaponSlots:function(){this.$weaponSwapMiniL.empty(),this.$weaponSwapMiniR.empty(),this.showMiniSlots(!1),1===this.weaponSlot?(this.weapon1&&this.weapon1.$el.show(),this.offhand1&&this.offhand1.$el.show(),this.weapon2&&(this.showMiniSlots(!0),this.populateSwapMini(this.weapon2,this.$weaponSwapMiniL),this.weapon2.$el.hide()),this.offhand2&&(this.showMiniSlots(!0),this.populateSwapMini(this.offhand2,this.$weaponSwapMiniR),this.offhand2.$el.hide()),this.$weaponSwap1.show(),this.$weaponSwap2.hide()):(this.weapon2&&this.weapon2.$el.show(),this.offhand2&&this.offhand2.$el.show(),this.weapon1&&(this.showMiniSlots(!0),this.populateSwapMini(this.weapon1,this.$weaponSwapMiniL),this.weapon1.$el.hide()),this.offhand1&&(this.showMiniSlots(!0),this.populateSwapMini(this.offhand1,this.$weaponSwapMiniR),this.offhand1.$el.hide()),this.$weaponSwap2.show(),this.$weaponSwap1.hide())},showMiniSlots:function(e){e?(this.$weaponSwapMiniL.show(),this.$weaponSwapMiniR.show()):(this.$weaponSwapMiniL.hide(),this.$weaponSwapMiniR.hide())},populateSwapMini:function(t,n){var i=t.$el,r=(i.find(".iconContainer"),(4-t.model.get("h"))*a.gridSize/2),s=2*a.gridSize,l=4*a.gridSize,c=i.find(".icon").width(),d=l-2*r,u=n.width()-12,h=n.height()-12,p=i.find(".icon img").clone();p.width(c*(u/s)),p.height(d*(h/l)),p.css("top",(h-p.height())/2+6),p.css("left",(u-p.width())/2+6);var f=e('<div class="miniIconContainer"></div>');f.append(p),n.append(f);var v=t.model.get("w"),m=t.model.get("h"),g=[];if(t.model.get("shaper")){var y=Math.floor(p.position().left)%4096,b=Math.floor(p.position().top)%2160,w=o.imageUrl("inventory/ShaperBackground.png?w=".concat(v,"&h=").concat(m,"&x=").concat(y,"&y=").concat(b));g.unshift("url(".concat(w,") no-repeat center"))}if(t.model.get("elder")){var x=o.imageUrl("inventory/ElderBackground.png?w=".concat(v,"&h=").concat(m));g.unshift("url(".concat(x,") no-repeat center"))}g.length&&f.css("background",g.join(", "))},toggleInventoryExpansion:function(){if(this.$inventoryExpansionToggle.hasClass("expanded"))this.$inventoryExpansionToggle.removeClass("expanded"),this.$inventoryExpansionToggle.css("margin-left",""),this.$inventoryExpansion.hide();else{var e=a.gridSize*this.inventoryExpansion;this.$inventoryExpansionToggle.addClass("expanded"),this.$inventoryExpansionToggle.css("margin-left",0-e),this.$inventoryExpansion.width(e),this.$inventoryExpansion.height(5*a.gridSize),this.$inventoryExpansion.css("margin-left",0-e),this.$inventoryExpansion.show()}},clearItems:function(){for(var e=0,t=this.renderedItems.length;e<t;++e)this.renderedItems[e].close();this.renderedItems=[]},itemClicked:function(e){r.trigger("inventoryItem.click",e)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},close:function(){this.remove(),this.unbind()},render:function(){var t=this,n=e.Deferred();return this.$el.empty().append('<div class="weaponSwap1 left"></div><div class="weaponSwap2 left"></div><div class="weaponSwap1 right"></div><div class="weaponSwap2 right"></div><div class="weaponSwapMini left"></div><div class="weaponSwapMini right"></div><button class="inventoryExpansionToggle"></button><div class="inventoryExpansion"></div>'),this.$weaponSwap1=this.$el.find(".weaponSwap1"),this.$weaponSwap2=this.$el.find(".weaponSwap2"),this.$weaponSwapMiniL=this.$el.find(".weaponSwapMini.left"),this.$weaponSwapMiniR=this.$el.find(".weaponSwapMini.right"),this.$inventoryExpansionToggle=this.$el.find(".inventoryExpansionToggle"),this.$inventoryExpansionToggle.hide(),this.$inventoryExpansion=this.$el.find(".inventoryExpansion"),this.$inventoryExpansion.hide(),this.showCharacterItems().then((function(){t.inventoryExpansion>0&&(t.$inventoryExpansionToggle.show(),t.toggleInventoryExpansion()),n.resolve()})),this.delegateEvents(),n.promise()}})})),define("PoE/API/League",["jquery","PoE/Backbone/Collection/Item/ItemCollection"],(function(e,t){var n={};return{getStashItems:function(n){var i=e.Deferred(),o={accountName:n.accountName,realm:n.realm,league:n.league,tabs:n.tabs?1:0,tabIndex:n.tabIndex?n.tabIndex:0,public:n.public};return e.ajax({url:"/character-window/get-stash-items",type:"GET",data:o,dataType:"json",success:function(e){i.resolve(new t(e.items),e)},error:function(e){i.reject()}}),i.promise()},getMTXStashItems:function(t){var i={accountName:t.accountName,realm:t.realm,sortOrder:t.sortOrder},o=Object.values(i).join("##");if(Object.hasOwnProperty.call(n,o))return n[o].promise();var r=e.Deferred();return n[o]=r,e.ajax({url:"/character-window/get-mtx-stash-items",type:"POST",dataType:"json",data:i,success:function(e){r.resolve(e)}}),r.promise()},getGuildStashItems:function(n){var i=e.Deferred(),o={accountName:n.accountName,realm:n.realm,league:n.league,tabs:n.tabs?1:0,tabIndex:n.tabIndex?n.tabIndex:0};return e.ajax({url:"/character-window/get-guild-stash-items",type:"GET",data:o,dataType:"json",success:function(e){i.resolve(new t(e.items),e)},error:function(e){i.reject()}}),i.promise()},clearCache:function(){n={}}}})),define("PoE/CharacterWindow/StashTab",["require","PoE/Environment/Font","plugins"],(function(e){var t=e("PoE/Environment/Font"),n=e("plugins");n.loadImage=function(e){return n.Deferred((function(t){var n=new Image;function i(){o(),t.reject(n)}function o(){n.onload=null,n.onerror=null,n.onabort=null}n.onload=function(){o(),t.resolve(n)},n.onerror=i,n.onabort=i,n.src=e})).promise()};return function(e,i,o,r,a,s,l,c,d,u){this.init=function(){this.$el=n('<div class="tab"><div class="l"></div><div class="label"></div><div class="r"></div></div>'),this.srcL=o,this.srcC=r,this.srcR=a,this.$el.find(".label").text(e),this.onclick=l&&l.onclick?l.onclick:function(){},this.onload=l&&l.onload?l.onload:function(){},this.$el.on("click",this.onclick),this.$el.hide(),this.width=null,this.height=null,this.loaded=!1,this.selected=!1,this.name=e,this.index=i,this.type=d,this.pubIndex=u,this.colour=s;var t=(299*s.r+587*s.g+114*s.b)/1e3>=128;this.textColour=t?"rgb(59, 44, 27)":"rgb(255, 192, 119)",this.textGlow=t?"rgb(0, 0, 0)":"rgb(118, 56, 0)",this.textOutline="rgb(0, 0, 0)",this.hidden=c;var h=this;this.$el.click((function(){h.onclick()}))},this.getColour=function(){return this.colour},this.refresh=function(){this.$el.children().css("background-position","0px "+(this.selected||this.hovered?this.height:0)+"px")},this.select=function(){this.selected=!0,this.refresh()},this.deselect=function(){this.selected=!1,this.refresh()},this.isLoaded=function(){return this.loaded},this.show=function(){this.$el.show()},this.hide=function(){this.$el.hide()},this.init(),this.load=function(){var e=[],i=this;if(this.isLoaded()){var o=n.Deferred();return o.resolve(),o}e.push(t.waitLoad("FontinRegular"));var r=n.loadImage(this.srcC).pipe((function(e){i.imgC=e})),a=n.loadImage(this.srcL).pipe((function(e){i.imgL=e})),s=n.loadImage(this.srcR).pipe((function(e){i.imgR=e}));return e.push(r),e.push(a),e.push(s),n.when.apply(n,e).done((function(){i.$el.show(),i.$el.find(".label").css("background-image","url('"+i.srcC+"')").css("color",i.textColour).height(i.imgC.height/2),i.$el.find(".l").css("background-image","url('"+i.srcL+"')").width(i.imgL.width).height(i.imgL.height/2),i.$el.find(".r").css("background-image","url('"+i.srcR+"')").width(i.imgR.width).height(i.imgR.height/2),i.width=i.$el.find(".label").width()+i.$el.find(".l").width()+i.$el.find(".r").width(),i.height=i.$el.find(".label").height(),i.$el.width(i.width),i.$el.height(i.height),i.$el.hide(),i.refresh(),i.onload(),i.loaded=!0})).promise()}}})),define("PoE/CharacterWindow/StashTabsControl",["require","./StashTab","PoE/Layout/Popup/Popup","plugins","PoE/Inventory/Constants"],(function(e){var t=e("./StashTab"),n=e("PoE/Layout/Popup/Popup"),i=e("plugins");e("PoE/Inventory/Constants");return function(e,o){this.init=function(){var t=this;this.el=i(e),this.tabsEl=this.el.find(".tabs:first"),this.onTabClicked=function(){},this.controls={},this.controls.leftControlsEl=this.el.find(".leftControls"),this.controls.leftButtonEl=this.controls.leftControlsEl.find(".leftButton"),this.controls.rightControlsEl=this.el.find(".rightControls"),this.controls.rightButtonEl=this.controls.rightControlsEl.find(".rightButton"),this.controls.tabSelectButtonEl=this.controls.rightControlsEl.find(".tabSelectButton"),this.controls.tabSelectEl=this.controls.rightControlsEl.find(".stashTabSelect"),this.controls.tabSelectWrapperEl=this.controls.rightControlsEl.find(".stashTabSelectWrapper"),this.controls.visible=!1,this.controls.leftButtonDown=!1,this.controls.rightButtonDown=!1,this.controls.tabSelectPopup=null,this.organiseInterval=null,this.doOrganise=!1,this.controls.tabSelectScroll=!1,this.controls.tabSelectScrollConfig={showArrows:!0,scrolly:"advanced",scrollx:"advanced",ignoreMobile:!0},this.controls.leftControlsWidth=function(){return this.leftControlsEl.width()},this.controls.rightControlsWidth=function(){return this.rightControlsEl.width()},this.controls.leftButtonOnclick=function(){},this.controls.rightButtonOnclick=function(){},this.controls.tabSelectButtonOnclick=function(){},this.controls.leftButtonEl.on("mousedown",(function(){t.controls.leftButtonDown=!0,setTimeout((function(){t.scrollTabsLeftRepeat()}),50)})),this.controls.leftButtonEl.on("mouseup",(function(){t.controls.leftButtonDown=!1,t.endScrollTabsLeftRepeat(),t.scrollTabsLeft()})),this.controls.rightButtonEl.on("mousedown",(function(){t.controls.rightButtonDown=!0,setTimeout((function(){t.scrollTabsRightRepeat()}),50)})),this.controls.rightButtonEl.on("mouseup",(function(){t.controls.rightButtonDown=!1,t.endScrollTabsRightRepeat(),t.scrollTabsRight()})),this.controls.tabSelectButtonEl.on("click",(function(){t.controls.tabSelectButtonOnclick(),t.controls.toggleTabSelectPopup()})),this.controls.toggleTabSelectPopup=function(e){null===this.tabSelectPopup&&(this.tabSelectPopup=new n(this.tabSelectWrapperEl)),(void 0!==e?e:!this.tabSelectPopup.isVisible())?(this.tabSelectPopup.positionRightTopEl(this.tabSelectButtonEl),this.tabSelectPopup.el.css("display","table")):this.tabSelectPopup.hide()},this.controls.show=function(){this.leftControlsEl.show(),this.rightControlsEl.show(),t.tabsEl.css("left",this.leftControlsEl.width()),t.tabsEl.css("right",this.rightControlsEl.width()),this.tabSelectEl.width(this.tabSelectEl.width()+16),this.tabSelectScroll=this.tabSelectEl.scrollbar(this.tabSelectScrollConfig),this.tabSelectScroll||this.tabSelectEl.css("overflow-y","auto"),this.visible=!0},this.controls.hide=function(){this.leftControlsEl.hide(),this.rightControlsEl.hide(),t.tabsEl.empty(),t.tabsEl.removeClass("tabsOverflow"),t.tabsEl.css("left",""),t.tabsEl.css("right",""),this.tabSelectScroll&&this.tabSelectScroll.scrollbar("destroy"),this.tabSelectEl.empty(),this.tabSelectEl.width(""),this.tabSelectEl.css("overflow-y",""),null!==this.tabSelectPopup&&(this.tabSelectPopup.el.remove(),this.tabSelectPopup=null),this.visible=!1},this.width=function(){return 577},this.widthLessControls=this.width(),this.clearTabs()},this.scrollTabsLeft=function(){("l"==this.tabsAlign||this.visibleTabsWidth==this.tabsEl.width())&&this.leftIndex>0&&--this.leftIndex,this.tabsAlign="l",this.organise(),this.controls.leftButtonOnclick()},this.scrollTabsRight=function(){("r"==this.tabsAlign||this.visibleTabsWidth==this.tabsEl.width())&&this.rightIndex<this.tabs.length-1&&++this.rightIndex,this.tabsAlign="r",this.organise(),this.controls.rightButtonOnclick()},this.scrollTabsLeftRepeatInterval=null,this.scrollTabsLeftRepeat=function(){if(null===this.scrollTabsLeftRepeatInterval&&this.controls.leftButtonDown){var e=this;this.scrollTabsLeftRepeatInterval=setInterval((function(){e.scrollTabsLeft()}),100)}},this.endScrollTabsLeftRepeat=function(){null!==this.scrollTabsLeftRepeatInterval&&(clearInterval(this.scrollTabsLeftRepeatInterval),this.scrollTabsLeftRepeatInterval=null)},this.scrollTabsRightRepeatInterval=null,this.scrollTabsRightRepeat=function(){if(null===this.scrollTabsRightRepeatInterval&&this.controls.rightButtonDown){var e=this;this.scrollTabsRightRepeatInterval=setInterval((function(){e.scrollTabsRight()}),100)}},this.endScrollTabsRightRepeat=function(){null!==this.scrollTabsRightRepeatInterval&&(clearInterval(this.scrollTabsRightRepeatInterval),this.scrollTabsRightRepeatInterval=null)},this.getSelectedTabIndex=function(){return null===this.selectedTab?0:this.selectedTab.index},this.getSelectedTab=function(){return this.selectedTab},this.tabLoaded=function(e){this.organise()},this.tabClicked=function(e){this.selectedTab.deselect(),e.select(),this.selectedTab=e,e.index==this.leftIndex&&"r"==this.tabsAlign?(this.tabsAlign="l",this.organise()):e.index==this.rightIndex&&"l"==this.tabsAlign?(this.tabsAlign="r",this.organise()):e.index<this.leftIndex?(this.leftIndex=e.index,this.tabsAlign="l",this.organise()):e.index>this.rightIndex&&(this.rightIndex=e.index,this.tabsAlign="r",this.organise()),this.organise(),this.onTabClicked(e)},this.hide=function(){this.el.hide(),null!==this.controls.tabSelectPopup&&this.controls.tabSelectPopup.hide()},this.show=function(){this.el.show()},this.close=function(){this.clearTabs()},this.clearTabs=function(){this.visibleTabsWidth=0,this.visibleTabs=[],this.tabs=[],this.tabsAlign="l",this.leftIndex=0,this.rightIndex=null,this.selectedTab=null,this.tabsOverflow=!1,this.controls.hide()},this.loadTabs=function(e){this.clearTabs();for(var n=this,o=0,r=e.length;o<r;++o){var a=new t(e[o].n,o,e[o].srcL,e[o].srcC,e[o].srcR,e[o].colour,null,e[o].hidden,e[o].type,e[o].pi),s=a.$el;if(a.onclick=function(){n.tabClicked(this)},this.tabs[o]=a,this.tabsEl.append(s),!e[o].hidden){var l=i('<div class="option"></div>');if(l.text(a.name),a.type&&l.addClass(a.type),124!==e[o].colour.r&&84!==e[o].colour.g&&54!==e[o].colour.b){var c="rgb("+e[o].colour.r+","+e[o].colour.g+","+e[o].colour.b+")",d="rgb("+Math.max(e[o].colour.r-40,0)+","+Math.max(e[o].colour.g-40,0)+","+Math.max(e[o].colour.b-40,0)+")";l.css("background",d);var u=(299*e[o].colour.r+587*e[o].colour.g+114*e[o].colour.b)/1e3>=128;l.css("color",u?"rgb(59, 44, 27)":"rgb(255, 192, 119)"),l.hover(function(e){return function(){i(this).css("background",e)}}(c),function(e){return function(){i(this).css("background",e)}}(d))}l.on("click",function(e){return function(){n.tabClicked(e)}}(a)),this.controls.tabSelectEl.append(l)}e[o].selected&&(this.selectedTab=this.tabs[o],this.selectedTab.select())}this.organise()},this.organise=function(){var e=this;null!==this.organiseInterval&&(clearInterval(this.organiseInterval),this.organiseInterval=null),this.doOrganise=!0,this.organiseInterval=setInterval((function(){if(e.doOrganise){var t=0,n=[],i=[],o=function(o){var r=e.tabs[o];return!!r&&(r.isLoaded()?(t+=r.width,i.push(r),t>e.width()&&(e.tabsOverflow=!0,!0)):(n.push(r),!1))};if("l"==e.tabsAlign){for(var r=e.leftIndex,a=e.tabs.length-1;r<=a;++r)if(o(r)||r==a){e.rightIndex=r;break}}else for(r=e.rightIndex;r>=0;--r)if(o(r)||0==r){e.leftIndex=r;break}for(r=0,a=e.visibleTabs.length;r<a;++r)e.visibleTabs[r].hide();if(e.visibleTabsWidth=0,e.visibleTabs=[],t>e.width()){e.tabsEl.css("self",e.controls.leftControlsWidth()),e.controls.show(),e.tabsEl.addClass("tabsOverflow");var s=function(n,o){var r=i[n];return!r.hidden&&(r.$el.css("position","absolute").css(o?"right":"left","").css(o?"left":"right",t),r.show(),e.visibleTabs.push(r),e.visibleTabsWidth+=r.width,(t+=r.width)>=e.widthLessControls)};if(t=0,"l"==e.tabsAlign){for(r=0,a=i.length-1;r<=a;++r)if(s(r,!0)||r==a){e.rightIndex=i[r].index;break}}else for(r=0,a=i.length-1;r<=a;++r)if(s(r,!1)||r==a){e.leftIndex=i[r].index;break}}else for(r=0,a=i.length;r<a;++r){var l=i[r];l.hidden||(e.visibleTabs.push(l),e.visibleTabsWidth+=l.width,l.$el.css("position","relative").css("display","inline-block").css("left","").css("right",""),l.show())}if(this.doOrganise=!1,n.length>0)for(r=0,a=n.length;r<a;++r){n[r].load().then((function(){e.doOrganise=!0}),(function(){console.warn("Failed to load tab",r),clearInterval(e.organiseInterval),e.organiseInterval=null}))}else clearInterval(e.organiseInterval),e.organiseInterval=null,setTimeout((function(){for(var t=0;t<e.visibleTabs.length;t++){var n=e.visibleTabs[t];n.hidden||n.show(),n.$el.find(".r").width(18)}}),100)}}),50)},this.init()}})),define("PoE/Inventory/StashPanel",["require","plugins","Backbone","PoE/API/League","PoE/Item/Item","PoE/Backbone/EventBus","PoE/CharacterWindow/StashTabsControl","./Constants","PoE/Helpers"],(function(e){var t=e("plugins"),n=e("Backbone"),i=e("PoE/API/League"),o=e("PoE/Item/Item"),r=e("PoE/Backbone/EventBus"),a=e("PoE/CharacterWindow/StashTabsControl"),s=e("./Constants"),l=e("PoE/Helpers");return n.View.extend({initialize:function(){var e=this;this.activeLeague=this.options.activeLeague,this.tabIndex=this.options.tabIndex||null,this.showTabs=this.options.tabs||!1,this.guild=this.options.guild||!1,this.$el.addClass("stashPanel"),this.currencyLayout=!1,this.quadLayout=!1,this.fragmentLayout=!1,this.divinationLayout=!1,this.mapLayout=!1,this.delveLayout=!1,this.blightLayout=!1,this.metamorphLayout=!1,this.deliriumLayout=!1,this.flaskLayout=!1,this.gemLayout=!1,this.currencyLayoutMap=null,this.fragmentLayoutMap=null,this.divinationLayoutMap=null,this.essenceLayoutMap=null,this.mapLayoutMap=null,this.delveLayoutMap=null,this.blightLayoutMap=null,this.metamorphLayoutMap=null,this.deliriumLayoutMap=null,this.flaskLayoutMap=null,this.gemLayoutMap=null,this.renderedItems=[],this.$panelContents=null,r.on("activeCharacterChanged",(function(t){e.activeLeague!=t.get("league")&&(e.activeLeague=t.get("league"),e.clear(),e.showStashItems(!0===e.showTabs,0))}),this)},initCurrencyLayout:function(e){if(e.currencyLayout){if(this.currencyLayout=!0,this.$panelContents.addClass("currencyStash"),!this.currencyLayoutMap||!this.currencyLayoutMap.initialised){this.currencyLayoutMap=e.currencyLayout;var n=document.createElement("div");n.classList.add("currencyControls");var i=this.currencyLayoutMap.sections||[],o={general:l.translate("General"),influence:l.translate("Exotic")};i.forEach((function(e){var t=document.createElement("button");t.textContent=o[e],t.dataset.section=e;var i=this;t.addEventListener("click",(function(e){i.$panelContents.find("> .currencyControls > button").removeClass("selected"),i.$panelContents.find("> .section").hide();var t=e.target.dataset.section||null;t&&(e.target.classList.add("selected"),i.$panelContents.find("> .section."+t).show(),i.$panelContents.removeClass(Object.keys(o).join(" ")),i.$panelContents.addClass(t))})),n.appendChild(t)}),this),this.$panelContents.addClass("general"),this.$panelContents.append(n),i.forEach((function(e){var n=document.createElement("div");n.classList.add("section"),n.classList.add(e),t(n).hide(),this.$panelContents.append(n)}),this),n.querySelector("button").click(),this.currencyLayoutMap.initialised=!0}return!0}return this.removeCurrencyLayout(),!1},removeCurrencyLayout:function(){this.currencyLayoutMap&&this.currencyLayoutMap.initialised&&(this.$panelContents.find("> .section").remove(),this.$panelContents.find("> .currencyControls").remove(),this.$panelContents.removeClass("general influence"),this.currencyLayoutMap.initialised=!1),this.currencyLayout=!1,this.$panelContents.removeClass("currencyStash")},initFragmentLayout:function(e){if(e.fragmentLayout){if(this.fragmentLayout=!0,this.$panelContents.addClass("fragmentStash"),!this.fragmentLayoutMap||!this.fragmentLayoutMap.initialised){this.fragmentLayoutMap=e.fragmentLayout;var n=document.createElement("div");n.classList.add("fragmentControls");var i=this.fragmentLayoutMap.sections||[],o={general:l.translate("General"),breach:l.translate("Breach"),scarab:l.translate("Scarab"),eldritch:l.translate("Eldritch/Maven")};i.forEach((function(e){if(e in o){var t=document.createElement("button");t.textContent=o[e],t.dataset.section=e;var i=this;t.addEventListener("click",(function(e){if(!e.target.classList.contains("selected")){i.$panelContents.find("> .fragmentControls > button").removeClass("selected"),i.$panelContents.find("> .section").hide(),i.$panelContents.find("> .fragmentControls > button[parent]").hide();var t=e.target.dataset.section||null;t&&(i.$panelContents.find("> .fragmentControls > button[data-section=".concat(t,"]")).addClass("selected"),i.$panelContents.find("> .fragmentControls > button[parent=".concat(t,"]")).show(),i.$panelContents.find("> .section.".concat(t)).show(),i.$panelContents.removeClass(Object.keys(o).join(" ")),i.$panelContents.addClass(t))}})),n.appendChild(t)}}),this);var r=document.createElement("button");r.setAttribute("parent","eldritch"),r.dataset.section="eldritch";var a=this;r.addEventListener("click",(function(e){if(!e.target.classList.contains("selected")){a.$panelContents.find("> .fragmentControls > button[parent]").removeClass("selected"),a.$panelContents.find("> .section").hide();var t=e.target.dataset.section||null;t&&(e.target.classList.add("selected"),a.$panelContents.find("> .section."+t).show())}})),n.appendChild(r);var s=document.createElement("button");s.setAttribute("parent","eldritch"),s.dataset.section="maven";a=this;s.addEventListener("click",(function(e){if(!e.target.classList.contains("selected")){a.$panelContents.find("> .fragmentControls > button[parent]").removeClass("selected"),a.$panelContents.find("> .section").hide();var t=e.target.dataset.section||null;t&&(e.target.classList.add("selected"),a.$panelContents.find("> .section."+t).show())}})),n.appendChild(s),this.$panelContents.addClass("general"),this.$panelContents.append(n),i.forEach((function(e){var n=document.createElement("div");n.classList.add("section"),n.classList.add(e),t(n).hide(),this.$panelContents.append(n)}),this),n.querySelector("button").click(),this.fragmentLayoutMap.initialised=!0}return!0}return this.removeFragmentLayout(),!1},removeFragmentLayout:function(){this.fragmentLayoutMap&&this.fragmentLayoutMap.initialised&&(this.$panelContents.find("> .section").remove(),this.$panelContents.find("> .fragmentControls").remove(),this.$panelContents.removeClass("general breach scarab eldritch"),this.fragmentLayoutMap.initialised=!1),this.fragmentLayout=!1,this.$panelContents.removeClass("fragmentStash")},initDelveLayout:function(e){return e.delveLayout?(this.delveLayout=!0,this.delveLayoutMap=e.delveLayout,this.$panelContents.addClass("delveStash"),!0):(this.removeDelveLayout(),!1)},removeDelveLayout:function(){this.delveLayout=!1,this.$panelContents.removeClass("delveStash")},initBlightLayout:function(e){return e.blightLayout?(this.blightLayout=!0,this.blightLayoutMap=e.blightLayout,this.$panelContents.addClass("blightStash"),!0):(this.removeBlightLayout(),!1)},removeBlightLayout:function(){this.blightLayout=!1,this.$panelContents.removeClass("blightStash")},initDeliriumLayout:function(e){return e.deliriumLayout?(this.deliriumLayout=!0,this.deliriumLayoutMap=e.deliriumLayout,this.$panelContents.addClass("deliriumStash"),!0):(this.removeDeliriumLayout(),!1)},removeDeliriumLayout:function(){this.deliriumLayout=!1,this.$panelContents.removeClass("deliriumStash")},initMetamorphLayout:function(e){if(e.metamorphLayout){if(this.metamorphLayout=!0,this.$panelContents.addClass("metamorphStash"),this.metamorphLayoutMap&&this.metamorphLayoutMap.initialised){if(this.metamorphLayoutMap.initialised){(n=this.$panelContents.find("> .metamorphControls")[0]).querySelectorAll("button").forEach((function(e){e.dataset.count=0}))}}else{var n;this.metamorphLayoutMap=e.metamorphLayout,(n=document.createElement("div")).classList.add("metamorphControls");var i=this.metamorphLayoutMap.sections||[],o={brain:l.translate("Metamorph Brain"),eye:l.translate("Metamorph Eye"),lung:l.translate("Metamorph Lung"),heart:l.translate("Metamorph Heart"),liver:l.translate("Metamorph Liver")};i.forEach((function(e){var t=document.createElement("button");t.setAttribute("title",o[e]),t.dataset.section=e,t.dataset.count=0;var i=this;t.addEventListener("click",(function(e){i.$panelContents.find("> .metamorphControls > button").removeClass("selected"),i.$panelContents.find("> .section").hide();var t=e.target.dataset.section||null;t&&(e.target.classList.add("selected"),i.$panelContents.find("> .section."+t).show())})),n.appendChild(t)}),this),this.$panelContents.append(n),i.forEach((function(e){var n=document.createElement("div");n.classList.add("section"),n.classList.add(e),t(n).hide(),this.$panelContents.append(n)}),this),n.querySelector("button").click(),this.metamorphLayoutMap.initialised=!0}return!0}return this.removeMetamorphLayout(),!1},removeMetamorphLayout:function(){this.metamorphLayoutMap&&this.metamorphLayoutMap.initialised&&(this.$panelContents.find("> .section").remove(),this.$panelContents.find("> .metamorphControls").remove(),this.metamorphLayoutMap.initialised=!1),this.metamorphLayout=!1,this.$panelContents.removeClass("metamorphStash")},initMapLayout:function(e){return e.mapLayout?(this.mapLayout=!0,this.mapLayoutMap=e.mapLayout,this.$panelContents.addClass("mapStash"),!0):(this.removeMapLayout(),!1)},removeMapLayout:function(){this.mapLayout=!1,this.$panelContents.removeClass("mapStash")},initDivinationLayout:function(e){if(e.divinationLayout){if(this.divinationLayout=!0,!this.divinationLayoutMap){var n={w:e.divinationLayout.w,h:e.divinationLayout.h,cards:{}};for(var i in e.divinationLayout.cards){var o=e.divinationLayout.cards[i].id,r=e.divinationLayout.cards[i].name,a=e.divinationLayout.cards[i].hidden||!1,s=t('\n                            <div class="stashPanelDivinationCard" card="'.concat(o,'" style="width: ').concat(n.w,"px; height: ").concat(n.h,'px;">\n                                <div class="stashPanelDivinationCardName FontinSmallCaps">').concat(r,"</div>\n                            </div>\n                        "));n.cards[o]={id:o,name:r,hidden:a,$el:s}}this.divinationLayoutMap=n}this.$panelContents.addClass("divinationStash");var l=document.createElement("div");for(var c in l.classList.add("poeScroll"),this.$panelContents.append(l),this.divinationLayoutMap.scrollPane=t(l).scrollbar({showArrows:!0,scrolly:"advanced"}),this.divinationLayoutMap.cards){var d=this.divinationLayoutMap.cards[c].hidden,u=this.divinationLayoutMap.cards[c].$el;this.divinationLayoutMap.scrollPane.append(u),d?u.hide():u.show()}return!0}return this.removeDivinationLayout(),!1},removeDivinationLayout:function(){this.divinationLayoutMap&&(this.divinationLayoutMap.scrollPane&&this.divinationLayoutMap.scrollPane.data("scrollbar")&&(this.divinationLayoutMap.scrollPane.data("scrollbar").destroy(),this.divinationLayoutMap.scrollPane=null),this.$panelContents.find("> div.poeScroll").remove()),this.divinationLayout=!1,this.$panelContents.removeClass("divinationStash")},initFlaskLayout:function(e){if(e.flaskLayout){if(this.flaskLayout=!0,this.$panelContents.addClass("flaskStash"),!this.flaskLayoutMap||!this.flaskLayoutMap.initialised){this.flaskLayoutMap=e.flaskLayout;var t=document.createElement("div");t.classList.add("flaskControls");var n=this.flaskLayoutMap.filters||[],i={life:l.translate("Life Flasks"),mana:l.translate("Mana Flasks"),hybrid:l.translate("Hybrid Flasks"),utility:l.translate("Utility Flasks"),unique:l.translate("Unique Flasks")};n.forEach((function(e){var n=document.createElement("button");n.setAttribute("title",i[e]),n.dataset.filter=e;var o=this;n.addEventListener("click",(function(e){n.classList.toggle("selected"),o.updateFlaskLayout()})),t.appendChild(n)}),this),this.$panelContents.append(t);var o=document.createElement("div");o.classList.add("sections"),o.classList.add("poeScroll"),(this.flaskLayoutMap.sections||[]).forEach((function(e,t){var n=e.max>=100?l.translate("Item Level {0}",{"{0}":e.min+"+"}):l.translate("Item Level {0}-{1}",{"{0}":e.min,"{1}":e.max}),i=document.createElement("div");i.classList.add("section"),i.title=n,i.dataset.index=t,o.append(i)}),this),this.$panelContents.append(o),this.flaskLayoutMap.scrollPane=this.$panelContents.find("> .sections").scrollbar({showArrows:!0,scrolly:"advanced"}),this.flaskLayoutMap.scrollPane.parent().removeClass("sections"),this.flaskLayoutMap.initialised=!0}return!0}return this.removeFlaskLayout(),!1},updateFlaskLayout:function(){var e=[];this.$panelContents.find("> .flaskControls > button[data-filter].selected").each((function(){var t=this.dataset.filter;e.push(t)})),this.$panelContents.find(".sections > .section[data-index]").each((function(){var n=0;e.length?t(this).children(".itemPlaced").each((function(){var i=t(this).attr("filter");-1===e.indexOf(i)?t(this).hide():(t(this).show(),n++)})):t(this).children(".itemPlaced").each((function(){t(this).show(),n++})),t(this).css("display",n?"":"none")}))},removeFlaskLayout:function(){this.flaskLayoutMap&&this.flaskLayoutMap.initialised&&(this.flaskLayoutMap.scrollPane&&this.flaskLayoutMap.scrollPane.data("scrollbar")&&(this.flaskLayoutMap.scrollPane.data("scrollbar").destroy(),this.flaskLayoutMap.scrollPane=null),this.$panelContents.find("> .flaskControls").remove(),this.$panelContents.find("> .sections").remove(),this.flaskLayoutMap.initialised=!1),this.flaskLayout=!1,this.$panelContents.removeClass("flaskStash")},initGemLayout:function(e){if(e.gemLayout){if(this.gemLayout=!0,this.$panelContents.addClass("gemStash"),!this.gemLayoutMap||!this.gemLayoutMap.initialised){this.gemLayoutMap=e.gemLayout;var t=document.createElement("div");t.classList.add("gemControls");var n=this.gemLayoutMap.filters||[],i={S:l.translate("Red Gems"),D:l.translate("Green Gems"),I:l.translate("Blue Gems"),G:l.translate("White Gems")};n.forEach((function(e){var n=document.createElement("button");n.setAttribute("title",i[e]),n.dataset.filter=e;var o=this;n.addEventListener("click",(function(e){n.classList.toggle("selected"),o.updateGemLayout()})),t.appendChild(n)}),this),this.$panelContents.append(t);var o=document.createElement("div");o.classList.add("sections"),o.classList.add("poeScroll"),(this.gemLayoutMap.sections||[]).forEach((function(e,t){var n=e.max>=100?l.translate("Level {0}",{"{0}":e.min+"+"}):e.min===e.max?l.translate("Level {0}",{"{0}":e.min}):l.translate("Level {0}-{1}",{"{0}":e.min,"{1}":e.max}),i=document.createElement("div");i.classList.add("section"),i.title=n,i.dataset.index=t,o.append(i)}),this),this.$panelContents.append(o),this.gemLayoutMap.scrollPane=this.$panelContents.find("> .sections").scrollbar({showArrows:!0,scrolly:"advanced"}),this.gemLayoutMap.scrollPane.parent().removeClass("sections"),this.gemLayoutMap.initialised=!0}return!0}return this.removeGemLayout(),!1},updateGemLayout:function(){var e=[];this.$panelContents.find("> .gemControls > button[data-filter].selected").each((function(){var t=this.dataset.filter;e.push(t)})),this.$panelContents.find(".sections > .section[data-index]").each((function(){var n=0;e.length?t(this).children(".itemPlaced").each((function(){var i=t(this).attr("filter");-1===e.indexOf(i)?t(this).hide():(t(this).show(),n++)})):t(this).children(".itemPlaced").each((function(){t(this).show(),n++})),t(this).css("display",n?"":"none")}))},removeGemLayout:function(){this.gemLayoutMap&&this.gemLayoutMap.initialised&&(this.gemLayoutMap.scrollPane&&this.gemLayoutMap.scrollPane.data("scrollbar")&&(this.gemLayoutMap.scrollPane.data("scrollbar").destroy(),this.gemLayoutMap.scrollPane=null),this.$panelContents.find("> .gemControls").remove(),this.$panelContents.find("> .sections").remove(),this.gemLayoutMap.initialised=!1),this.gemLayout=!1,this.$panelContents.removeClass("gemStash")},initQuadLayout:function(e){return e.quadLayout?(this.quadLayout=!0,this.$panelContents.addClass("quadStash"),!0):(this.removeQuadLayout(),!1)},removeQuadLayout:function(){this.quadLayout=!1,this.$panelContents.removeClass("quadStash")},initEssenceLayout:function(e){return e.essenceLayout?(this.essenceLayout=!0,this.essenceLayoutMap=e.essenceLayout,this.$panelContents.addClass("essenceStash"),!0):(this.removeEssenceLayout(),!1)},removeEssenceLayout:function(){this.essenceLayout=!1,this.$panelContents.removeClass("essenceStash")},showStashItems:function(e,n){var o=this,r=new t.Deferred;this.tabIndex=null!=n?n:this.tabsControl.getSelectedTabIndex();var a={accountName:this.model.get("name"),realm:this.model.get("realm"),league:this.activeLeague,tabs:!!e,tabIndex:this.tabIndex};return this.clearItems(),this.clear(),this.$el.find(".loading").show(),r.always((function(){return o.$el.find(".loading").hide()})),(this.guild?i.getGuildStashItems(a):i.getStashItems(a)).done((function(e,t){t.tabs&&o.tabsControl.loadTabs(t.tabs);var n=o.tabsControl.getSelectedTab();if(n){var i=n.getColour();o.setBorderColour(i.r,i.g,i.b)}o.collection=e,o.currencyLayout=o.initCurrencyLayout(t),o.fragmentLayout=o.initFragmentLayout(t),o.mapLayout=o.initMapLayout(t),o.quadLayout=o.initQuadLayout(t),o.essenceLayout=o.initEssenceLayout(t),o.delveLayout=o.initDelveLayout(t),o.blightLayout=o.initBlightLayout(t),o.deliriumLayout=o.initDeliriumLayout(t),o.metamorphLayout=o.initMetamorphLayout(t),o.divinationLayout=o.initDivinationLayout(t),o.flaskLayout=o.initFlaskLayout(t),o.gemLayout=o.initGemLayout(t),o.showItems(),r.resolve()})).fail((function(){e&&o.tabsControl.close(),r.reject()})),r.promise()},showItems:function(){var e=this;this.clearItems(),this.collection.each((function(t){var n=e.layoutItem(t),i=n.x,r=n.y,a=n.w,s=n.h,l=n.hiddenSlotIndex,c=n.slotScale,d=n.section,u=n.filter,h=t.get("inventoryId"),p={league:e.activeLeague,item:t,inventory:h},f=new o({model:t,enableLeague:!1,divinationLayout:e.divinationLayout,hiddenSlotIndex:l});if(f.setPlaced(a,s),f.on("itemClick",function(e){this.itemClicked(e)}.bind(e,p)),f.render(),f.$el.css("position","absolute"),f.$el.css("left",i),f.$el.css("top",r),1!=c&&(f.$el.css("transform-origin","top left"),f.$el.css("transform","scale("+c+")")),e.divinationLayout){var v=t.attributes.artFilename,m=e.$panelContents.find('.stashPanelDivinationCard[card="'.concat(v,'"]'));m.length?(m.append(f.$el),m.show()):console.error("Couldn't find matching card element for ".concat(v))}else if(e.metamorphLayout&&d){e.$panelContents.find(".section."+d).append(f.$el);var g=e.$panelContents.find("button[data-section="+d+"]"),y=parseInt(g.attr("data-count")||0);g.attr("data-count",y+1)}else(e.currencyLayout||e.fragmentLayout)&&d?e.$panelContents.find(".section.".concat(d)).append(f.$el):(e.flaskLayout||e.gemLayout)&&null!==d?(f.$el.attr("filter",u),f.$el.css("position",""),f.$el.css("left",""),f.$el.css("top",""),e.$panelContents.find(".section[data-index=".concat(d,"]")).append(f.$el)):e.$panelContents.append(f.$el);e.renderedItems.push(f),f.trigger("displayed")})),this.flaskLayout?this.updateFlaskLayout(!0):this.gemLayout&&this.updateGemLayout(!0)},layoutItem:function(e){var t=s.gridSize*e.get("x"),n=s.gridSize*e.get("y"),i=e.get("w"),o=e.get("h"),r=1,a=null,l=null,c=null;if(this.quadLayout&&(t*=.5,n*=.5),this.currencyLayout&&this.currencyLayoutMap&&void 0!==this.currencyLayoutMap.layout[e.attributes.x]){var d=this.currencyLayoutMap.layout[e.attributes.x];t=d.x,n=d.y,i=d.w,o=d.h,l=d.section||null,d.hidden&&(a=e.get("x"))}if(this.fragmentLayout&&this.fragmentLayoutMap){var u=e.attributes.y?"".concat(e.attributes.x,",").concat(e.attributes.y):e.attributes.x;if(void 0!==this.fragmentLayoutMap.layout[u]){var h=this.fragmentLayoutMap.layout[u];t=h.x,n=h.y,i=h.w,o=h.h,r=h.scale||1,l=h.section||null,h.hidden&&(a=e.get("x"))}}if(this.essenceLayout&&this.essenceLayoutMap&&void 0!==this.essenceLayoutMap[e.attributes.x]){var p=this.essenceLayoutMap[e.attributes.x];t=p.x,n=p.y,i=p.w,o=p.h}if(this.delveLayout&&this.delveLayoutMap&&void 0!==this.delveLayoutMap[e.attributes.x]){var f=this.delveLayoutMap[e.attributes.x];t=f.x,n=f.y,i=f.w,o=f.h,r=f.scale||1,f.hidden&&(a=e.get("x"))}if(this.blightLayout&&this.blightLayoutMap&&void 0!==this.blightLayoutMap[e.attributes.x]){var v=this.blightLayoutMap[e.attributes.x];t=v.x,n=v.y,i=v.w,o=v.h,r=v.scale||1}if(this.deliriumLayout&&this.deliriumLayoutMap&&void 0!==this.deliriumLayoutMap[e.attributes.x]){var m=this.deliriumLayoutMap[e.attributes.x];t=m.x,n=m.y,i=m.w,o=m.h,r=m.scale||1,m.hidden&&(a=e.get("x"))}if(this.metamorphLayout&&this.metamorphLayoutMap){var g=e.attributes.x;if(void 0===this.metamorphLayoutMap.layout[g]&&(g="".concat(e.attributes.x,",").concat(e.attributes.y)),void 0!==this.metamorphLayoutMap.layout[g]){var y=this.metamorphLayoutMap.layout[g];t=y.x,n=y.y,i=y.w,o=y.h,r=y.scale||1,l=y.section||null}}if(this.divinationLayout&&this.divinationLayoutMap&&(t=0,n=0),this.flaskLayout&&this.flaskLayoutMap){t=0,n=0;var b="".concat(e.attributes.x,",").concat(e.attributes.y);if(void 0!==this.flaskLayoutMap.layout[b]){var w=this.flaskLayoutMap.layout[b];l=void 0!==w.section?w.section:null,c=w.filter||null}}if(this.gemLayout&&this.gemLayoutMap){t=0,n=0;var x="".concat(e.attributes.x,",").concat(e.attributes.y);if(void 0!==this.gemLayoutMap.layout[x]){var P=this.gemLayoutMap.layout[x];l=void 0!==P.section?P.section:null,c=P.filter||null}}return{x:t,y:n,w:i,h:o,hiddenSlotIndex:a,slotScale:r,section:l,filter:c}},clearItems:function(){for(var e=0,t=this.renderedItems.length;e<t;++e)this.renderedItems[e].close();this.renderedItems=[]},itemClicked:function(e){r.trigger("inventoryItem.click",e)},show:function(){this.tabsControl.show(),this.$el.show()},hide:function(){this.$el.hide(),this.tabsControl.hide()},clear:function(){this.removeCurrencyLayout(),this.removeFragmentLayout(),this.removeMapLayout(),this.removeQuadLayout(),this.removeEssenceLayout(),this.removeDelveLayout(),this.removeBlightLayout(),this.removeMetamorphLayout(),this.removeDeliriumLayout(),this.removeMetamorphLayout(),this.removeDivinationLayout(),this.removeFlaskLayout(),this.removeGemLayout()},close:function(){this.tabsControl.close(),this.remove(),this.unbind()},setBorderColour:function(e,t,n){this.$panelContents.css("border-color","rgb("+e+","+t+","+n+")")},setGuildPanel:function(e){this.guild=e,this.tabIndex=0},render:function(){var e=this,n=t.Deferred();this.$el.html('\n                <div class="headerLabel"></div>\n                <div class="stashTabContainer tabControl">\n                    <div class="leftControls">\n                        <div class="leftButton"></div>\n                    </div>\n                    <div class="loading"></div>\n                    <div class="tabWindow">\n                        <div class="tabs"></div>\n                    </div>\n                    <div class="rightControls">\n                        <div class="rightButton"></div>\n                        <div class="tabSelectButton"></div>\n                        <div class="stashTabSelectWrapper">\n                            <div class="stashTabSelect poeScroll FontinRegular"></div>\n                        </div>\n                    </div>\n                    <div class="stashTabContents"></div>\n                </div>\n            '),this.$headerLabel=this.$el.find(".headerLabel"),this.$tabsControl=this.$el.find(".stashTabContainer"),this.$panelContents=this.$el.find(".stashTabContents"),this.$headerLabel.html(this.guild?l.translate("Guild Stash"):l.translate("Stash"));var i=s.inventory.stash.x,o=s.inventory.stash.y+46;return this.$tabsControl.css({left:i,top:o}),this.tabsControl=new a(this.$tabsControl,this.options.tabControlConfig),this.tabsControl.onTabClicked=function(t){var n=t.getColour();e.setBorderColour(n.r,n.g,n.b),e.showStashItems().done((function(){e.setBorderColour(n.r,n.g,n.b)}),t.index)},this.showStashItems(!0===this.showTabs,this.tabIndex).done((function(){n.resolve(e)})).fail((function(){n.reject()})),this.rendered=!0,n.promise()}})})),define("PoE/Backbone/Model/Item/MTXStashGroup",["Backbone","./MTXItem","PoE/Backbone/Collection/Item/MTXItemCollection"],(function(e,t,n){return e.RelationalModel.extend({idAttribute:"groupName",relations:[{type:e.HasMany,key:"MTXItems",relatedModel:t,collectionType:n}]})})),define("PoE/Backbone/Collection/Item/MTXStashGroupCollection",["Backbone","PoE/Backbone/Model/Item/MTXStashGroup"],(function(e,t){return e.Collection.extend({model:t})})),define("text!PoE/Item/MTXItem.hbt",[],(function(){return'<div class="popupPlaceholder"></div>\n<img src="{{icon}}" class="{{#ifCond count "===" usedCount}}inUse{{/ifCond}}">\n<div class="stackSize">{{#ifCond count ">" 1}}{{#ifCond usedCount ">" 0}}{{math count \'-\' usedCount}}/{{/ifCond}}{{count}}{{/ifCond}}</div>\n<div class="inUseText">\n    {{#ifCond count "===" usedCount}}\n    <span>{{translate "In Use"}}</span>\n    {{/ifCond}}\n    {{#if equippedText}}\n    <br><span class="equippedText">{{equippedText}}</span>\n    {{/if}}\n</div>'})),define("PoE/Item/MTXItem",["Handlebars","Backbone","jquery","PoE/Handlebars/TemplateCollection","./Popup","PoE/Layout/Popup/Popup","text!PoE/Item/MTXItem.hbt"],(function(e,t,n,i,o,r){return t.View.extend({initialize:function(){this.state={itemHovered:!1},!0===this.options.manualPosition&&(this.manualPosition=!0),this.options.showSockets&&this.$el.addClass("showSockets"),this.options.scale=!!this.options.scale},events:{click:"itemClick"},itemClick:function(e){this.trigger("itemClick",this.model)},render:function(){var e=this,t=this.model.toJSON(),a=n.Deferred();return t.enableLeague=this.options.enableLeague,i.load("PoE/Item/MTXItem.hbt").done((function(n){if(e.$el.empty().html(n(t)),e.mainPopup={view:null,popup:null},!0===t.identified){var i=new o({model:e.model});i.render(),e.mainPopup.view=i,e.mainPopup.popup=new r(i.$el),e.mainPopup.popup.events.prePosition=function(){e.mainPopup.view.updatePopupWidth()}}else{var s=document.createElement("div");s.textContent=t.text,s.classList.add("itemTooltip"),s.classList.add("FontinRegular"),e.mainPopup.popup=new r(s)}e.$el.find(".popupPlaceholder:first").replaceWith(e.mainPopup.popup.el),e.mainPopup.popup.create(),e.itemIconEl=e.$el.find(".icon:first"),e.$el.mouseenter((function(){e.handleItemMouseover()})).mouseleave((function(){e.handleItemMouseout()})),e.$el.addClass("mtxItem"),e.$el.addClass("itemRendered"),e.$el.addClass(e.model.get("h")>2?"large":"small"),e.trigger("render"),a.resolve(e.$el)})),a.promise()},handleItemMouseover:function(e){this.hoverStart(),this.state.inSocketHover||this.mainPopup.popup.smartPositionByEl(this.$el)},handleItemMouseout:function(){this.mainPopup.popup.hide(),this.hoverEnd()},hoverStart:function(){this.state.itemHovered=!0,this.$el.addClass("hovered")},hoverEnd:function(){this.state.itemHovered=!1,this.$el.removeClass("hovered")},close:function(){this.remove(),this.off(),this.mainPopup.view&&this.mainPopup.view.close()}})})),define("text!PoE/Inventory/MTXStashGroup.hbt",[],(function(){return'<div class="mtxGroup">\r\n    <div class="mtxGroupHeader">\r\n        <div class="tabSelectButton collapseGroup"></div>\r\n        {{groupName}}\r\n    </div>\r\n    <div class="mtxItems">\r\n    </div>\r\n    <div class="clear"></div>\r\n</div>'})),define("PoE/Inventory/MTXStashGroup",["plugins","Backbone","PoE/Backbone/EventBus","PoE/Handlebars/TemplateCollection","PoE/Item/MTXItem","PoE/Backbone/Model/Item/MTXItem","text!PoE/Inventory/MTXStashGroup.hbt"],(function(e,t,n,i,o,r){return t.View.extend({initialize:function(){this.renderedItems=[]},events:{"click .collapseGroup":"collapseGroup"},collapseGroup:function(t){e(t.target).parent().parent().find(".mtxItems").toggle()},close:function(){for(var e=0,t=this.renderedItems.length;e<t;++e)this.renderedItems[e].close();this.renderedItems=[],this.$el.empty()},render:function(){var t=e.Deferred(),n=this;return i.load("PoE/Inventory/MTXStashGroup.hbt").done((function(i){var r=[],a=n.model.toJSON();n.$el.html(i(a)),n.$mtxItems=n.$el.find(".mtxItems"),n.model.get("MTXItems").each((function(t){var i=e.Deferred(),a=new o({model:t});a.render().done((function(e){n.$mtxItems.append(e),i.resolve()})),n.renderedItems.push(a),r.push(i.promise())})),e.when.apply(e,r).always((function(){t.resolve(n.$el)})),n.rendered=!0})),t.promise()}})})),define("text!PoE/Inventory/MTXStashPanel.hbt",[],(function(){return'\r\n<div class="headerLabel"></div>\r\n<div id="mtxSortBox">\r\n    {{translate "Sort Items By:"}}\r\n    <select id="mtxSort">\r\n        <option value="categories" {{#ifCond sortOrder "==" "categories"}} selected {{/ifCond}}>{{translate "Categories"}}</option>\r\n        <option value="theme" {{#ifCond sortOrder "==" "theme"}} selected {{/ifCond}}>{{translate "Theme"}}</option>\r\n    </select>\r\n</div>\r\n<div id="mtxGroups" class="stashTabContainer poeScroll">\r\n</div>'})),define("PoE/Inventory/MTXStashPanel",["require","plugins","Backbone","PoE/API/League","PoE/Backbone/EventBus","PoE/Handlebars/TemplateCollection","PoE/Backbone/Collection/Item/MTXStashGroupCollection","PoE/Inventory/MTXStashGroup","PoE/Helpers","text!PoE/Inventory/MTXStashPanel.hbt"],(function(e){var t=e("plugins"),n=e("Backbone"),i=e("PoE/API/League"),o=e("PoE/Backbone/EventBus"),r=e("PoE/Handlebars/TemplateCollection"),a=e("PoE/Backbone/Collection/Item/MTXStashGroupCollection"),s=e("PoE/Inventory/MTXStashGroup"),l=e("PoE/Helpers");return e("text!PoE/Inventory/MTXStashPanel.hbt"),n.View.extend({initialize:function(){this.$el.addClass("stashPanel").addClass("mtxStashPanel"),this.renderedGroups=[],this.activeLeague=this.options.activeLeague,this.sortOrder="category",this.$stashTabEl=!1},fetchMtxItems:function(){var e=this,n=t.Deferred(),o={accountName:this.model.get("name"),realm:this.model.get("realm"),sortOrder:this.sortOrder};return this.$stashTabEl&&this.$stashTabEl.addClass("loading"),i.getMTXStashItems(o).done((function(t){e.groups=new a(t.groups),n.resolve(e.groups)})),n.promise()},events:{"change #mtxSort":"changeSort"},changeSort:function(e){this.sortOrder=this.$mtxSort.val(),this.clearItems(),this.render()},clearItems:function(){for(var e=0,t=this.renderedGroups.length;e<t;++e)this.renderedGroups[e].close();this.renderedGroups=[]},itemClicked:function(e){o.trigger("inventoryItem.click",e)},show:function(){this.$el.show()},hide:function(){this.$el.hide()},close:function(){this.remove(),this.unbind()},setBorderColour:function(e,t,n){this.$el.find(".stashTabContainer").css("border-color","rgb("+e+","+t+","+n+")")},render:function(){var e=this,n=t.Deferred();return r.load("PoE/Inventory/MTXStashPanel.hbt").done((function(i){var o={sortOrder:e.sortOrder};e.$el.html(i(o)),e.$headerLabel=e.$el.find(".headerLabel"),e.$mtxSort=e.$el.find("#mtxSort"),e.$stashTabEl=e.$el.find("#mtxGroups"),e.$headerLabel.html(l.translate("Microtransactions")),e.$mtxGroups=e.$stashTabEl,e.$mtxGroups.scrollbar({showArrows:!0,scrolly:"advanced",ignoreMobile:!0})||e.$mtxGroups.css("overflow-y","auto"),e.setBorderColour(137,100,64),e.fetchMtxItems().done((function(i){var o=[];i.each((function(n){var i=t.Deferred(),r=new s({model:n});r.render().done((function(t){e.$mtxGroups.append(t),i.resolve()})),e.renderedGroups.push(r),o.push(i.promise())})),t.when.apply(t,o).always((function(){e.$stashTabEl.removeClass("loading"),e.rendered=!0,e.setBorderColour(137,100,64),n.resolve()}))})),e.delegateEvents()})),n.promise()}})})),define("PoE/Backbone/Model/Character/Character",["Backbone"],(function(e){return e.RelationalModel.extend({relations:[]})})),define("PoE/Backbone/Collection/Character/CharacterCollection",["Backbone","PoE/Backbone/Model/Character/Character"],(function(e,t){return e.Collection.extend({model:t})})),define("PoE/API/Account",["jquery","PoE/Backbone/Collection/Character/CharacterCollection"],(function(e,t){return{getCharacters:function(n){var i=e.Deferred();return e.ajax({url:"/character-window/get-characters",type:"POST",dataType:"json",data:{accountName:n.accountName,realm:n.realm},success:function(e){i.resolve(new t(e))}}),i.promise()}}})),define("text!PoE/Inventory/InventoryManagerMenuCharacter.hbt",[],(function(){return'{{#with character}}\n<div class="icon {{class}}"></div>\n<div class="infoLine1">\n    <span class="characterName">\n        {{#if expired}}<span class="expired-character-flag">*</span>{{/if}}\n        {{name}}\n    </span>\n    {{#if pinnable}}<a class="showcase-pin"></a>{{/if}}\n</div>\n<div class="infoLine2">{{translate "Level"}} {{level}} {{translate class}}</div>\n<div class="infoLine3">{{fullLeagueName}}</div>\n{{/with}}\n'})),define("PoE/Inventory/InventoryManagerMenuCharacter",["jquery","Backbone","PoE/Handlebars/TemplateCollection","PoE/Backbone/EventBus","PoE/Helpers","text!PoE/Inventory/InventoryManagerMenuCharacter.hbt"],(function(e,t,n,i,o){return t.View.extend({tagName:"li",initialize:function(){var e=this;this.$el.addClass("character"),this.active=e.options.active,this.model.get("expired")&&this.$el.addClass("expired"),this.active&&this.$el.addClass("active"),i.on("activeCharacterChanged",(function(t){t.get("name")==e.model.get("name")?(e.active=!0,e.$el.addClass("active")):(e.active=!1,e.$el.removeClass("active"))}))},events:{"click .icon":"characterClicked","click .infoLine1":"characterClicked","click .infoLine2":"characterClicked","click .showcase-pin":"pinCharacter"},characterClicked:function(){this.model.get("expired")||i.trigger("activeCharacterChanged",this.model)},pinCharacter:function(t){var n=this;t.preventDefault(),t.stopPropagation(),this.model.set("pinnable",!1),e(t.target).hide(),i.trigger("character-pinned"),e.ajax({url:"/api/account/showcase-pins",dataType:"json",data:JSON.stringify({type:"character",charactername:this.model.get("name")}),contentType:"application/json",type:"POST",error:function(){n.model.set("pinnable",!0),e(t.target).show(),alert(o.translate("There was an error adding this pin"))}})},render:function(){var e=this;n.load("PoE/Inventory/InventoryManagerMenuCharacter.hbt").done((function(t){var n=e.model.toJSON();n.fullLeagueName=o.translate("{{LEAGUE}} League",{"{{LEAGUE}}":o.translate(n.league)});var i={character:n};e.$el.html(t(i))}))}})})),define("text!PoE/Inventory/InventoryManagerMenu.hbt",[],(function(){return'{{#unless equippedOnly}}\n<a href="#" class="inventoryButton showInventoryButton active"></a>\n<a href="#" class="inventoryButton showStashButton"></a>\n<a href="#" class="inventoryButton showGuildStashButton"></a>\n<a href="#" class="inventoryButton showMTXStashButton"></a>\n<a href="#" class="inventoryButton showSkillTreeButton"></a>\n<a href="#" class="inventoryButton showAtlasSkillTreeButton"></a>\n{{/unless}}\n<ul class="characters poeScroll">\n</ul>\n'})),define("PoE/Inventory/InventoryManagerMenu",["jquery","Backbone","PoE/Handlebars/TemplateCollection","PoE/API/Account","./InventoryManagerMenuCharacter","PoE/Backbone/EventBus","jquery.mousewheel","text!PoE/Inventory/InventoryManagerMenu.hbt","jquery.scrollbar"],(function(e,t,n,i,o,r){return t.View.extend({initialize:function(){var e=this,t=this;this.equippedOnly=this.options.equippedOnly||null;var n={accountName:this.model.get("name"),realm:this.model.get("realm")};this.charactersLoaded=i.getCharacters(n).done((function(e){t.characters=e})),this.activeCharacter=this.options.activeCharacter,r.on("activeCharacterChanged",(function(e){t.activeCharacter=e,t.updatePassiveSkillTreeLink(),t.updateAtlasSkillTreeLink()})),r.on("character-unpinned",(function(t){e.characters.forEach((function(n){n.get("name")===t&&(n.set("pinnable",!0),e.render())}))}))},updatePassiveSkillTreeLink:function(){this.model&&this.activeCharacter&&e(".showSkillTreeButton").attr("href","/character-window/view-passive-skill-tree?accountName="+this.model.get("name")+"&realm="+this.model.get("realm")+"&character="+this.activeCharacter.get("name"))},updateAtlasSkillTreeLink:function(){this.model&&this.activeCharacter&&e(".showAtlasSkillTreeButton").attr("href","/character-window/view-atlas-skill-tree?accountName="+this.model.get("name")+"&realm="+this.model.get("realm")+"&league="+this.activeCharacter.get("league"))},initElementRefs:function(){this.$menu=this.$el.find("ul"),this.$characters=this.$el.find(".characters")},events:{"click .showInventoryButton":"showInventory","click .showStashButton":"showStash","click .showGuildStashButton":"showGuildStash","click .showMTXStashButton":"showMTXStash"},showInventory:function(t){this.resetMenu(),this.trigger("showInventory"),e(".inventoryButton").removeClass("active"),e(t.target).addClass("active"),t.preventDefault()},showStash:function(t){this.resetMenu(),this.trigger("showStash"),e(".inventoryButton").removeClass("active"),e(t.target).addClass("active"),t.preventDefault()},showGuildStash:function(t){this.resetMenu(),this.trigger("showGuildStash"),e(".inventoryButton").removeClass("active"),e(t.target).addClass("active"),t.preventDefault()},showMTXStash:function(t){this.resetMenu(),this.trigger("showMTXStash"),e(".inventoryButton").removeClass("active"),e(t.target).addClass("active"),t.preventDefault()},resetMenu:function(){this.$menu.find("input").removeClass("active")},render:function(){var e=this;n.load("PoE/Inventory/InventoryManagerMenu.hbt").done((function(t){e.charactersLoaded.done((function(n){var i={equippedOnly:e.equippedOnly};e.$el.html(t(i)),e.initElementRefs();var r=0;if(n.each((function(t,n){var i=new o({model:t,active:t.get("name")===e.activeCharacter.get("name")});e.$characters.append(i.$el),i.render(),t.get("name")===e.activeCharacter.get("name")&&(r=n)})),n.size()>9||null!==e.equippedOnly&&n.size()>6){var a=e.$characters.find(".character").height();e.$characters.scrollTop(a*r),e.$characters.scrollbar({showArrows:!0,scrollx:"advanced",scrolly:"advanced",ignoreMobile:!0})||e.$characters.css("overflow-y","auto")}e.updatePassiveSkillTreeLink(),e.updateAtlasSkillTreeLink()}))}))}})})),define("PoE/PassiveSkillTree/ByteEncoder",[],(function(){return function(){this.init=function(){this.dataString="",this.position=0},this.int16ToBytes=function(e){return this.intToBytes(e,2)},this.intToBytes=function(e,t){t=t||4,e=parseInt(e);var n=[],i=t;do{n[--i]=255&e,e>>=8}while(i>0);return n},this.appendInt8=function(e){this.appendInt(e,1)},this.appendInt16=function(e){this.appendInt(e,2)},this.appendInt=function(e,t){t=t||4;for(var n=this.intToBytes(e,t),i=0;i<t;++i)this.dataString+=String.fromCharCode(n[i])},this.getDataString=function(){return this.dataString},this.init()}})),define("PoE/PassiveSkillTree/Version",[],(function(){return 6})),define("PoE/PassiveSkillTree/GenerateLink",["plugins","PoE/PassiveSkillTree/ByteEncoder","PoE/PassiveSkillTree/Version"],(function(e,t,n){return function(e,i){var o=new t;o.appendInt(n),o.appendInt8(i.characterClass),o.appendInt8(i.ascendancyClass),o.appendInt8(i.hashes.length);for(var r=0,a=i.hashes.length;r<a;++r)o.appendInt16(i.hashes[r]);if(i.hashesEx){o.appendInt8(i.hashesEx.length);for(r=0,a=i.hashesEx.length;r<a;++r)o.appendInt16(i.hashesEx[r])}else o.appendInt8(0);if(i.masteryEffects){o.appendInt8(i.masteryEffects.length);for(r=0,a=i.masteryEffects.length;r<a;++r)o.appendInt(i.masteryEffects[r])}else o.appendInt8(0);var s=Base64.btoa(o.getDataString());s=s.replace(/\+/g,"-").replace(/\//g,"_"),i.version&&(s=i.version+"/"+s),i.realm&&"pc"!=i.realm&&(s=i.realm+"/"+s);var l=i.atlas?"atlas":"passive";return"/".concat(e?"fullscreen-":"").concat(l,"-skill-tree/")+s}})),define("PoE/Inventory/InventoryPanelControls",["require","plugins","Backbone","PoE/Backbone/EventBus","PoE/Helpers"],(function(e){var t=e("plugins"),n=e("Backbone"),i=(e("PoE/Backbone/EventBus"),e("PoE/Helpers"));return n.View.extend({initialize:function(){this.equippedOnly=this.options.equippedOnly||!1,this.activeTab="inventory",this.$el=this.options.$el,this.rendered=!1},events:{"click .inventoryPanelButton.inventory":"showInventoryPanel","click .inventoryPanelButton.cosmetic":"showCosmeticPanel","click .refreshButton":"refreshPanels"},showInventoryPanel:function(e){this.activeTab="inventory",this.$inventoryButton.addClass("selected"),this.$cosmeticButton.removeClass("selected"),this.trigger("showInventory")},showCosmeticPanel:function(e){this.equippedOnly||(this.activeTab="cosmetic",this.$inventoryButton.removeClass("selected"),this.$cosmeticButton.addClass("selected"),this.trigger("showCosmetic"))},refreshPanels:function(){this.trigger("refreshInventoryPanels")},show:function(){this.$el.show()},hide:function(){this.$el.hide()},close:function(){this.remove(),this.unbind()},render:function(){var e=t.Deferred();return this.rendered||(this.$el.empty().append('\n                    <div class="headerLabel"></div>\n                    <div class="refreshButton"><div class="refreshButtonIcon loading"></div></div>\n                    <div class="inventoryPanelButton inventory left"></div>\n                    <div class="inventoryPanelButton cosmetic right"></div>\n                '),this.rendered=!0),this.$headerLabel=this.$el.find(".headerLabel"),this.$inventoryButton=this.$el.find(".inventoryPanelButton.inventory"),this.$cosmeticButton=this.$el.find(".inventoryPanelButton.cosmetic"),this.$refreshButton=this.$el.find(".refreshButton"),this.$headerLabel.html(i.translate("Inventory")),"inventory"==this.activeTab?this.$inventoryButton.addClass("selected"):"cosmetic"==this.activeTab&&this.$cosmeticButton.addClass("selected"),this.equippedOnly&&(this.$cosmeticButton.hide(),this.$refreshButton.hide()),e.resolve(),this.delegateEvents(),e.promise()}})})),define("text!PoE/Inventory/MTXCategoryPopup.hbt",[],(function(){return'<div class="mtxCategoryPopupContainer FontinSmallCaps {{url}}Popup`">\n    <div class="mtx-category-popup-header">\n        {{#if name}}{{name}}{{else}}{{translate "Skill Gem Effect"}}{{/if}}\n        <button type="button" class="mtx-category-popup-close">close</button>\n    </div>\n    <div class="mtx-category-popup-content mtxItems">\n        {{#if items}}\n            <div class="mtx-category-popup-items" id="{{url}}-content">\n            </div>\n        {{else}}\n            <div class="mtx-category-popup-message">\n                <p>{{translate "You have no microtransactions that can fill this slot"}}</p>\n            </div>\n        {{/if}}\n        <div class="mtx-category-popup-button">\n            <a class="button-text mtx-nav-button" href="/shop/category/{{url}}">{{translate "Purchase Items for This Slot"}}</a>\n        </div>\n    </div>\n</div>'})),define("PoE/Inventory/MTXCategoryPopup",["require","text!PoE/Inventory/MTXCategoryPopup.hbt","jquery.scrollbar","PoE/Layout/Popup/Popup","PoE/Geom/Point","PoE/Geom/Bounds","plugins","Backbone","PoE/Item/MTXItem","PoE/Handlebars/TemplateCollection"],(function(e){e("text!PoE/Inventory/MTXCategoryPopup.hbt"),e("jquery.scrollbar");var t=e("PoE/Layout/Popup/Popup"),n=e("PoE/Geom/Point"),i=e("PoE/Geom/Bounds"),o=e("plugins"),r=e("Backbone"),a=e("PoE/Item/MTXItem"),s=e("PoE/Handlebars/TemplateCollection");return function(){function e(n){_classCallCheck(this,e);var i=document.createElement("div"),l=this;l.mtxCategory=n;var c=o.Deferred();this.loadedPromise=c.promise(),s.load("PoE/Inventory/MTXCategoryPopup.hbt").done((function(e){if(i.innerHTML=e(n),i.querySelector(".mtx-category-popup-close").addEventListener("click",(function(e){l.close(e)})),l.$el=i.firstElementChild,l.popup=new t(l.$el,{useRelativePosition:!0}),l.popup.create(),c.resolve(),l.mtxCategory.items){var o=l.popup.el.find("#".concat(l.mtxCategory.url,"-content")),s=!1;l.mtxCategory.items.forEach((function(e){var t=new a({model:new r.Model(e)});t.render(),o.append(t.$el),s=3===e.h})),s&&l.mtxCategory.items.length>3||!s&&l.mtxCategory.items.length>6?o.scrollbar({showArrows:!0,scrollx:"advanced",scrolly:"advanced",ignoreMobile:!0}):l.popup.el.css("height","auto")}}))}return _createClass(e,[{key:"destroy",value:function(){this.popup&&delete this.popup,this.$el.remove()}},{key:"close",value:function(){this.popup&&this.popup.hide()}},{key:"handleMouseClick",value:function(e){this.popup.el.show();var t=this.popup.el.height(),r=o(e.target).offset(),a={viewport:{x:r.left,y:r.top}},s=new n(e.pageX,e.pageY),l=new i(new n(a.viewport.x,a.viewport.y),new n(a.viewport.x-10,a.viewport.y+t));this.popup.positionSmartLeft(new i(s,s),l)}}]),e}()})),define("PoE/Layout/Popup/PoETooltip",["require","./Popup"],(function(e){return function(e){_inherits(n,e);var t=_createSuper(n);function n(e,i,o){var r;_classCallCheck(this,n);var a=document.createElement("div");return a.innerHTML=i,a.classList.add("poe-tooltip"),(r=t.call(this,a,o)).$target=e,r.attach(),r}return _createClass(n,[{key:"attach",value:function(){var e=this;this.$target.on("mouseenter",(function(){e.smartPositionByEl(e.$target),e.show()})),this.$target.on("mouseleave",(function(){e.hide()}))}},{key:"destroy",value:function(){this.hide(),this.$target.off("mouseenter").off("mouseleave"),this.el.remove()}}]),n}(e("./Popup"))})),define("PoE/Inventory/MTXInventoryPanel",["plugins","Backbone","PoE/API/Character","PoE/Backbone/EventBus","./Constants","PoE/Backbone/Collection/Item/MTXItemCollection","PoE/Item/MTXItem","PoE/Item/Item","PoE/Inventory/MTXCategoryPopup","PoE/API/League","PoE/Layout/Popup/PoETooltip","PoE/Helpers","jquery.scrollbar"],(function(e,t,n,i,o,r,a,s,l,c,d,u){return t.View.extend({initialize:function(){var e=this;this.mtxMap=o.mtxInventory,this.$el.addClass("MTXInventoryPanel"),this.renderedItems=[],this.activeCharacter=this.options.activeCharacter,this.slotMapping=this.options.mtxSlotMapping,this.slotTooltips=[],this.mtxCategoryPopups=[],i.on("activeCharacterChanged",(function(t){e.activeCharacter=t,e.render()})),this.bindSlotPopups()},events:{},showCharacterItems:function(){var t=this,i=e.Deferred(),o={accountName:this.model.get("name"),realm:this.model.get("realm"),characterName:this.activeCharacter.get("name")};return n.getMtxItems(o).done((function(e){t.collection=e.activeBySlot,t.skills=e.skills,t.showItems(),t.showCharacterSkills(t.skills)})).then((function(){i.resolve()})),i.promise()},showItems:function(){var t=this,n=this;this.clearItems(),e.when.apply(e,_toConsumableArray(this.collection.map((function(i){var o=new a({model:i}),r=t.mtxMap[i.get("slot")]||null,s=e.Deferred();return r?(o.render().done((function(e){r.$el.empty().html(e),s.resolve()})),n.renderedItems.push(o)):s.resolve(),s})))).done((function(){t.bindSlotPopups(),t.slotTooltips.forEach((function(e){return e.destroy()})),t.slotTooltips=[],Object.entries(t.slotMapping).forEach((function(e){var n=_slicedToArray(e,2),i=n[0],o=n[1],r=t.$el.find(".".concat(i,":first"));r.children(":first").is(".itemRendered")||t.slotTooltips.push(new d(r,u.translate("View {MTX} microtransactions",{"{MTX}":o.name})))}))}))},bindSlotPopups:function(){var e=this;this.mtxCategoryPopups=[],Object.entries(this.slotMapping).forEach((function(t){var n=_slicedToArray(t,2),i=n[0],o=n[1];e.$el.off("click",".".concat(i)).on("click",".".concat(i),(function(t){e.mtxCategoryPopups[o.tag]?e.showMTXCategoryPopup(t,o.tag):e.createMTXCategoryPopup(_objectSpread(_objectSpread({},o),{},{slot:i,url:o.tag.replaceAll(/(.)([A-Z])/g,"$1-$2").toLowerCase()})).done((function(){e.showMTXCategoryPopup(t,o.tag)}))}))}))},clearItems:function(){for(var e=0,t=this.renderedItems.length;e<t;++e)this.renderedItems[e].close();this.renderedItems=[]},itemClicked:function(e){i.trigger("inventoryItem.click",e)},showCharacterSkills:function(n){var i=this;if(this.$el.find(".SkillGem").append(e("<div/>").addClass("SkillGem-container poeScroll")),$gemSlot=this.$el.find(".SkillGem-container"),n.forEach((function(e,n){var o=e.mtx?new a({model:new t.Model(e)}):new s({model:new t.Model(e),enableLeague:!1,divinationLayout:!1,hiddenSlotIndex:n});i.renderedItems.push(o),o.render(),$gemSlot.append(o.$el.addClass("small skillGemItem")),e.mtxCategory&&(i.createMTXCategoryPopup({tag:e.mtxCategory,url:e.mtxCategory.replaceAll(/(.)([A-Z])/g,"$1-$2").toLowerCase()},!0),o.$el.click((function(t){i.showMTXCategoryPopup(t,e.mtxCategory)})))})),n.length>9){var o=this.$el.find(".SkillGemScroll").first();o.addClass("poeScroll"),$gemSlot.scrollbar({showArrows:!0,scrollx:o,ignoreMobile:!0})}},setCloseMTXCategoryPopup:function(){var e=this;window.addEventListener("resize",(function(){e.closeAllMtxCategoryPopup()}))},createMTXCategoryPopup:function(t){var n=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=e.Deferred();return!t||this.mtxCategoryPopups[t.tag]?(o.resolve(),o.promise()):(c.getMTXStashItems({accountName:this.model.get("name"),realm:this.model.get("realm"),characterName:this.activeCharacter.get("name")}).done((function(e){var r=e.groups.find((function(e){return i?"SkillGem"===e.group:[t.tag,t.slot,t.shopType].includes(e.group)})),a=i&&r&&r.MTXItems?r.MTXItems.filter((function(e){return e.tags.includes(t.tag)})):r&&r.MTXItems;n.mtxCategoryPopups[t.tag]=new l(_objectSpread(_objectSpread({},t),{},{items:a})),n.mtxCategoryPopups[t.tag].loadedPromise.done((function(){return o.resolve()}))})),o.promise())},showMTXCategoryPopup:function(e,t){this.closeAllMtxCategoryPopup(),t&&this.mtxCategoryPopups[t]&&this.mtxCategoryPopups[t].handleMouseClick(e)},closeAllMtxCategoryPopup:function(){var e=this;Object.keys(this.mtxCategoryPopups).forEach((function(t){e.mtxCategoryPopups[t].close()}))},destroyAllMtxCategoryPopup:function(){var e=this;Object.keys(this.mtxCategoryPopups).forEach((function(t){e.mtxCategoryPopups[t].destroy()}))},show:function(){this.$el.show()},hide:function(){this.closeAllMtxCategoryPopup(),this.$el.hide()},close:function(){this.destroyAllMtxCategoryPopup(),this.clearItems(),this.remove(),this.unbind()},render:function(){var t=this,n=e.Deferred();return this.closeAllMtxCategoryPopup(),Object.keys(this.mtxMap).forEach((function(n){var i=t.mtxMap[n];if(0===t.$el.find(".".concat(n)).length){var o=e("<div>").addClass("mtxItem ".concat(n)).css({width:i.w,height:i.h,left:i.x+5,top:i.y+80,position:"absolute"});t.mtxMap[n].$el=o,t.$el.append(o)}else t.$el.find(".".concat(n)).empty();"SkillGem"===n&&0===t.$el.find(".SkillGemScroll").length&&t.$el.append(e("<div>").addClass("mtxItem SkillGemScroll").css({width:i.w+35,height:30,left:i.x-10,top:i.h+i.y+82,position:"absolute"}))})),this.showCharacterItems().then((function(){n.resolve()})),this.$el.click((function(n){(e(n.target).hasClass("MtxNav")||e(n.target).hasClass("SkillGem")||!e(n.target).hasClass("mtxItem")&&!e(n.target).parents().hasClass("mtxItem")||e(n.target).parents().hasClass("SkillGem")&&!e(n.target).hasClass("skillGemItem")&&!e(n.target).parents().hasClass("skillGemItem"))&&t.closeAllMtxCategoryPopup()})),this.delegateEvents(),n.promise()}})})),define("text!PoE/Inventory/InventoryManager.hbt",[],(function(){return'<div class="inventoryManagerMenu"></div>\n<div class="inventoryPanelControls"></div>\n<div class="activePanel"></div>\n{{#if equippedOnly}}\n<div class="characterPassiveSkillTree"></div>\n{{/if}}'})),define("PoE/Inventory/InventoryManager",["plugins","Backbone","PoE/Handlebars/TemplateCollection","./MainInventoryPanel","./StashPanel","./MTXStashPanel","./InventoryManagerMenu","PoE/PassiveSkillTree/GenerateLink","PoE/Backbone/EventBus","./InventoryPanelControls","./MTXInventoryPanel","../API/Character","../API/League","text!PoE/Inventory/InventoryManager.hbt"],(function(e,t,n,i,o,r,a,s,l,c,d,u,h){return t.View.extend({initialize:function(){var e=this,t=this;this.$el.addClass("inventoryManager"),this.account=this.options.account,this.activeCharacter=this.options.activeCharacter,this.mtxSlotMapping=this.options.mtxSlotMapping,this.equippedOnly=this.options.equippedOnly||null,this.renderedMainInventoryPanel=!1,this.renderedMTXInventoryPanel=!1,this.pinsChanged=!1,l.on("activeCharacterChanged",(function(e){t.showPassiveSkillTree(e),t.activeCharacter=e})),l.on("character-pinned",(function(){e.pinsChanged=!0}))},open:function(){var t=this;e(document).bind("cbox_open",(function(){t.show()})),e(document).bind("cbox_cleanup",(function(){t.hide(),e(document).unbind("cbox_open"),e(document).unbind("cbox_cleanup")})),this.show(),e.colorbox({inline:!0,href:this.$el,className:"inventoryManagerColorbox colorBoxPanelTheme",onComplete:function(){var e=t.$el.find(".character"),n=e.index(t.$el.find(".character.active")),i=e.height();t.$el.find(".characters").scrollTop(i*n)}}),this.$colorbox=e("#colorbox"),setTimeout((function(){e.colorbox.resize()}),2e3)},createMainInventoryPanel:function(){this.mainInventoryPanel||(this.mainInventoryPanel=new i({model:this.account,activeCharacter:this.activeCharacter,equippedOnly:this.equippedOnly}))},createMTXInventoryPanel:function(){this.MTXInventoryPanel||this.equippedOnly||(this.MTXInventoryPanel=new d({model:this.account,activeCharacter:this.activeCharacter,equippedOnly:this.equippedOnly,mtxSlotMapping:this.mtxSlotMapping}))},createInventoryControls:function(){if(!this.inventoryPanelControls){var e=this;this.inventoryPanelControls=new c({$el:this.$el.find(".inventoryPanelControls"),equippedOnly:this.equippedOnly}),this.inventoryPanelControls.on("showInventory",(function(){e.showMainInventory()})),this.inventoryPanelControls.on("showCosmetic",(function(){e.showMTXInventory()})),this.inventoryPanelControls.on("refreshInventoryPanels",(function(){e.refreshInventoryPanels()}))}},createStashPanel:function(){this.stashPanel||this.equippedOnly||(this.stashPanel=new o({model:this.account,activeLeague:this.options.activeCharacter.get("league"),tabs:!0}))},createMTXStashPanel:function(){this.mtxStashPanel||this.equippedOnly||(this.mtxStashPanel=new r({model:this.account,activeLeague:this.options.activeCharacter.get("league")}))},showPassiveSkillTree:function(t){var n=this;if(t&&(this.activeCharacter=t),this.equippedOnly){var i=this.activeCharacter.get("classId"),o=this.activeCharacter.get("name"),r=this.activeCharacter.get("ascendancyClass"),a={reqData:0,accountName:this.account.get("name"),realm:this.account.get("realm"),character:o};e.ajax({url:"/character-window/get-passive-skills",data:a,dataType:"json",success:function(e){if(!1!==e){var t="";a.character&&(t="?accountName="+n.account.get("name")+"&characterName="+a.character);var o=s(!0,{characterClass:i,ascendancyClass:r,hashes:e.hashes,hashesEx:e.hashes_ex,masteryEffects:e.mastery_effects,realm:n.account?n.account.get("realm"):void 0})+t;n.$passiveSkillTree.html('<iframe sandbox="allow-popups allow-scripts allow-forms allow-same-origin allow-top-navigation" src="'+o+'" width="903" height="630" scrolling="yes" frameborder="0"></iframe>')}}})}},createMenu:function(){var e=this;this.menu||(this.menu=new a({el:this.$menu,model:this.account,activeCharacter:this.options.activeCharacter,equippedOnly:this.equippedOnly}),this.menu.on("showInventory",(function(){e.showMainInventory()})),this.menu.on("showStash",(function(){e.showStash()})),this.menu.on("showGuildStash",(function(){e.showGuildStash()})),this.menu.on("showMTXStash",(function(){e.showMTXStash()})),this.menu.render())},showMainInventory:function(){this.createMainInventoryPanel(),this.createInventoryControls(),this.closeActivePanel(),this.currentPanel=this.mainInventoryPanel,this.renderActivePanel()},showMTXInventory:function(){this.createMTXInventoryPanel(),this.createInventoryControls(),this.closeActivePanel(),this.currentPanel=this.MTXInventoryPanel,this.renderActivePanel()},showStash:function(){this.createStashPanel(),this.closeActivePanel(),this.currentPanel=this.stashPanel,this.currentPanel.setGuildPanel(!1),this.emptyActivePanel(),this.renderActivePanel()},showGuildStash:function(){this.createStashPanel(),this.closeActivePanel(),this.currentPanel=this.stashPanel,this.currentPanel.setGuildPanel(!0),this.emptyActivePanel(),this.renderActivePanel()},showMTXStash:function(){this.createMTXStashPanel(),this.closeActivePanel(),this.currentPanel=this.mtxStashPanel,this.emptyActivePanel(),this.renderActivePanel()},closeActivePanel:function(){this.currentPanel&&(this.currentPanel===this.mainInventoryPanel||this.currentPanel===this.MTXInventoryPanel?this.currentPanel.hide():this.currentPanel.close())},closeInventoryPanels:function(){this.mainInventoryPanel&&this.mainInventoryPanel.close(),this.MTXInventoryPanel&&this.MTXInventoryPanel.close(),this.renderedMainInventoryPanel=!1,this.renderedMTXInventoryPanel=!1},renderActivePanel:function(){if(this.inventoryPanelControls&&(this.currentPanel===this.mainInventoryPanel||this.currentPanel===this.MTXInventoryPanel?(this.inventoryPanelControls.render(),this.inventoryPanelControls.show()):this.inventoryPanelControls.hide()),this.currentPanel===this.mainInventoryPanel&&this.renderedMainInventoryPanel||this.currentPanel===this.MTXInventoryPanel&&this.renderedMTXInventoryPanel)this.currentPanel.show();else{var t=this;this.updateRefreshButton(!0),this.$activePanel.append(this.currentPanel.$el),this.currentPanel.render().done((function(){e.colorbox.resize(),t.updateRefreshButton(!1)})),this.currentPanel.show(),this.currentPanel===this.mainInventoryPanel?this.renderedMainInventoryPanel=!0:this.currentPanel===this.MTXInventoryPanel&&(this.renderedMTXInventoryPanel=!0)}},refreshInventoryPanels:function(){var e=this.getRefreshButton();e.length>0&&!e.hasClass("loading")&&(this.currentPanel!==this.mainInventoryPanel&&this.currentPanel!==this.MTXInventoryPanel||(u.clearCache(),h.clearCache(),this.renderedMainInventoryPanel=!1,this.renderedMTXInventoryPanel=!1,this.closeInventoryPanels(),this.renderActivePanel()))},getRefreshButton:function(){return this.inventoryPanelControls?this.inventoryPanelControls.$el.find(".refreshButton .refreshButtonIcon"):null},updateRefreshButton:function(e){var t=this.getRefreshButton(),n="loading";t&&t.length>0&&(e&&!t.hasClass(n)&&t.addClass(n),!e&&t.hasClass(n)&&t.removeClass(n))},emptyActivePanel:function(){this.closeInventoryPanels(),this.$activePanel.empty()},performSideEffects:function(){this.pinsChanged&&(l.trigger("refresh-pins"),this.pinsChanged=!1)},show:function(){this.currentPanel&&this.currentPanel.show(),this.$el.show()},hide:function(){this.currentPanel&&this.currentPanel.hide(),this.$el.hide(),this.performSideEffects()},close:function(){this.closeActivePanel(),this.remove(),this.unbind()},render:function(){var e=this;return n.load("PoE/Inventory/InventoryManager.hbt").done((function(t){var n={equippedOnly:e.equippedOnly};e.$el.html(t(n)),e.$activePanel=e.$el.find(".activePanel"),e.$passiveSkillTree=e.$el.find(".characterPassiveSkillTree"),e.$menu=e.$el.find(".inventoryManagerMenu"),e.createMenu(),e.showPassiveSkillTree(),e.currentPanel?e.renderActivePanel():e.showMainInventory()}))}})})),define("text!PoE/Inventory/InventoryControls.hbt",[],(function(){return'{{#with character}}\n<div class="icon {{class}}"></div>\n<div class="infoLine1">\n    <span class="characterName">\n        {{#if expired}}<span class="expired-character-flag">*</span>{{/if}}\n        {{name}}\n    </span>\n    {{#if pinnable}}<a class="showcase-pin button add" data-type="character" data-charactername="{{name}}"></a>{{/if}}\n</div>\n<div class="infoLine2">{{translate "Level"}} {{level}} {{translate class}}</div>\n<div class="infoLine3">{{fullLeagueName}}</div>\n{{/with}}\n<a class="open" href="#">{{translate "SWITCH CHARACTER"}}</a>\n'})),define("PoE/Inventory/InventoryControls",["jquery","Backbone","PoE/Handlebars/TemplateCollection","./InventoryManager","PoE/Backbone/Model/Character/Character","PoE/Backbone/EventBus","PoE/Helpers","text!PoE/Inventory/InventoryControls.hbt"],(function(e,t,n,i,o,r,a){return t.View.extend({initialize:function(){var e=this;this.initElementRefs(),this.account=this.options.account,this.mtxSlotMapping=this.options.mtxSlotMapping,this.activeCharacter=this.options.activeCharacter,r.on("character-unpinned",(function(t){e.activeCharacter.get("name")===t&&(e.activeCharacter.set("pinnable",!0),e.render())}))},initElementRefs:function(){this.$body=e("body")},events:{"click .open":"open","click .icon":"open","click .infoLine1":"open","click .infoLine2":"open"},open:function(e){e.preventDefault();var t=this;if(!this.inventoryManager){var n={id:"inventory-manager"};n.activeCharacter=this.activeCharacter,n.account=this.account,n.mtxSlotMapping=this.mtxSlotMapping,this.inventoryManager=new i(n),this.$body.append(this.inventoryManager.$el),this.inventoryManagerRendered=this.inventoryManager.render()}this.inventoryManagerRendered.done((function(){t.inventoryManager.open()}))},render:function(){var e=this,t=this.activeCharacter.toJSON();t.fullLeagueName=a.translate("{{LEAGUE}} League",{"{{LEAGUE}}":a.translate(t.league)});var i={character:t};n.load("PoE/Inventory/InventoryControls.hbt").done((function(t){e.$el.html(t(i))}))}})})),define("PoE/Model/Account/Guild/PointsTransaction",["Backbone"],(function(e){return e.RelationalModel.extend({url:"/api/account/guild/point-transactions",relations:[]})})),define("PoE/Model/Account/Guild/Guild",["require","Backbone"],(function(e){return e("Backbone").RelationalModel.extend({url:"/api/guild",relations:[]})})),define("PoE/Collection/Account/Guild/PointTransactions",["require","jquery","Backbone","PoE/Backbone/Paginator","PoE/Model/Account/Guild/PointsTransaction"],(function(e){e("jquery"),e("Backbone");var t=e("PoE/Backbone/Paginator"),n=e("PoE/Model/Account/Guild/PointsTransaction");return t.extend({model:n,paginator_core:{url:"/api/account/guild/point-transactions",dataType:"json"},paginator_ui:{firstPage:1,currentPage:1,perPage:5,totalPages:10},server_api:{offset:function(){return(this.currentPage-1)*this.perPage},limit:function(){return this.perPage}},perPageOptions:[5,20,50,100],parse:function(e){return e.limit&&(this.perPage=parseInt(e.limit,10)),this.totalRecords=e.total,this.totalPages=Math.ceil(e.total/this.perPage),e.entries}})})),define("PoE/API/Error",["require","jquery"],(function(e){var t=e("jquery"),n=function(){this.message=null,this.code=null};return n.prototype.getMessage=function(){return this.message},n.prototype.setMessage=function(e){this.message=e},n.prototype.setCode=function(e){this.code=e},n.fromResponse=function(e){var i,o=new n;return e.responseText&&(i=t.parseJSON(e.responseText),o.setMessage(i.error.message),o.setCode(i.error.code)),o},n})),define("text!PoE/Widget/Guild/AccountTransaction.hbt",[],(function(){return'<div class="txInfo">\r\n    <div class="left">\r\n        <span class="points">{{points}}<span class="pointsIcon" title="Points"></span></span>\r\n        <span class="guild">{{translate "points transferred to"}} <a href="/guild/profile/{{guild.id}}">{{#if guild.name}}{{guild.name}}{{else}}<span class="error">{{translate "Deleted"}}</span>{{/if}}</a></span>\r\n    </div>\r\n    <div class="createdAt">{{moment createdAt format="MMMM Do YYYY, h:mm:ss a"}}</div>\r\n</div>\r\n{{#ifCond status "===" "new"}}\r\n<div class="menu">\r\n    <button class="cancel button1 important">{{translate "Cancel"}}</button>\r\n</div>\r\n{{else}}\r\n<div class="status">\r\n    {{#ifCond status "===" "cancelled"}}{{translate "Cancelled"}}{{/ifCond}}\r\n    {{#ifCond status "===" "rejected"}}{{translate "Rejected"}}{{/ifCond}}\r\n    {{#ifCond status "===" "complete"}}{{translate "Complete"}}{{/ifCond}}\r\n</div>\r\n{{/ifCond}}\r\n<div class="error"></div>'})),define("PoE/Widget/Guild/AccountTransaction",["require","Backbone","jquery","PoE/Handlebars/TemplateCollection","PoE/Model/Account/Guild/PointsTransaction","PoE/Loader","PoE/API/Error","PoE/Helpers","text!PoE/Widget/Guild/AccountTransaction.hbt"],(function(e){var t=e("Backbone"),n=(e("jquery"),e("PoE/Handlebars/TemplateCollection")),i=(e("PoE/Model/Account/Guild/PointsTransaction"),e("PoE/Loader")),o=e("PoE/API/Error"),r=e("PoE/Helpers");return e("text!PoE/Widget/Guild/AccountTransaction.hbt"),t.View.extend({initialize:function(){},events:{"click button.cancel":"cancel"},startAction:function(){i.start(),this.disableButtons(),this.clearError()},endAction:function(){i.done(),this.enableButtons()},disableButtons:function(){this.$cancelButton.attr("disabled",!0)},enableButtons:function(){this.$cancelButton.removeAttr("disabled")},cancel:function(){var e=this;return confirm(r.translate("Cancel transaction?"))&&(this.startAction(),this.model.save({method:"cancel"},{type:"post",success:function(){e.render()},error:function(t,n){var i=o.fromResponse(n);e.showError(i.getMessage())}}).always((function(){e.endAction()}))),!1},clearError:function(){this.$error.hide()},showError:function(e){this.$error.text(e),this.$error.show()},render:function(){var e=this;n.load("PoE/Widget/Guild/AccountTransaction.hbt").done((function(t){var n=e.model.toJSON();e.$el.html(t(n)),e.$el.removeClass().addClass("transaction").addClass(e.model.get("status")),e.$cancelButton=e.$el.find("button.cancel"),e.$error=e.$el.find(".error")}))}})})),define("text!PoE/Widget/Guild/Guild.hbt",[],(function(){return'<div class="left balance">\r\n    <h2>{{translate "Guild Balance"}}</h2>\r\n    <div class="points" title="Guild Points">{{guild.points}}</div>\r\n</div>'})),define("PoE/Widget/Guild/Guild",["require","Backbone","jquery","PoE/Handlebars/TemplateCollection","text!PoE/Widget/Guild/Guild.hbt"],(function(e){var t=e("Backbone"),n=(e("jquery"),e("PoE/Handlebars/TemplateCollection"));return e("text!PoE/Widget/Guild/Guild.hbt"),t.View.extend({initialize:function(){var e=this;this.$el.addClass("guild"),this.model.on("change",(function(){e.render()}))},render:function(){var e=this;n.load("PoE/Widget/Guild/Guild.hbt").done((function(t){var n={guild:e.model.toJSON(),identifyingMember:e.options.identifyingMember.toJSON()};e.$el.html(t(n))}))}})})),define("text!PoE/Widget/Guild/MemberPanel.hbt",[],(function(){return'<div class="frame">\r\n    <div class="background"></div>\r\n    <div class="top"></div>\r\n    <div class="bottom"></div>\r\n    <div class="content">\r\n        <div class="guild"></div>\r\n    </div>\r\n</div>\r\n<div class="memberPanel">\r\n    <div class="frame">\r\n        <div class="background"></div>\r\n        <div class="top"></div>\r\n        <div class="bottom"></div>\r\n        <div class="content">\r\n            <div class="createTransaction">\r\n                <h2>{{translate "Give Microtransaction Points to Guild"}}</h2>\r\n                <p>{{translate "Use this form to send points to your Guild to allow your Guild Leader to purchase Microtransactions. If the Guild Leader accepts your points you can not be kicked out for three months."}}</p>\r\n                <div class="formT1">\r\n                    <div class="row points">\r\n                        <label for="points">{{translate "Points Amount"}}:</label>\r\n                        <div class="element">\r\n                            <input type="text" name="points" class="points">\r\n                            <ul></ul>\r\n                            <div class="success message"></div>\r\n                        </div>\r\n                    </div>\r\n                    <div class="row"><div class="element"><button class="createTransaction button1 important">{{translate "Give Points"}}</button></div></div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="frame">\r\n        <div class="background"></div>\r\n        <div class="top"></div>\r\n        <div class="bottom"></div>\r\n        <div class="content">\r\n            <div class="currentTransactions">\r\n                <h2>{{translate "Transaction History"}}</h2>\r\n                <div class="entries"></div>\r\n                <div class="pagination"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'})),define("PoE/Widget/Guild/MemberPanel",["require","Backbone","jquery","PoE/Handlebars/TemplateCollection","PoE/Model/Account/Guild/PointsTransaction","PoE/Model/Account/Guild/Guild","PoE/Collection/Account/Guild/PointTransactions","PoE/View/Widget/Pagination","./AccountTransaction","./Guild","PoE/API/Error","PoE/Loader","PoE/Helpers","text!PoE/Widget/Guild/MemberPanel.hbt"],(function(e){var t=e("Backbone"),n=e("jquery"),i=e("PoE/Handlebars/TemplateCollection"),o=e("PoE/Model/Account/Guild/PointsTransaction"),r=(e("PoE/Model/Account/Guild/Guild"),e("PoE/Collection/Account/Guild/PointTransactions")),a=e("PoE/View/Widget/Pagination"),s=e("./AccountTransaction"),l=e("./Guild"),c=e("PoE/API/Error"),d=e("PoE/Loader"),u=e("PoE/Helpers");return e("text!PoE/Widget/Guild/MemberPanel.hbt"),t.View.extend({initialize:function(){var e=this;this.accountTransactions=new r,this.fetchAccountTransactions(),this.accountTransactionsPagination=new a({collection:this.accountTransactions}),this.accountTransactions.on("reset",(function(){e.addAccountTransactions()})),this.guildView=new l({model:this.model,identifyingMember:this.options.identifyingMember}),this.guildView.render()},events:{"click button.createTransaction":"create"},transactionCompleted:function(){d.start(),this.model.fetch().always((function(){d.done()}))},fetchAccountTransactions:function(){var e=this;this.accountTransactions.fetch().done((function(){e.addAccountTransactions()}))},create:function(){var e=parseInt(n.trim(this.$points.val()),10),t=this;if(isNaN(e))this.showPointsError(u.translate("Amount is not a number"));else if(e<=0)this.showPointsError(u.translate("Amount must be greater than 0"));else if(confirm(u.translate("Transfer")+" "+e+" "+u.translate("point"+(e>1?"s":"")+" to your guild")+"?")){this.clearPointsError(),this.$createButton.attr("disabled",!0);var i=new o({points:e});d.start(),i.save().then((function(){t.fetchAccountTransactions(),t.showSuccessMessage(u.translate("Transaction created"))}),(function(e){var n=c.fromResponse(e);t.showPointsError(n.getMessage())})).always((function(){d.done(),t.$createButton.removeAttr("disabled")}))}},showSuccessMessage:function(e){var t=this;this.$successMessage.text(e),this.successTimeout&&clearTimeout(this.successTimeout),this.successTimeout=setTimeout((function(){t.$successMessage.hide()}),2e4)},showPointsError:function(e){this.clearPointsError(),this.$pointsRow.addClass("error");var t=n("<li></li>").text(e);this.$pointsErrors.append(t)},clearPointsError:function(){this.$pointsRow.removeClass("error"),this.$pointsErrors.empty()},addAccountTransactions:function(){var e=this;this.$accountTransactions&&(this.$accountTransactions.empty(),this.accountTransactions.each((function(t){var n=new s({model:t});n.render(),e.$accountTransactions.append(n.el)})))},render:function(){var e=this;i.load("PoE/Widget/Guild/MemberPanel.hbt").done((function(t){var n={identifyingMember:e.options.identifyingMember.toJSON()};e.$el.html(t(n)),e.accountTransactionsPagination.render(),e.$el.find(".memberPanel .pagination").replaceWith(e.accountTransactionsPagination.el),e.accountTransactionsPagination.delegateEvents(),e.$accountTransactions=e.$el.find(".memberPanel .entries"),e.addAccountTransactions(),e.$pointsRow=e.$el.find(".createTransaction .row.points"),e.$points=e.$pointsRow.find("input.points"),e.$pointsErrors=e.$pointsRow.find("ul"),e.$createButton=e.$el.find("button.createTransaction"),e.$successMessage=e.$el.find(".success.message"),e.$el.find(".guild").replaceWith(e.guildView.el),e.guildView.delegateEvents(),e.delegateEvents()}))}})})),define("PoE/Model/Guild/PointsTransaction",["Backbone"],(function(e){return e.RelationalModel.extend({url:"/api/guild/point-transactions",relations:[]})})),define("PoE/Collection/Guild/PointTransactions",["require","jquery","Backbone","PoE/Backbone/Paginator","PoE/Model/Guild/PointsTransaction"],(function(e){e("jquery"),e("Backbone");var t=e("PoE/Backbone/Paginator"),n=e("PoE/Model/Guild/PointsTransaction");return t.extend({model:n,paginator_core:{url:"/api/guild/point-transactions",dataType:"json"},paginator_ui:{firstPage:1,currentPage:1,perPage:5,totalPages:10},server_api:{offset:function(){return(this.currentPage-1)*this.perPage},limit:function(){return this.perPage}},perPageOptions:[5,20,50,100],parse:function(e){return e.limit&&(this.perPage=parseInt(e.limit,10)),this.totalRecords=e.total,this.totalPages=Math.ceil(e.total/this.perPage),e.entries}})})),define("text!PoE/Widget/Guild/GuildTransaction.hbt",[],(function(){return'<div class="txInfo">\r\n    <div class="left">\r\n        <span class="points">{{points}}<span class="pointsIcon" title="Points"></span></span>\r\n        {{#if manual}}\r\n        {{translate "Manual transfer"}}\r\n        {{else}}\r\n        {{translate "from"}} {{#if account}} {{profileLink account}} {{else}} {{translate "Deleted"}} {{/if}}\r\n        {{/if}}\r\n    </div>\r\n    <div class="createdAt">{{moment createdAt format="MMMM Do YYYY, h:mm:ss a"}}</div>\r\n</div>\r\n{{#ifCond status "===" "new"}}\r\n    <div class="menu">\r\n        <button class="accept button1 important">{{translate "Accept"}}</button>\r\n        <button class="reject button1 important">{{translate "Reject"}}</button>\r\n    </div>\r\n{{else}}\r\n    <div class="status">\r\n        {{#ifCond status "===" "cancelled"}}{{translate "Cancelled"}}{{/ifCond}}\r\n        {{#ifCond status "===" "rejected"}}{{translate "Rejected"}}{{/ifCond}}\r\n        {{#ifCond status "===" "complete"}}{{translate "Complete"}}{{/ifCond}}\r\n    </div>\r\n{{/ifCond}}\r\n<div class="error"></div>'})),define("PoE/Widget/Guild/GuildTransaction",["require","Backbone","jquery","PoE/Handlebars/TemplateCollection","PoE/Model/Account/Guild/PointsTransaction","PoE/Loader","PoE/API/Error","PoE/Helpers","text!PoE/Widget/Guild/GuildTransaction.hbt"],(function(e){var t=e("Backbone"),n=(e("jquery"),e("PoE/Handlebars/TemplateCollection")),i=(e("PoE/Model/Account/Guild/PointsTransaction"),e("PoE/Loader")),o=e("PoE/API/Error"),r=e("PoE/Helpers");return e("text!PoE/Widget/Guild/GuildTransaction.hbt"),t.View.extend({initialize:function(){},events:{"click button.accept":"accept","click button.reject":"reject"},startAction:function(){i.start(),this.disableButtons(),this.clearError()},endAction:function(){i.done(),this.enableButtons()},accept:function(){var e=this;confirm(r.translate("Accept transaction?"))&&(this.startAction(),this.model.save({method:"accept"},{type:"post",success:function(){e.render(),e.trigger("transactionComplete")},error:function(t,n){var i=o.fromResponse(n);e.showError(i.getMessage())}}).always((function(){e.endAction()})))},reject:function(){var e=this;confirm(r.translate("Reject transaction?"))&&(this.startAction(),this.model.save({method:"reject"},{type:"post",success:function(){e.render()},error:function(t,n){var i=o.fromResponse(n);e.showError(i.getMessage())}}).always((function(){e.endAction()})))},clearError:function(){this.$error.hide()},showError:function(e){this.$error.text(e),this.$error.show()},disableButtons:function(){this.$acceptButton.attr("disabled",!0),this.$rejectButton.attr("disabled",!0)},enableButtons:function(){this.$acceptButton.removeAttr("disabled"),this.$rejectButton.removeAttr("disabled")},render:function(){var e=this;n.load("PoE/Widget/Guild/GuildTransaction.hbt").done((function(t){var n=e.model.toJSON();e.$el.html(t(n)),e.$el.removeClass().addClass("transaction").addClass(e.model.get("status")),e.$acceptButton=e.$el.find("button.accept"),e.$rejectButton=e.$el.find("button.reject"),e.$error=e.$el.find(".error")}))}})})),define("text!PoE/Widget/Guild/LeaderPanel.hbt",[],(function(){return'<div class="frame">\r\n    <div class="background"></div>\r\n    <div class="top"></div>\r\n    <div class="bottom"></div>\r\n    <div class="content">\r\n        <div class="guild"></div>\r\n    </div>\r\n</div>\r\n<div class="frame">\r\n    <div class="background"></div>\r\n    <div class="top"></div>\r\n    <div class="bottom"></div>\r\n    <div class="content">\r\n        <div class="leaderPanel">\r\n            <div class="transactions">\r\n                <h2>{{translate "Guild Transactions"}}</h2>\r\n                <p>{{translate "This is a list of points transfers from members of your Guild. Accept transactions to credit the points to your Guild. You will not be able to kick a player for three months if you accept their points."}}</p>\r\n                <div class="entries"></div>\r\n                <div class="pagination"></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'})),define("PoE/Widget/Guild/LeaderPanel",["require","Backbone","jquery","PoE/Handlebars/TemplateCollection","PoE/Model/Account/Guild/PointsTransaction","PoE/Model/Account/Guild/Guild","PoE/Collection/Guild/PointTransactions","PoE/View/Widget/Pagination","./GuildTransaction","./Guild","PoE/API/Error","PoE/Loader","text!PoE/Widget/Guild/LeaderPanel.hbt"],(function(e){var t=e("Backbone"),n=e("jquery"),i=e("PoE/Handlebars/TemplateCollection"),o=(e("PoE/Model/Account/Guild/PointsTransaction"),e("PoE/Model/Account/Guild/Guild"),e("PoE/Collection/Guild/PointTransactions")),r=e("PoE/View/Widget/Pagination"),a=e("./GuildTransaction"),s=e("./Guild"),l=(e("PoE/API/Error"),e("PoE/Loader"));return e("text!PoE/Widget/Guild/LeaderPanel.hbt"),t.View.extend({initialize:function(){var e=this;"Leader"===this.options.identifyingMember.get("type")&&(this.guildTransactions=new o,this.fetchGuildTransactions(),this.guildTransactionsPagination=new r({collection:this.guildTransactions}),this.guildTransactions.on("reset",(function(){e.addGuildTransactions()}))),this.guildView=new s({model:this.model,identifyingMember:this.options.identifyingMember}),this.guildView.render()},events:{},transactionCompleted:function(){l.start(),this.model.fetch().always((function(){l.done()}))},fetchGuildTransactions:function(){var e=this;"Leader"===this.options.identifyingMember.get("type")&&this.guildTransactions.fetch().done((function(){e.addGuildTransactions()}))},showPointsError:function(e){this.clearPointsError(),this.$pointsRow.addClass("error");var t=n("<li></li>").text(e);this.$pointsErrors.append(t)},clearPointsError:function(){this.$pointsRow.removeClass("error"),this.$pointsErrors.empty()},addGuildTransactions:function(){var e=this;this.$guildTransactions.empty(),this.guildTransactions.each((function(t){var n=new a({model:t});n.on("transactionComplete",(function(){e.transactionCompleted()})),n.render(),e.$guildTransactions.append(n.el)}))},render:function(){var e=this;i.load("PoE/Widget/Guild/LeaderPanel.hbt").done((function(t){var n={identifyingMember:e.options.identifyingMember.toJSON()};e.$el.html(t(n)),"Leader"===e.options.identifyingMember.get("type")&&(e.guildTransactionsPagination.render(),e.$el.find(".leaderPanel .pagination").replaceWith(e.guildTransactionsPagination.el),e.guildTransactionsPagination.delegateEvents(),e.$guildTransactions=e.$el.find(".leaderPanel .entries"),e.addGuildTransactions()),e.$el.find(".guild").replaceWith(e.guildView.el),e.guildView.delegateEvents(),e.delegateEvents()}))}})})),define("text!PoE/Widget/Guild/AccreditedTransaction.hbt",[],(function(){return'<div class="txInfo">\r\n    <div class="left">\r\n        <p class="accredit-txn">{{name}} {{#if packName}}({{packName}}){{/if}}</p>\r\n    </div>\r\n</div>\r\n{{#if childTransaction}}\r\n<div class="txInfo">\r\n    <div class="left">\r\n        <p class="accredit-txn">&nbsp;&nbsp;\r\n            {{#if childTransaction.isSuccess}}<span class="success">{{translate "Success"}}</span>{{/if}}\r\n            {{#if childTransaction.isFailedBackend}}<span class="error">{{translate "Failed"}}</span>{{/if}}\r\n            &nbsp;<span class="mtx-name">{{childTransaction.itemName}}</span>\r\n        </p>\r\n    </div>\r\n    <div class="createdAt">{{moment childTransaction.createdAt format="MMMM Do YYYY, h:mm:ss a"}}</div>\r\n</div>\r\n{{/if}}\r\n<div class="error"></div>'})),define("PoE/Widget/Guild/AccreditedTransaction",["require","Backbone","jquery","PoE/Handlebars/TemplateCollection","text!PoE/Widget/Guild/AccreditedTransaction.hbt"],(function(e){var t=e("Backbone"),n=(e("jquery"),e("PoE/Handlebars/TemplateCollection"));return e("text!PoE/Widget/Guild/AccreditedTransaction.hbt"),t.View.extend({initialize:function(){},events:{},render:function(){var e=this;n.load("PoE/Widget/Guild/AccreditedTransaction.hbt").done((function(t){var n=e.model.toJSON();e.$el.html(t(n)),e.$el.removeClass().addClass("transaction").addClass(e.model.get("status"))}))}})})),define("text!PoE/Widget/Guild/AccreditableTransaction.hbt",[],(function(){return'<div class="txInfo">\r\n    <div class="left">\r\n        <p class="accredit-txn"><span class="mtx-name">{{name}}</span> {{#if packName}}({{packName}}){{/if}}</p>\r\n    </div>\r\n    <div class="createdAt">{{moment createdAt format="MMMM Do YYYY, h:mm:ss a"}}</div>\r\n</div>\r\n<div class="menu">\r\n    <button class="accredit button1 important">{{translate "Gift to guild"}}</button>\r\n</div>\r\n<div class="error"></div>'})),define("PoE/Widget/Guild/AccreditableTransaction",["require","Backbone","jquery","PoE/Handlebars/TemplateCollection","PoE/Loader","PoE/API/Error","PoE/Helpers","text!PoE/Widget/Guild/AccreditableTransaction.hbt"],(function(e){var t=e("Backbone"),n=e("jquery"),i=e("PoE/Handlebars/TemplateCollection"),o=e("PoE/Loader"),r=e("PoE/API/Error"),a=e("PoE/Helpers");return e("text!PoE/Widget/Guild/AccreditableTransaction.hbt"),t.View.extend({initialize:function(){},events:{"click button.accredit":"accredit"},startAction:function(){o.start(),this.$accreditButton.attr("disabled",!0),this.clearError()},endAction:function(){o.done(),this.$accreditButton.attr("disabled")},clearError:function(){this.$error.hide()},showError:function(e){this.$error.text(e),this.$error.show()},accredit:function(){var e=this;confirm(a.translate("Gift {NAME} to your Guild? This can only be done once per transaction.",{"{NAME}":e.model.get("name")}))&&(this.startAction(),n.ajax({url:"/api/guild/accreditable-transactions",type:"POST",dataType:"json",data:JSON.stringify(e.model),contentType:"application/json",success:function(t){e.trigger("transactionComplete")},error:function(t){var n=r.fromResponse(t);e.showError(n.getMessage())},complete:function(){e.endAction()}}))},render:function(){var e=this;i.load("PoE/Widget/Guild/AccreditableTransaction.hbt").done((function(t){var n=e.model.toJSON();e.$el.html(t(n)),e.$el.removeClass().addClass("transaction").addClass(e.model.get("status")),e.$accreditButton=e.$el.find("button.accredit"),e.$error=e.$el.find(".error")}))}})})),define("text!PoE/Widget/Guild/AccreditTransactionsPanel.hbt",[],(function(){return'<div class="frame">\r\n    <div class="background"></div>\r\n    <div class="top"></div>\r\n    <div class="bottom"></div>\r\n    <div class="content">\r\n        <div class="guild"></div>\r\n    </div>\r\n</div>\r\n<div class="frame">\r\n    <div class="background"></div>\r\n    <div class="top"></div>\r\n    <div class="bottom"></div>\r\n    <div class="content">\r\n        <div class="leaderPanel">\r\n            <div class="transactions accreditable">\r\n                <h2>{{translate "Guild-giftable Transactions"}}</h2>\r\n                <p>{{translate "Players who received Hideouts or exclusive hideout decorations in their Supporter Packs can gift a guild version of these microtransactions to a guild that they are a leader of. This can only be done once per transaction."}}</p>\r\n                <div class="entries"></div>\r\n                <p class="no-data"></p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="frame">\r\n    <div class="background"></div>\r\n    <div class="top"></div>\r\n    <div class="bottom"></div>\r\n    <div class="content">\r\n        <div class="leaderPanel">\r\n            <div class="transactions accredited">\r\n                <h2>{{translate "Guild-gifting History"}}</h2>\r\n                <div class="entries"></div>\r\n                <p class="no-data"></p>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>'})),define("PoE/Widget/Guild/AccreditTransactionsPanel",["require","Backbone","jquery","PoE/Handlebars/TemplateCollection","PoE/Model/Account/Guild/Guild","./AccreditedTransaction","./AccreditableTransaction","./Guild","PoE/Loader","PoE/Helpers","text!PoE/Widget/Guild/AccreditTransactionsPanel.hbt"],(function(e){var t=e("Backbone"),n=e("jquery"),i=e("PoE/Handlebars/TemplateCollection"),o=(e("PoE/Model/Account/Guild/Guild"),e("./AccreditedTransaction")),r=e("./AccreditableTransaction"),a=e("./Guild"),s=e("PoE/Loader"),l=e("PoE/Helpers").translate("Could not find transactions");return e("text!PoE/Widget/Guild/AccreditTransactionsPanel.hbt"),t.View.extend({initialize:function(){this.isLeader="Leader"===this.options.identifyingMember.get("type"),this.guildView=new a({model:this.model,identifyingMember:this.options.identifyingMember}),this.guildView.render()},events:{},fetchAccreditableTransactions:function(){var e=this;this.isLeader&&(s.start(),this.$accreditableTransactions.empty(),n.ajax({url:"/api/guild/accreditable-transactions",type:"GET",dataType:"json",success:function(n){0!=n.total?n.entries.forEach((function(n){var i=new r({model:new t.Model(n)});i.on("transactionComplete",(function(){e.transactionCompleted()})),i.render(),e.$accreditableTransactions.append(i.el)})):e.$accreditableNoData.append(l)},error:function(){e.$accreditableNoData.append(l)},complete:function(){s.done()}}))},fetchAccreditedTransactions:function(){var e=this;this.isLeader&&(this.$accreditedTransactions.empty(),s.start(),n.ajax({url:"/api/guild/accredited-transactions",type:"GET",dataType:"json",success:function(n){0!=n.total?n.entries.forEach((function(n){var i=new o({model:new t.Model(n)});i.render(),e.$accreditedTransactions.append(i.el)})):e.$accreditedNoData.append(l)},error:function(){e.$accreditedNoData.append(l)},complete:function(){s.done()}}))},transactionCompleted:function(){this.fetchAccreditableTransactions(),this.fetchAccreditedTransactions()},render:function(){var e=this;i.load("PoE/Widget/Guild/AccreditTransactionsPanel.hbt").done((function(t){var n={identifyingMember:e.options.identifyingMember.toJSON(),accreditable:e.accreditable};e.$el.html(t(n)),e.isLeader&&(e.$accreditableTransactions=e.$el.find(".leaderPanel .accreditable .entries"),e.$accreditedTransactions=e.$el.find(".leaderPanel .accredited .entries"),e.$accreditableNoData=e.$el.find(".leaderPanel .accreditable .error"),e.$accreditedNoData=e.$el.find(".leaderPanel .accredited .error"),e.fetchAccreditableTransactions(),e.fetchAccreditedTransactions()),e.$el.find(".guild").replaceWith(e.guildView.el),e.guildView.delegateEvents(),e.delegateEvents()}))}})})),define("PoE/API/Livestream/TwitchTV",["jquery"],(function(e){return{fetch:function(){var t=e.Deferred();return e.ajax({url:"/api/streams",dataType:"json",cache:!0,success:function(e){t.resolve(e)}}),t}}})),define("PoE/Widget/TwitchTV",["jquery","PoE/API/Livestream/TwitchTV"],(function(e,t){var n=function(n,i,o){this.$containerEl=n instanceof e?n:e(n),this.$el=i instanceof e?i:e(i),this.limit=o&&o.limit?o.limit:3;var r=this;t.fetch().done((function(e){r.result=e,r.draw()}))};return n.prototype.draw=function(){if(this.$el.empty(),0!=this.result.streams.length){for(var t=0;t<this.limit&&this.result.streams[t];++t){var n=this.result.streams[t],i=e('<div class="stream"><div><a><img/></a></div><div><a><span class="status"></span></a><div class="info"><div class="nameCont"><a><span class="name"></span></a></div><div class="viewersCont"><a><span class="viewers"></span></a></div></div></div>');i.find("img").attr("src",n.image),i.find("a").attr("href",n.url),i.find(".status").text(n.status),i.find(".name").text(n.name),i.find(".viewers").text(n.viewers+" viewer"+(1==n.viewers?"":"s")),this.$el.append(i)}this.$el.append('<div class="clear"></div>'),this.$containerEl.show()}},n})),define("PoE/Widget/YoutubeModal",["require","jquery","./YoutubeVideo"],(function(e){var t=e("jquery"),n=e("./YoutubeVideo");return function(e){var i=e instanceof t?e:t(e),o=i.find(".video");this.show=function(){if(o.length)new n(o);t.colorbox({inline:!0,href:i,className:"colorBoxTheme1 hideClose"})}}})),define("PoE/Widget/Countdown",["plugins","Backbone"],(function(e,t){return t.View.extend({initialize:function(){},render:function(){var e=this;this.options.secs<=0||(this.$countdown=this.$el.find(".countdown"),this.last=[null,null,null,null,null,null,null],this.$countdown.countdown({until:this.options.secs,layout:'<div class="days">{dn}</div><div class="hours">{hn}</div><div class="minutes">{mn}</div><div class="seconds">{sn}</div>',onExpiry:function(){setTimeout((function(){e.$el.parents(".layoutBox1:first").remove(),e.$el.remove()}),1e4)},onTick:function(t){var n=function(n,i){t[n]!==e.last[n]&&(e.last[n]=t[n],e.$countdown.find(i).addClass("start"),setTimeout((function(){e.$countdown.find(i).addClass("done")}),0),0===t[n]&&".seconds"!=i&&e.$countdown.find(i).addClass("zero"),0===t[3]&&(e.$countdown.find(".days").addClass("zero"),0==t[4]&&(e.$countdown.find(".hours").addClass("zero"),0===t[5]&&(e.$countdown.find(".minutes").addClass("zero"),0===t[6]&&e.$countdown.find(".seconds").addClass("zero")))))};n(6,".seconds"),n(5,".minutes"),n(4,".hours"),n(3,".days")}}))}})})),define("PoE/Widget/R16Label",["Backbone","PoE/Helpers"],(function(e,t){return e.View.extend({initialize:function(e){var t=e.image;this.imageSrc=t},render:function(){"Pacific/Auckland"==window.momentTimezone&&(this.$el.addClass("active"),this.$el.html('<img src="'+this.imageSrc+'" alt="Restricted to persons 16 Years and over." />'))}})})),define("text!PoE/Widget/Season/Reward.hbt",[],(function(){return'<div class="points">{{requiredPoints}}</div>\r\n<div class="itemDest"></div>\r\n<div class="marker"></div>'})),define("PoE/Widget/Season/Reward",["require","plugins","Backbone","Handlebars","PoE/Handlebars/TemplateCollection","PoE/Item/Item","PoE/Backbone/Model/Item/Item","text!PoE/Widget/Season/Reward.hbt"],(function(e){e("plugins");var t=e("Backbone"),n=(e("Handlebars"),e("PoE/Handlebars/TemplateCollection")),i=e("PoE/Item/Item"),o=e("PoE/Backbone/Model/Item/Item");return e("text!PoE/Widget/Season/Reward.hbt"),t.View.extend({initialize:function(){this.$el.addClass("reward"),this.options.last&&this.$el.addClass("last")},initElementRefs:function(){},events:{},render:function(){var e=this;return n.load("PoE/Widget/Season/Reward.hbt").done((function(t){var n=e.model.toJSON();e.$el.html(t(n));var r=e.model.get("item");if(r){var a=new i({enableVerified:!1,enableLeague:!1,model:new o(r)});a.render(),e.$el.find(".itemDest").replaceWith(a.$el)}}))}})})),define("PoE/Model/Season/PlayerInfo",["Backbone"],(function(e){return e.RelationalModel.extend({})})),define("text!PoE/Widget/Season/SeasonInfo.hbt",[],(function(){return'<div class="seasonInfo currentSeasonInfo{{#if small}} small{{/if}}{{#if garena}} garena{{/if}}{{#if region}} {{region}}{{/if}}" id="{{season.htmlId}}">\r\n    <div class="content">\r\n        <h1 class="name">{{season.name}}</h1>\r\n        {{#unless small}}\r\n            {{{season.htmlContent}}}\r\n        {{/unless}}\r\n    </div>\r\n    {{#if season.rewards.length}}\r\n    <div class="pointsBackground"></div>\r\n    <div class="pointsProgress">\r\n        <div class="barContainer"><div class="bar"></div></div>\r\n        <div class="frame"></div>\r\n    </div>\r\n    <div class="playerInfo">\r\n    {{translate "Season Reward Points"}}: {{playerInfo.points}}\r\n    </div>\r\n    {{/if}}\r\n</div>\r\n\r\n{{#if sponsors}}\r\n<div class="sponsors-banner">\r\n    <img src="/image/season/pvp/ProvidedBy.jpg">\r\n    <div class="sponsors">\r\n    {{#each sponsors}}\r\n        <a href="{{link}}" target="_blank"><img src="{{src}}"></a>\r\n    {{/each}}\r\n    </div>\r\n</div>\r\n{{/if}}\r\n{{#if prizesLink}}\r\n<div class="prizes-banner"><a href="{{prizesLink.link}}" target="_blank"><img src="{{prizesLink.src}}"></a></div>\r\n{{/if}}'})),define("PoE/Widget/Season/SeasonInfo",["require","plugins","Backbone","Handlebars","PoE/Handlebars/TemplateCollection","./Reward","PoE/Model/Season/PlayerInfo","text!PoE/Widget/Season/SeasonInfo.hbt"],(function(e){e("plugins");var t=e("Backbone"),n=(e("Handlebars"),e("PoE/Handlebars/TemplateCollection")),i=e("./Reward");return e("PoE/Model/Season/PlayerInfo"),e("text!PoE/Widget/Season/SeasonInfo.hbt"),t.View.extend({initialize:function(){this.playerInfo=this.options.playerInfo||null,this.small=!!this.options.small,this.garena=!!this.options.garena&&this.options.garena,this.region=!!this.options.region&&this.options.region,this.sponsors=this.options.sponsors?this.options.sponsors:[],this.prizesLink=this.options.prizesLink?this.options.prizesLink:null},initElementRefs:function(){this.$bar=this.$el.find(".currentSeasonInfo .pointsProgress .bar"),this.$pointsProgress=this.$el.find(".currentSeasonInfo .pointsProgress")},events:{},render:function(){var e=this;return n.load("PoE/Widget/Season/SeasonInfo.hbt").done((function(t){var n={small:e.small,season:e.model.toJSON(),playerInfo:e.playerInfo?e.playerInfo.toJSON():{points:0},garena:e.garena,region:e.region,sponsors:e.sponsors,prizesLink:e.prizesLink},o=n.playerInfo.points;if(e.$el.html(t(n)),e.initElementRefs(),e.model.get("rewards").length){var r=e.model.get("rewards").first().get("requiredPoints"),a=function(e){return Math.log(e)/Math.log(2)-8*Math.log(r)/Math.log(2)},s=e.model.get("rewards"),l=s.last(),c=l.get("requiredPoints");a(c);s.each((function(t){var n=new i({model:t,last:t===l});e.$pointsProgress.append(n.$el),n.render().done((function(){a(n.model.get("requiredPoints"));var t=n.$el.find(".newItemContainer"),i=n.model.get("itemOffsetX"),r=n.model.get("itemOffsetY");s.length>12&&t.addClass("smaller"),n.$el.css("left",e.getRewardPosition(n.model)-n.$el.width()),o>=n.model.get("requiredPoints")&&n.$el.addClass("achieved"),null!==i&&t.css("right",i),null!==r&&t.css("bottom",r)}))}));for(var d=0,u=0,h=null,p=null,f=Math.min(o,c),v=0,m=s.length;v<m;++v){if(h=s.at(v).get("requiredPoints"),p=e.getRewardPosition(s.at(v)),f>=d&&f<=h){var g=(p-u)*(f-d)/(h-d)+u;e.$bar.css("width",g+"px");break}d=h,u=p}}}))},getRewardPosition:function(e){var t=this.model.get("rewards"),n=t.indexOf(e);return this.$pointsProgress.width()*((n+1)/t.length)}})})),define("text!PoE/Widget/Season/Ladder/Entry.hbt",[],(function(){return'<td class="rank">{{rank}}</td>\r\n<td class="account">\r\n  {{profileLink account}}\r\n</td>\r\n<td class="points">{{points}}</td>\r\n{{#if splitPoints}}\r\n  <td class="standard_points">{{standard_points}}</td>\r\n  <td class="hardcore_points">{{hardcore_points}}</td>\r\n{{/if}}\r\n'})),define("PoE/Widget/Season/Ladder/Entry",["require","plugins","Backbone","Handlebars","PoE/Handlebars/TemplateCollection","text!PoE/Widget/Season/Ladder/Entry.hbt"],(function(e){e("plugins");var t=e("Backbone"),n=(e("Handlebars"),e("PoE/Handlebars/TemplateCollection"));return e("text!PoE/Widget/Season/Ladder/Entry.hbt"),t.View.extend({tagName:"tr",initialize:function(){this.pvp=!!this.options.pvp&&this.options.pvp,this.splitPoints=!!this.options.splitPoints&&this.options.splitPoints},render:function(){var e=this;n.load("PoE/Widget/Season/Ladder/Entry.hbt").done((function(t){var n=e.model.toJSON();n.pvp=e.pvp,n.splitPoints=e.splitPoints,e.$el.html(t(n))}))}})})),define("PoE/Model/Season/Reward",["Backbone","PoE/Backbone/Model/Item/Item"],(function(e,t,n){return e.RelationalModel.extend({relations:[{type:e.HasOne,key:"item",relatedModel:n}]})})),define("PoE/Model/Season/Season",["Backbone","./Reward"],(function(e,t){return e.RelationalModel.extend({urlRoot:"/api/seasons",relations:[{type:e.HasMany,key:"rewards",relatedModel:t}]})})),define("PoE/Collection/Season/Seasons",["require","Backbone","PoE/Model/Season/Season"],(function(e){var t=e("Backbone"),n=e("PoE/Model/Season/Season");return t.Collection.extend({model:n,url:"/api/seasons"})})),define("PoE/Model/Season/LadderEntry",["Backbone","PoE/Model/Account/Account"],(function(e,t){return e.RelationalModel.extend({relations:[{type:e.HasOne,key:"account",relatedModel:t}],initialize:function(){}})})),define("PoE/Collection/Season/LadderEntries",["jquery","Backbone","PoE/Model/Season/LadderEntry","PoE/Backbone/Paginator"],(function(e,t,n,i){return i.extend({model:n,paginator_core:{url:"/api/season-ladders",dataType:"json"},paginator_ui:{firstPage:1,currentPage:1,perPage:5,totalPages:10},server_api:{offset:function(){return(this.currentPage-1)*this.perPage},limit:function(){return this.perPage},id:""},perPageOptions:[5,10,20,50,100],parse:function(e){return e.limit&&(this.perPage=parseInt(e.limit,10)),e.seasonId&&(this.server_api.id=e.seasonId),e.pvpMatchId&&(this.server_api.id=e.pvpMatchId),this.totalRecords=e.total,this.totalPages=Math.ceil(e.total/this.perPage),e.entries}})})),define("text!PoE/Widget/Season/Ladder/Ladder.hbt",[],(function(){return'<h1>{{translate name}}{{#if type}} {{#ifCond type "===" "hardcore"}}{{translate "Hardcore"}}{{/ifCond}}{{#ifCond type "===" "standard"}}{{translate "Standard"}}{{/ifCond}}{{/if}} {{translate "Ladder"}}</h1>\r\n{{#if splitPoints}}\r\n<div class="ladder-types">\r\n    <a href="/events/{{id}}/ladder" class="button1{{#ifCond type "!==" "hardcore"}}{{#ifCond type "!==" "standard"}} buttonActive{{/ifCond}}{{/ifCond}}">{{translate "Overall"}}</a>\r\n    <a href="/events/{{id}}/ladder/standard" class="button1{{#ifCond type "===" "standard"}} buttonActive{{/ifCond}}">{{translate "Standard"}}</a>\r\n    <a href="/events/{{id}}/ladder/hardcore" class="button1{{#ifCond type "===" "hardcore"}} buttonActive{{/ifCond}}">{{translate "Hardcore"}}</a>\r\n</div>\r\n{{/if}}\r\n<div class="loading"></div>\r\n<table>\r\n    <thead>\r\n    <tr>\r\n        <th>{{translate "Rank"}}</th>\r\n        <th>{{translate "Account"}}</th>\r\n        {{#if splitPoints}}\r\n          <th>{{translate "Overall Points"}}</th>\r\n          <th>{{translate "Standard Points"}}\r\n          <th>{{translate "Hardcore Points"}}\r\n        {{else}}\r\n          <th>{{translate "Points"}}</th>\r\n        {{/if}}\r\n    </tr>\r\n    </thead>\r\n    <tbody class="entries"></tbody>\r\n</table>\r\n<div class="pagination"></div>\r\n'})),define("PoE/Widget/Season/Ladder/Ladder",["require","plugins","Backbone","Handlebars","PoE/Handlebars/TemplateCollection","./Entry","PoE/Collection/Season/Seasons","PoE/View/Widget/Pagination","PoE/Collection/Season/LadderEntries","text!PoE/Widget/Season/Ladder/Ladder.hbt"],(function(e){var t=e("plugins"),n=e("Backbone"),i=(e("Handlebars"),e("PoE/Handlebars/TemplateCollection")),o=e("./Entry"),r=(e("PoE/Collection/Season/Seasons"),e("PoE/View/Widget/Pagination"));return e("PoE/Collection/Season/LadderEntries"),e("text!PoE/Widget/Season/Ladder/Ladder.hbt"),n.View.extend({initialize:function(){var e=this;t.Deferred();this.$el.addClass("seasonLadder"),this.pagination=new r({collection:this.collection}),this.season=!!this.options.season&&this.options.season,this.season||console.warn("Failed to load season"),this.garena=!!this.options.garena&&this.options.garena,this.type=!!this.options.type&&this.options.type,this.pvp=!!this.season&&this.season.get("pvp"),this.collection.server_api.id=this.season?this.season.get("id"):null,this.collection.on("change",(function(){e.render()})),this.collection.on("reset",(function(){e.hideLoader(),e.addAll()})),this.pagination.on("loadStart",(function(){e.showLoader()})),this.pagination.on("loadEnd",(function(){e.hideLoader()}))},showLoader:function(){this.$entries.css("opacity",.5),this.$loading.show(),this.$loading.css("top",this.$entries.offset().top-this.$el.offset().top),this.$loading.height(this.$entries.height())},hideLoader:function(){this.$entries.css("opacity",1),this.$loading.hide()},addAll:function(){var e=this;e.$entries.empty(),this.collection.each((function(t){var n=new o({model:t,pvp:e.pvp,splitPoints:e.splitPoints()});n.render(),e.$entries.append(n.$el)}))},splitPoints:function(){return this.season&&("EUPvPSeason1"==this.season.get("id")||"USPvPSeason1"==this.season.get("id"))},render:function(){var e=this;i.load("PoE/Widget/Season/Ladder/Ladder.hbt").done((function(t){var n={id:e.collection.server_api.id,name:e.season?e.season.get("name"):null,garena:e.garena,pvp:e.pvp,type:e.type,splitPoints:e.splitPoints()};e.$el.html(t(n)),e.$entries=e.$el.find(".entries"),e.$loading=e.$el.find(".loading"),e.$loading.hide(),e.addAll(),e.pagination.render(),e.$el.find(".pagination").replaceWith(e.pagination.el),e.pagination.delegateEvents(),e.delegateEvents()}))}})})),define("PoE/Util/Date",["jquery","moment-tz"],(function(e,t){"use strict";return{Countdown:function(n,i,o){n=t.isMoment(n)?1e3*n.unix():n.getTime();var r=e.Deferred(),a=setInterval((function(){o&&o(),(new Date).getTime()>n&&(clearInterval(a),r.resolve())}),1e3);return i&&r.done(i),r.promise()}}})),define("PoE/Model/League/Prize",["Backbone","exports"],(function(e,t){var n=e.RelationalModel.extend({defaults:{claimed:!1}});return t.Prize=n,n})),define("PoE/Collection/League/PrizeCollection",["Backbone","PoE/Model/League/Prize","exports"],(function(e,t,n){var i=e.Collection.extend({model:t});return n.PrizeCollection=i,i})),define("PoE/Model/League/Rule",["Backbone"],(function(e){return e.RelationalModel.extend({initialize:function(){}})})),define("PoE/Model/League/Event",["Backbone","moment-tz","PoE/Util/Date","./Prize","PoE/Collection/League/PrizeCollection","PoE/Model/League/Rule","PoE/Model/League/LadderEntry","PoE/Collection/League/LadderEntries","exports"],(function(e,t,n,i,o,r,a,s,l){var c=e.RelationalModel.extend({relations:[{type:e.HasMany,key:"prizes",relatedModel:i,collectionType:o,reverseRelation:{key:"event",type:e.HasOne}},{type:e.HasMany,key:"rules",relatedModel:r},{type:e.HasMany,key:"ladder",relatedModel:a,collectionType:s,collectionOptions:{}}],initialize:function(){var e=t(),n=this.get("startAt"),i=this.get("endAt"),o=this.get("registerAt");n&&i&&(n=t(this.get("startAt")),(i=t(this.get("endAt"))).diff(e)<0?this.set("complete",!0):(o&&(o=t(o)).diff(e)<0&&this.set("register",!0),n.diff(e)>0?this.set("upcoming",!0):this.set("inProgress",!0))),this.bind("change",this.setTimers),this.bind("change:complete",this.finish);this.setTimers()},setTimers:function(){var e=this;if(this.get("event")&&(this.get("upcoming")?n.Countdown(t(this.get("startAt")),(function(){e.set("upcoming",!1),e.set("inProgress",!0),e.trigger("changeContinue")}),(function(){e.trigger("upcomingTick")})):this.get("inProgress")?n.Countdown(t(this.get("endAt")),(function(){e.set("inProgress",!1),e.set("complete",!0),e.trigger("changeContinue")}),(function(){e.trigger("inProgressTick")})):this.get("complete")&&(this.unset("register"),this.completeTickIntervalId&&clearInterval(this.completeTickIntervalId),this.completeTickIntervalId=setInterval((function(){e.trigger("completeTick")}),1e3)),(this.get("upcoming")||this.get("inProgress"))&&!this.get("register"))){var i=this.get("registerAt");i&&n.Countdown(t(i),(function(){e.set("register",!0),e.trigger("registrationOpen")}))}},finish:function(){this.trigger("eventFinish")}});return l.Event=c,c})),define("text!PoE/Widget/League/EventInfo/EventInfo.hbt",[],(function(){return'<div class="details{{#if showTimer}} hasCountdown{{/if}}">\n    <div class="left">\n        {{#if showTimer}}\n        <div>\n            <div>\n                <span class="startInfo">{{#if upcoming}}{{translate "Starts"}}{{/if}}{{#if inProgress}}{{translate "Started"}}{{/if}}{{#if complete}}{{translate "Started"}}{{/if}}\n                    <span class="startTimeAgo">{{startTimeAgo}}</span>\n                </span>\n                {{translate "at"}}\n                <span class="date">{{startDate}}</span>\n            </div>\n            <div>\n                <span class="endInfo">{{#if upcoming}}{{translate "Ends"}}{{/if}}{{#if inProgress}}{{translate "Ends"}}{{/if}}{{#if complete}}{{translate "Ended"}}{{/if}}\n                    <span class="endTimeAgo">{{endTimeAgo}}</span>\n                </span>\n                {{translate "at"}}\n                <span class="date">{{endDate}}</span>\n            </div>\n            {{#if register}}<div class="registrationOpen">{{translate "Registration open"}}</div>{{/if}}\n        </div>\n        {{/if}}\n\n        {{#if goal}}\n        <div>\n            <h2>{{translate "Goal"}}</h2>\n            <p>{{goal}}</p>\n        </div>\n        {{/if}}\n\n        {{#if rules}}\n        <div class="rules">\n            <h2>{{translate "Rules"}}</h2>\n            {{#each rules}}\n            <ul class="rule">\n               <li><span class="name">{{name}}:</span><span class="ruleDescription">{{description}}</span></li>\n            </ul>\n            {{/each}}\n        </div>\n        {{/if}}\n    </div>\n\n    {{#if showTimer}}\n        {{#if complete}}\n        <div class="finishedMessage">{{translate "League has ended"}}</div>\n        {{else}}\n        <div class="countdownContainer">\n            <div class="countdownDescription">{{#if upcoming}}{{translate "Starts in"}}{{/if}}{{#if inProgress}}{{translate "Ends in"}}{{/if}}</div>\n            <div class="countdown"></div>\n        </div>\n        {{/if}}\n\n    {{/if}}\n</div>\n<div class="clear"></div>\n'})),define("PoE/Widget/League/EventInfo/EventInfo",["plugins","Backbone","PoE/Model/League/Event","Handlebars","moment-tz","PoE/Environment","PoE/Handlebars/TemplateCollection","text!PoE/Widget/League/EventInfo/EventInfo.hbt"],(function(e,t,n,i,o,r,a){return t.View.extend({initialize:function(){this.model.bind("changeContinue",this.render,this),this.model.bind("eventFinish",this.render,this),this.model.bind("registrationOpen",this.render,this),this.startTimeAgoText="",this.endTimeAgoText=""},initElementRefs:function(){this.$startTimeAgo=this.$el.find(".startTimeAgo"),this.$endTimeAgo=this.$el.find(".endTimeAgo"),this.$countdown=this.$el.find(".countdown")},events:{},render:function(){var e=this;return this.$el.html(""),a.load("PoE/Widget/League/EventInfo/EventInfo.hbt").done((function(t){var n=e.model.toJSON(),i=e.model.get("startAt"),r=e.model.get("endAt");i&&(i=o(i),n.startDate=i.format("h:mm a, MMMM Do YYYY G\\MTZ"),n.startTimeAgo=i.fromNow()),r&&(r=o(r),n.endDate=r.format("h:mm a, MMMM Do YYYY G\\MTZ"),n.endTimeAgo=r.fromNow()),n.showTimer=(e.model.get("event")||"pvp"==e.model.get("type")&&!e.model.get("glickoRatings"))&&i&&r,e.$el.empty().html(t(n)),e.model.off("upcomingTick"),e.model.off("inProgressTick"),e.model.off("completeTick"),e.initElementRefs(),n.showTimer&&(e.model.get("upcoming")?e.$countdown.countdown({until:i.toDate()}):e.model.get("inProgress")&&e.$countdown.countdown({until:r.toDate()}),e.model.on("upcomingTick inProgressTick completeTick",(function(){var t=i.fromNow(),n=r.fromNow();t!=e.startTimeAgoText&&(e.$startTimeAgo.text(t),e.startTimeAgoText=t),n!=e.endTimeAgoText&&(e.$endTimeAgo.text(n),e.endTimeAgoText=n)})))}))}})})),define("PoE/Widget/League/Event/Event",["plugins","Backbone","PoE/Model/League/Event","Handlebars","PoE/Environment","PoE/Handlebars/TemplateCollection","PoE/Widget/League/Ladder/Ladder","PoE/Widget/League/EventInfo/EventInfo"],(function(e,t,n,i,o,r,a,s){return t.View.extend({initialize:function(){this.type=this.options.type?this.options.type:"league";var e=!!this.model.get("title")&&this.model.get("title");this.ladder=new a({model:this.model,type:this.type,title:e}),this.eventInfo=new s({model:this.model,type:this.type}),this.$el.attr("class","eventView")},initElementRefs:function(){},events:{},render:function(){this.$el.html('<div class="info"></div><div class="twitch"></div><div class="ladder"></div>'),this.$el.find(".info").replaceWith(this.eventInfo.el),this.$el.find(".ladder").replaceWith(this.ladder.el),this.ladder.render(),this.eventInfo.render()}})})),function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define("lib/xsolla/widget-1.0.7",[],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).XPayStationWidget=e()}}((function(){return function e(t,n,i){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);var c=new Error("Cannot find module '"+a+"'");throw c.code="MODULE_NOT_FOUND",c}var d=n[a]={exports:{}};t[a][0].call(d.exports,(function(e){var n=t[a][1][e];return o(n||e)}),d,d.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t,n){t.exports=function(e,t){var n=t||document;if(n.createStyleSheet){var i=n.createStyleSheet();return i.cssText=e,i.ownerNode}var o=n.getElementsByTagName("head")[0],r=n.createElement("style");return r.type="text/css",r.styleSheet?r.styleSheet.cssText=e:r.appendChild(n.createTextNode(e)),o.appendChild(r),r},t.exports.byUrl=function(e){if(document.createStyleSheet)return document.createStyleSheet(e).ownerNode;var t=document.getElementsByTagName("head")[0],n=document.createElement("link");return n.rel="stylesheet",n.href=e,t.appendChild(n),n}},{}],2:[function(e,t,n){t.exports=e("cssify")},{cssify:1}],3:[function(e,t,n){(function(n){var i=e("jquery"),o=e("lodash"),r=e("./exception"),a=e("./lightbox"),s=e("./childwindow"),l=e("./device");t.exports=function(){function e(){this.config=o.extend({},t),this.eventObject=i({}),this.isInitiated=!1,this.postMessage=null}e.eventTypes={INIT:"init",OPEN:"open",OPEN_WINDOW:"open-window",OPEN_LIGHTBOX:"open-lightbox",LOAD:"load",CLOSE:"close",CLOSE_WINDOW:"close-window",CLOSE_LIGHTBOX:"close-lightbox",STATUS:"status",STATUS_INVOICE:"status-invoice",STATUS_DELIVERING:"status-delivering",STATUS_TROUBLED:"status-troubled",STATUS_DONE:"status-done"};var t={access_token:null,access_data:null,sandbox:!1,lightbox:{},childWindow:{},host:"secure.xsolla.com"},c=".xpaystation-widget";return e.prototype.config={},e.prototype.isInitiated=!1,e.prototype.eventObject=i({}),e.prototype.getPaystationUrl=function(){return this.config.sandbox?"https://sandbox-secure.xsolla.com/paystation2/?":"https://"+this.config.host+"/paystation2/?"},e.prototype.checkConfig=function(){o.isEmpty(this.config.access_token)&&o.isEmpty(this.config.access_data)&&this.throwError("No access token given"),o.isEmpty(this.config.access_data)||o.isPlainObject(this.config.access_data)||this.throwError("Invalid access data format"),o.isEmpty(this.config.host)&&this.throwError("Invalid host")},e.prototype.checkApp=function(){o.isUndefined(this.isInitiated)&&this.throwError("Initialize widget before opening")},e.prototype.throwError=function(e){throw new r(e)},e.prototype.triggerEvent=function(){this.eventObject.trigger.apply(this.eventObject,arguments)},e.prototype.init=function(r){this.isInitiated=!0,this.config=o.extend({},t,r);var a=i(n.document.body);a.off(c),a.on("click"+c,"[data-xpaystation-widget-open]",o.bind((function(){this.open()}),this)),this.triggerEvent(e.eventTypes.INIT)},e.prototype.open=function(){this.checkConfig(),this.checkApp();var t=o.bind((function(t){switch(((t||{}).paymentInfo||{}).status){case"invoice":this.triggerEvent(e.eventTypes.STATUS_INVOICE,t);break;case"delivering":this.triggerEvent(e.eventTypes.STATUS_DELIVERING,t);break;case"troubled":this.triggerEvent(e.eventTypes.STATUS_TROUBLED,t);break;case"done":this.triggerEvent(e.eventTypes.STATUS_DONE,t)}}),this),n={};this.config.access_token?n.access_token=this.config.access_token:n.access_data=JSON.stringify(this.config.access_data);var r=this.getPaystationUrl()+i.param(n);if(this.postMessage=null,(new l).isMobile()){var c=new s;c.on("open",o.bind((function(){this.postMessage=c.getPostMessage(),this.triggerEvent(e.eventTypes.OPEN),this.triggerEvent(e.eventTypes.OPEN_WINDOW)}),this)),c.on("load",o.bind((function(){this.triggerEvent(e.eventTypes.LOAD)}),this)),c.on("close",o.bind((function(){this.triggerEvent(e.eventTypes.CLOSE),this.triggerEvent(e.eventTypes.CLOSE_WINDOW)}),this)),c.on("status",o.bind((function(n,i){this.triggerEvent(e.eventTypes.STATUS,i),t(i)}),this)),c.open(r,this.config.childWindow)}else{var d=new a;d.on("open",o.bind((function(){this.postMessage=d.getPostMessage(),this.triggerEvent(e.eventTypes.OPEN),this.triggerEvent(e.eventTypes.OPEN_LIGHTBOX)}),this)),d.on("load",o.bind((function(){this.triggerEvent(e.eventTypes.LOAD)}),this)),d.on("close",o.bind((function(){this.triggerEvent(e.eventTypes.CLOSE),this.triggerEvent(e.eventTypes.CLOSE_LIGHTBOX)}),this)),d.on("status",o.bind((function(n,i){this.triggerEvent(e.eventTypes.STATUS,i),t(i)}),this)),d.openFrame(r,this.config.lightbox)}},e.prototype.on=function(e,t){o.isFunction(t)&&this.eventObject.on(e,t)},e.prototype.off=function(e,t){this.eventObject.off(e,t)},e.prototype.sendMessage=function(e,t){this.postMessage&&this.postMessage.send.apply(this.postMessage,arguments)},e.prototype.onMessage=function(e,t){this.postMessage&&this.postMessage.on.apply(this.postMessage,arguments)},e}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./childwindow":4,"./device":5,"./exception":6,"./lightbox":7,jquery:"jquery",lodash:"lodash"}],4:[function(e,t,n){(function(n){var i=e("jquery"),o=e("lodash"),r=e("./version"),a=e("./postmessage");t.exports=function(){function e(){this.eventObject=i({}),this.message=null}var t={target:"_blank"};return e.prototype.eventObject=null,e.prototype.childWindow=null,e.prototype.triggerEvent=function(){this.eventObject.trigger.apply(this.eventObject,arguments)},e.prototype.open=function(e,s){s=o.extend({},t,s),this.childWindow&&!this.childWindow.closed&&(this.childWindow.location.href=e);var l=o.bind((function(){this.on("close",o.bind((function(e){d&&n.clearTimeout(d),this.childWindow&&this.childWindow.close(),i(e.target).off(e)}),this)),this.message=new a(this.childWindow),this.message.on("dimensions widget-detection",o.bind((function(e){this.triggerEvent("load"),i(e.target).off(e)}),this)),this.message.on("widget-detection",o.bind((function(){this.message.send("widget-detected",{version:r,childWindowOptions:s})}),this)),this.message.on("status",o.bind((function(e,t){this.triggerEvent("status",t)}),this)),this.on("close",o.bind((function(e){this.message.off(),i(e.target).off(e)}),this))}),this);switch(s.target){case"_self":this.childWindow=n.window,l(),this.childWindow.location.href=e;break;case"_parent":this.childWindow=n.window.parent,l(),this.childWindow.location.href=e;break;default:this.childWindow=n.window.open(e),this.childWindow.focus(),l();var c=o.bind((function(){this.childWindow&&(this.childWindow.closed?this.triggerEvent("close"):d=n.setTimeout(c,100))}),this),d=n.setTimeout(c,100)}this.triggerEvent("open")},e.prototype.close=function(){this.triggerEvent("close")},e.prototype.on=function(){this.eventObject.on.apply(this.eventObject,arguments)},e.prototype.off=function(){this.eventObject.off.apply(this.eventObject,arguments)},e.prototype.getPostMessage=function(){return this.message},e}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./postmessage":8,"./version":12,jquery:"jquery",lodash:"lodash"}],5:[function(e,t,n){var i=e("bowser");t.exports=function(){function e(){}return e.prototype.isMobile=function(){return i.mobile||i.tablet},e}()},{bowser:"bowser"}],6:[function(e,t,n){var i=e("lodash");t.exports=function(e){this.message=e,this.name="XsollaPayStationWidgetException",this.toString=i.bind((function(){return this.name+": "+this.message}),this)}},{lodash:"lodash"}],7:[function(e,t,n){(function(n){var i=e("jquery"),o=e("lodash"),r=e("./version"),a=e("./postmessage");t.exports=function(){function t(){e("./styles/lightbox.scss"),this.eventObject=i({}),this.options=c,this.message=null}var s="xpaystation-widget-lightbox",l=".xpaystation-widget-lightbox",c={width:null,height:"100%",zIndex:1e3,overlayOpacity:".6",overlayBackground:"#000000",contentBackground:"#ffffff",contentMargin:"10px",closeByKeyboard:!0,closeByClick:!0,modal:!1,spinner:"xsolla",spinnerColor:null,spinnerUrl:null,spinnerRotationPeriod:0},d={xsolla:e("./spinners/xsolla.svg"),round:e("./spinners/round.svg"),none:" "},u={height:500,width:600};return t.prototype.triggerEvent=function(){this.eventObject.trigger.apply(this.eventObject,arguments)},t.prototype.measureScrollbar=function(){var e=i(n.document.body),t=i("<div></div>").css({position:"absolute",top:"-9999px",width:"50px",height:"50px",overflow:"scroll"});e.append(t);var o=t.get(0).offsetWidth-t.get(0).clientWidth;return t.remove(),o},t.prototype.openFrame=function(e,t){this.options=o.extend({},this.options,t);var c="custom"===(t=this.options).spinner&&t.spinnerUrl?'<img class="spinner-custom" src="'+encodeURI(t.spinnerUrl)+'" />':d[t.spinner]||o.values(d)[0],h=i(n.document.body),p=i(o.template('<div class="<%-prefix%>"><div class="<%-prefix%>-overlay"></div><div class="<%-prefix%>-content <%-prefix%>-content__hidden"><iframe class="<%-prefix%>-content-iframe" src="<%-url%>" frameborder="0" allowfullscreen></iframe></div><div class="<%-prefix%>-spinner"><%=spinner%></div></div>')({prefix:s,url:e,spinner:c})),f=p.find("."+s+"-overlay"),v=p.find("."+s+"-content"),m=v.find("."+s+"-content-iframe"),g=p.find("."+s+"-spinner"),y={width:"0px",height:"0px"};p.css({zIndex:t.zIndex}),f.css({background:t.overlayBackground,opacity:t.overlayOpacity}),v.css({margin:t.contentMargin,background:t.contentBackground}),t.spinnerColor&&g.find("path").css({fill:t.spinnerColor}),"custom"===t.spinner&&g.find(".spinner-custom").css({"-webkit-animation-duration":t.spinnerRotationPeriod+"s","animation-duration":t.spinnerRotationPeriod+"s"}),t.closeByClick&&f.on("click",o.bind((function(){this.closeFrame()}),this)),h.append(p),t.closeByKeyboard&&h.on("keyup"+l,o.bind((function(e){27==e.which&&this.closeFrame()}),this));var b,w=o.bind((function(){w=o.noop,E(t),v.removeClass(s+"-content__hidden"),this.triggerEvent("load")}),this),x=function(){v.css({top:0,left:0,width:t.width?t.width:y.width,height:t.height?t.height:y.height});var e=p.get(0).clientWidth,n=p.get(0).clientHeight,i=v.outerWidth(!0),o=v.outerHeight(!0),r=i-v.outerWidth(),a=o-v.outerHeight(),s=e-i,l=n-o;0>s?v.width(e-r):v.css("left",Math.round(s/2)),0>l?v.height(n-a):v.css("top",Math.round(l/2))},P=o.bind((function(){if(b=o.object(o.map(["overflow","paddingRight"],(function(e){return[e,h.css(e)]}))),n.window.innerWidth>h.outerWidth(!0)){var e=parseInt(h.css("paddingRight")||0,10);h.css({paddingRight:e+this.measureScrollbar(),overflow:"hidden"})}}),this),E=function(){g.hide()};m.on("load",o.bind((function(e){var o=t.width&&t.height?1e3:3e4;n.setTimeout((function(){w()}),o),i(e.target).off(e)}),this));var C=m.get(0).contentWindow||m.get(0);this.message=new a(C),t.width&&t.height?this.message.on("dimensions",(function(){w()})):this.message.on("dimensions",(function(e,t){t.dimensions&&(y=o.object(o.map(["width","height"],(function(e){return[e,Math.max(u[e]||0,t.dimensions[e]||0)+"px"]}))),x()),w()})),this.message.on("widget-detection",o.bind((function(){this.message.send("widget-detected",{version:r,lightBoxOptions:t})}),this)),this.message.on("widget-close",o.bind((function(){this.closeFrame()}),this)),this.message.on("status",o.bind((function(e,t){this.triggerEvent("status",t)}),this)),i.event.add(n.window,"resize"+l,x),this.on("close",o.bind((function(e){this.message.off(),h.off(l),i.event.remove(n.window,"resize"+l,x),p.remove(),h.css(b||{}),i(e.target).off(e)}),this)),t.width&&t.height&&x(),g.show(),P(),this.triggerEvent("open")},t.prototype.closeFrame=function(){this.options.modal||this.triggerEvent("close")},t.prototype.on=function(){this.eventObject.on.apply(this.eventObject,arguments)},t.prototype.off=function(){this.eventObject.off.apply(this.eventObject,arguments)},t.prototype.getPostMessage=function(){return this.message},t}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./postmessage":8,"./spinners/round.svg":9,"./spinners/xsolla.svg":10,"./styles/lightbox.scss":11,"./version":12,jquery:"jquery",lodash:"lodash"}],8:[function(e,t,n){(function(n){var i=e("jquery"),o=e("lodash");t.exports=function(){function e(e){this.eventObject=i({}),this.linkedWindow=e,n.window.addEventListener&&n.window.addEventListener("message",o.bind((function(e){if(e.source===this.linkedWindow){var t={};if(o.isString(e.data)&&!o.isUndefined(n.JSON))try{t=n.JSON.parse(e.data)}catch(e){}t.command&&this.eventObject.trigger(t.command,t.data)}}),this))}return e.prototype.eventObject=null,e.prototype.linkedWindow=null,e.prototype.send=function(e,t,i){if(o.isUndefined(t)&&(t={}),o.isUndefined(i)&&(i="*"),!this.linkedWindow||o.isUndefined(this.linkedWindow.postMessage)||o.isUndefined(n.window.JSON))return!1;try{this.linkedWindow.postMessage(n.JSON.stringify({data:t,command:e}),i)}catch(e){}return!0},e.prototype.on=function(){this.eventObject.on.apply(this.eventObject,arguments)},e.prototype.off=function(){this.eventObject.off.apply(this.eventObject,arguments)},e}()}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{jquery:"jquery",lodash:"lodash"}],9:[function(e,t,n){t.exports='<svg width="47px" height="47px" class="spinner-round"><path d="M4.7852728,10.4210875 C2.94111664,13.0552197 1.63777109,16.0946106 1.03753956,19.3768556 L5.16638971,19.3768556 C5.6429615,17.187554 6.50125243,15.139164 7.66768899,13.305305 L5.95572428,11.5922705 L4.7852728,10.4210875 L4.7852728,10.4210875 Z M10.4693048,4.74565615 C13.1274873,2.8908061 16.1965976,1.58674648 19.5100161,1 L19.5100161,4.99523934 C17.2710923,5.48797782 15.1803193,6.3808529 13.3166907,7.59482153 L11.6337339,5.91081293 L10.4693048,4.74565615 L10.4693048,4.74565615 Z M42.2426309,36.5388386 C44.1112782,33.8575016 45.4206461,30.7581504 46,27.4117269 L41.9441211,27.4117269 C41.4527945,29.6618926 40.5583692,31.762911 39.3404412,33.6349356 L41.0332347,35.3287869 L42.2425306,36.5388386 L42.2426309,36.5388386 Z M36.5707441,42.2264227 C33.9167773,44.0867967 30.8509793,45.3972842 27.5398693,45.9911616 L27.5398693,41.7960549 C29.7376402,41.3202901 31.7936841,40.4593536 33.6336246,39.287568 L35.3554258,41.0104453 L36.5707441,42.2265231 L36.5707441,42.2264227 Z M4.71179965,36.4731535 C2.86744274,33.8069823 1.57463637,30.7309322 1,27.4118273 L5.16889904,27.4118273 C5.64828128,29.6073559 6.51159087,31.661069 7.68465205,33.4984432 L5.95572428,35.2284515 L4.71179965,36.4731535 L4.71179965,36.4731535 Z M10.3640133,42.180423 C13.0462854,44.0745435 16.1527345,45.40552 19.5101165,46 L19.5101165,41.7821947 C17.2817319,41.2916658 15.2000928,40.4048169 13.3430889,39.1995862 L11.6337339,40.9100094 L10.3640133,42.1805235 L10.3640133,42.180423 Z M42.1688567,10.3557038 C44.0373031,13.0048008 45.357411,16.0674929 45.9626612,19.3768556 L41.9469316,19.3768556 C41.4585158,17.1328164 40.5692095,15.0369202 39.3580065,13.1684109 L41.0335358,11.4918346 L42.168957,10.3557038 L42.1688567,10.3557038 Z M36.4651516,4.69995782 C33.8355754,2.87865336 30.8071162,1.59488179 27.5400701,1.00883836 L27.5400701,4.98117831 C29.7484805,5.45915272 31.8137587,6.3260149 33.6604242,7.50643794 L35.3555262,5.8102766 L36.4651516,4.69995782 L36.4651516,4.69995782 Z" fill="#CCCCCC"></path></svg>'},{}],10:[function(e,t,n){t.exports='<svg class="spinner-xsolla" width="56" height="55"><path class="spinner-xsolla-x" d="M21.03 5.042l-2.112-2.156-3.657 3.695-3.657-3.695-2.112 2.156 3.659 3.673-3.659 3.696 2.112 2.157 3.657-3.697 3.657 3.697 2.112-2.157-3.648-3.696 3.648-3.673z" fill="#F2542D"></path><path class="spinner-xsolla-s" d="M41.232 6.896l2.941-2.974-2.134-2.132-2.92 2.973-.005-.008-2.134 2.135.005.008-.005.005 3.792 3.82-2.915 2.947 2.112 2.156 5.06-5.111-3.798-3.816.001-.001z" fill="#FCCA20"></path><path class="spinner-xsolla-o" d="M48.066 29.159c-1.536 0-2.761 1.263-2.761 2.79 0 1.524 1.226 2.765 2.761 2.765 1.509 0 2.736-1.242 2.736-2.765 0-1.526-1.227-2.79-2.736-2.79m0 8.593c-3.179 0-5.771-2.594-5.771-5.804 0-3.213 2.592-5.808 5.771-5.808 3.155 0 5.745 2.594 5.745 5.808 0 3.21-2.589 5.804-5.745 5.804" fill="#8C3EA4"></path><path class="spinner-xsolla-l" d="M24.389 42.323h2.99v10.437h-2.99v-10.437zm4.334 0h2.989v10.437h-2.989v-10.437z" fill="#B5DC20"></path><path class="spinner-xsolla-a" d="M7.796 31.898l1.404 2.457h-2.835l1.431-2.457h-.001zm-.001-5.757l-6.363 11.102h12.703l-6.341-11.102z" fill="#66CCDA"></path></svg>'},{}],11:[function(e,t,n){t.exports=e("sassify")(".xpaystation-widget-lightbox{position:fixed;top:0;left:0;bottom:0;right:0;width:100%;height:100%;-webkit-animation:xpaystation-widget-lightbox-fadein 0.15s;animation:xpaystation-widget-lightbox-fadein 0.15s}.xpaystation-widget-lightbox-overlay{position:absolute;top:0;left:0;bottom:0;right:0;z-index:1}.xpaystation-widget-lightbox-content{position:relative;top:0;left:0;z-index:3}.xpaystation-widget-lightbox-content__hidden{visibility:hidden;z-index:-1}.xpaystation-widget-lightbox-content-iframe{width:100%;height:100%;border:0;background:transparent}.xpaystation-widget-lightbox-spinner{position:absolute;top:50%;left:50%;display:none;z-index:2;pointer-events:none}.xpaystation-widget-lightbox-spinner .spinner-xsolla{width:56px;height:55px;margin-top:-28px;margin-left:-26px}.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-x,.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-s,.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-o,.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-l,.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-a{-webkit-animation:xpaystation-widget-lightbox-bouncedelay 1s infinite ease-in-out;-webkit-animation-fill-mode:both;animation:xpaystation-widget-lightbox-bouncedelay 1s infinite ease-in-out;animation-fill-mode:both}.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-x{-webkit-animation-delay:0s;animation-delay:0s}.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-s{-webkit-animation-delay:.2s;animation-delay:.2s}.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-o{-webkit-animation-delay:.4s;animation-delay:.4s}.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-l{-webkit-animation-delay:.6s;animation-delay:.6s}.xpaystation-widget-lightbox-spinner .spinner-xsolla .spinner-xsolla-a{-webkit-animation-delay:.8s;animation-delay:.8s}.xpaystation-widget-lightbox-spinner .spinner-round{margin-top:-23px;margin-left:-23px;-webkit-animation:xpaystation-widget-lightbox-spin 3s infinite linear;animation:xpaystation-widget-lightbox-spin 3s infinite linear}.xpaystation-widget-lightbox-spinner .spinner-custom{-webkit-animation:xpaystation-widget-lightbox-spin infinite linear;animation:xpaystation-widget-lightbox-spin infinite linear}@-webkit-keyframes xpaystation-widget-lightbox-bouncedelay{0%,80%,100%{opacity:0}40%{opacity:1}}@keyframes xpaystation-widget-lightbox-bouncedelay{0%,80%,100%{opacity:0}40%{opacity:1}}@-webkit-keyframes xpaystation-widget-lightbox-fadein{from{opacity:0}to{opacity:1}}@keyframes xpaystation-widget-lightbox-fadein{from{opacity:0}to{opacity:1}}@-webkit-keyframes xpaystation-widget-lightbox-spin{from{-webkit-transform:rotate(0deg)}to{-webkit-transform:rotate(360deg)}}@keyframes xpaystation-widget-lightbox-spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}  /*# sourceMappingURL=data:application/json;base64,ewoJInZlcnNpb24iOiAzLAoJImZpbGUiOiAibGlnaHRib3guc2NzcyIsCgkic291cmNlcyI6IFsKCQkibGlnaHRib3guc2NzcyIKCV0sCgkic291cmNlc0NvbnRlbnQiOiBbCgkJIiRsaWdodGJveC1wcmVmaXg6ICd4cGF5c3RhdGlvbi13aWRnZXQtbGlnaHRib3gnO1xuJGxpZ2h0Ym94LWNsYXNzOiAnLicgKyAkbGlnaHRib3gtcHJlZml4O1xuXG4jeyRsaWdodGJveC1jbGFzc30ge1xuICBwb3NpdGlvbjogZml4ZWQ7XG4gIHRvcDogMDtcbiAgbGVmdDogMDtcbiAgYm90dG9tOiAwO1xuICByaWdodDogMDtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbiAgLXdlYmtpdC1hbmltYXRpb246ICN7JGxpZ2h0Ym94LXByZWZpeH0tZmFkZWluIC4xNXM7XG4gIGFuaW1hdGlvbjogI3skbGlnaHRib3gtcHJlZml4fS1mYWRlaW4gLjE1cztcbn1cblxuI3skbGlnaHRib3gtY2xhc3N9LW92ZXJsYXkge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDowO1xuICBsZWZ0OiAwO1xuICBib3R0b206IDA7XG4gIHJpZ2h0OiAwO1xuICB6LWluZGV4OiAxO1xufVxuXG4jeyRsaWdodGJveC1jbGFzc30tY29udGVudCB7XG4gIHBvc2l0aW9uOiByZWxhdGl2ZTtcbiAgdG9wOiAwO1xuICBsZWZ0OiAwO1xuICB6LWluZGV4OiAzO1xufVxuXG4jeyRsaWdodGJveC1jbGFzc30tY29udGVudF9faGlkZGVuIHtcbiAgdmlzaWJpbGl0eTogaGlkZGVuO1xuICB6LWluZGV4OiAtMTtcbn1cblxuI3skbGlnaHRib3gtY2xhc3N9LWNvbnRlbnQtaWZyYW1lIHtcbiAgd2lkdGg6IDEwMCU7XG4gIGhlaWdodDogMTAwJTtcbiAgYm9yZGVyOiAwO1xuICBiYWNrZ3JvdW5kOiB0cmFuc3BhcmVudDtcbn1cblxuI3skbGlnaHRib3gtY2xhc3N9LXNwaW5uZXIge1xuICBwb3NpdGlvbjogYWJzb2x1dGU7XG4gIHRvcDogNTAlO1xuICBsZWZ0OiA1MCU7XG4gIGRpc3BsYXk6IG5vbmU7XG4gIHotaW5kZXg6IDI7XG4gIHBvaW50ZXItZXZlbnRzOiBub25lO1xuXG4gIC5zcGlubmVyLXhzb2xsYSB7XG4gICAgd2lkdGg6IDU2cHg7XG4gICAgaGVpZ2h0OiA1NXB4O1xuICAgIG1hcmdpbjoge1xuICAgICAgdG9wOiAtMjhweDtcbiAgICAgIGxlZnQ6IC0yNnB4O1xuICAgIH1cblxuICAgIC5zcGlubmVyLXhzb2xsYS14LCAuc3Bpbm5lci14c29sbGEtcywgLnNwaW5uZXIteHNvbGxhLW8sIC5zcGlubmVyLXhzb2xsYS1sLCAuc3Bpbm5lci14c29sbGEtYSB7XG4gICAgICAtd2Via2l0LWFuaW1hdGlvbjogI3skbGlnaHRib3gtcHJlZml4fS1ib3VuY2VkZWxheSAxcyBpbmZpbml0ZSBlYXNlLWluLW91dDtcbiAgICAgIC13ZWJraXQtYW5pbWF0aW9uLWZpbGwtbW9kZTogYm90aDtcbiAgICAgIGFuaW1hdGlvbjogI3skbGlnaHRib3gtcHJlZml4fS1ib3VuY2VkZWxheSAxcyBpbmZpbml0ZSBlYXNlLWluLW91dDtcbiAgICAgIGFuaW1hdGlvbi1maWxsLW1vZGU6IGJvdGg7XG4gICAgfVxuXG4gICAgLnNwaW5uZXIteHNvbGxhLXgge1xuICAgICAgLXdlYmtpdC1hbmltYXRpb24tZGVsYXk6IDBzO1xuICAgICAgYW5pbWF0aW9uLWRlbGF5OiAwcztcbiAgICB9XG5cbiAgICAuc3Bpbm5lci14c29sbGEtcyB7XG4gICAgICAtd2Via2l0LWFuaW1hdGlvbi1kZWxheTogLjJzO1xuICAgICAgYW5pbWF0aW9uLWRlbGF5OiAuMnM7XG4gICAgfVxuXG4gICAgLnNwaW5uZXIteHNvbGxhLW8ge1xuICAgICAgLXdlYmtpdC1hbmltYXRpb24tZGVsYXk6IC40cztcbiAgICAgIGFuaW1hdGlvbi1kZWxheTogLjRzO1xuICAgIH1cblxuICAgIC5zcGlubmVyLXhzb2xsYS1sIHtcbiAgICAgIC13ZWJraXQtYW5pbWF0aW9uLWRlbGF5OiAuNnM7XG4gICAgICBhbmltYXRpb24tZGVsYXk6IC42cztcbiAgICB9XG5cbiAgICAuc3Bpbm5lci14c29sbGEtYSB7XG4gICAgICAtd2Via2l0LWFuaW1hdGlvbi1kZWxheTogLjhzO1xuICAgICAgYW5pbWF0aW9uLWRlbGF5OiAuOHM7XG4gICAgfVxuICB9XG5cbiAgLnNwaW5uZXItcm91bmQge1xuICAgIG1hcmdpbjoge1xuICAgICAgdG9wOiAtMjNweDtcbiAgICAgIGxlZnQ6IC0yM3B4O1xuICAgIH1cbiAgICAtd2Via2l0LWFuaW1hdGlvbjogI3skbGlnaHRib3gtcHJlZml4fS1zcGluIDNzIGluZmluaXRlIGxpbmVhcjtcbiAgICBhbmltYXRpb246ICN7JGxpZ2h0Ym94LXByZWZpeH0tc3BpbiAzcyBpbmZpbml0ZSBsaW5lYXI7XG4gIH1cblxuICAuc3Bpbm5lci1jdXN0b20ge1xuICAgIC13ZWJraXQtYW5pbWF0aW9uOiAjeyRsaWdodGJveC1wcmVmaXh9LXNwaW4gaW5maW5pdGUgbGluZWFyO1xuICAgIGFuaW1hdGlvbjogI3skbGlnaHRib3gtcHJlZml4fS1zcGluIGluZmluaXRlIGxpbmVhcjtcbiAgfVxufVxuXG5ALXdlYmtpdC1rZXlmcmFtZXMgI3skbGlnaHRib3gtcHJlZml4fS1ib3VuY2VkZWxheSB7XG4gIDAlLCA4MCUsIDEwMCUgeyBvcGFjaXR5OiAwOyB9XG4gIDQwJSB7IG9wYWNpdHk6IDEgfVxufVxuXG5Aa2V5ZnJhbWVzICN7JGxpZ2h0Ym94LXByZWZpeH0tYm91bmNlZGVsYXkge1xuICAwJSwgODAlLCAxMDAlIHsgb3BhY2l0eTogMDsgfVxuICA0MCUgeyBvcGFjaXR5OiAxOyB9XG59XG5cbkAtd2Via2l0LWtleWZyYW1lcyAjeyRsaWdodGJveC1wcmVmaXh9LWZhZGVpbiB7XG4gIGZyb20geyBvcGFjaXR5OiAwOyB9XG4gIHRvIHsgb3BhY2l0eTogMTsgfVxufVxuXG5Aa2V5ZnJhbWVzICN7JGxpZ2h0Ym94LXByZWZpeH0tZmFkZWluIHtcbiAgZnJvbSB7IG9wYWNpdHk6IDA7IH1cbiAgdG8geyBvcGFjaXR5OiAxOyB9XG59XG5cbkAtd2Via2l0LWtleWZyYW1lcyAjeyRsaWdodGJveC1wcmVmaXh9LXNwaW4ge1xuICBmcm9tIHsgLXdlYmtpdC10cmFuc2Zvcm06IHJvdGF0ZSgwZGVnKTsgfVxuICB0byB7IC13ZWJraXQtdHJhbnNmb3JtOiByb3RhdGUoMzYwZGVnKTsgfVxufVxuXG5Aa2V5ZnJhbWVzICN7JGxpZ2h0Ym94LXByZWZpeH0tc3BpbiB7XG4gIGZyb20geyB0cmFuc2Zvcm06IHJvdGF0ZSgwZGVnKTsgfVxuICB0byB7IHRyYW5zZm9ybTogcm90YXRlKDM2MGRlZyk7IH1cbn1cbiIKCV0sCgkibWFwcGluZ3MiOiAiQUFHQSxBQUFBLDRCQUE0QixBQUE1QixDQUNFLFFBQVEsQ0FBRSxLQUFNLENBQ2hCLEdBQUcsQ0FBRSxDQUFFLENBQ1AsSUFBSSxDQUFFLENBQUUsQ0FDUixNQUFNLENBQUUsQ0FBRSxDQUNWLEtBQUssQ0FBRSxDQUFFLENBQ1QsS0FBSyxDQUFFLElBQUssQ0FDWixNQUFNLENBQUUsSUFBSyxDQUNiLGlCQUFpQixDQUFFLGtDQUEwQixDQUFRLEtBQUksQ0FDekQsU0FBUyxDQUFFLGtDQUEwQixDQUFRLEtBQUksQ0FDbEQsQUFFRCxBQUFBLG9DQUFvQyxBQUFwQyxDQUNFLFFBQVEsQ0FBRSxRQUFTLENBQ25CLEdBQUcsQ0FBQyxDQUFFLENBQ04sSUFBSSxDQUFFLENBQUUsQ0FDUixNQUFNLENBQUUsQ0FBRSxDQUNWLEtBQUssQ0FBRSxDQUFFLENBQ1QsT0FBTyxDQUFFLENBQUUsQ0FDWixBQUVELEFBQUEsb0NBQW9DLEFBQXBDLENBQ0UsUUFBUSxDQUFFLFFBQVMsQ0FDbkIsR0FBRyxDQUFFLENBQUUsQ0FDUCxJQUFJLENBQUUsQ0FBRSxDQUNSLE9BQU8sQ0FBRSxDQUFFLENBQ1osQUFFRCxBQUFBLDRDQUE0QyxBQUE1QyxDQUNFLFVBQVUsQ0FBRSxNQUFPLENBQ25CLE9BQU8sQ0FBRSxFQUFHLENBQ2IsQUFFRCxBQUFBLDJDQUEyQyxBQUEzQyxDQUNFLEtBQUssQ0FBRSxJQUFLLENBQ1osTUFBTSxDQUFFLElBQUssQ0FDYixNQUFNLENBQUUsQ0FBRSxDQUNWLFVBQVUsQ0FBRSxXQUFZLENBQ3pCLEFBRUQsQUFBQSxvQ0FBb0MsQUFBcEMsQ0FDRSxRQUFRLENBQUUsUUFBUyxDQUNuQixHQUFHLENBQUUsR0FBSSxDQUNULElBQUksQ0FBRSxHQUFJLENBQ1YsT0FBTyxDQUFFLElBQUssQ0FDZCxPQUFPLENBQUUsQ0FBRSxDQUNYLGNBQWMsQ0FBRSxJQUFLLENBd0R0QixBQTlERCxBQVFFLG9DQVJrQyxDQVFsQyxlQUFlLEFBQUMsQ0FDZCxLQUFLLENBQUUsSUFBSyxDQUNaLE1BQU0sQ0FBRSxJQUFLLENBQ2IsTUFBTSxBQUFDLENBQUMsQUFDTixHQUFHLENBQUUsS0FBTSxDQURiLE1BQU0sQUFBQyxDQUFDLEFBRU4sSUFBSSxDQUFFLEtBQU0sQ0FrQ2YsQUEvQ0gsQUFnQkksb0NBaEJnQyxDQVFsQyxlQUFlLENBUWIsaUJBQWlCLENBaEJyQixBQWdCdUIsb0NBaEJhLENBUWxDLGVBQWUsQ0FRTSxpQkFBaUIsQ0FoQnhDLEFBZ0IwQyxvQ0FoQk4sQ0FRbEMsZUFBZSxDQVF5QixpQkFBaUIsQ0FoQjNELEFBZ0I2RCxvQ0FoQnpCLENBUWxDLGVBQWUsQ0FRNEMsaUJBQWlCLENBaEI5RSxBQWdCZ0Ysb0NBaEI1QyxDQVFsQyxlQUFlLENBUStELGlCQUFpQixBQUFDLENBQzVGLGlCQUFpQixDQUFFLHVDQUErQixDQUFhLEVBQUUsQ0FBQyxRQUFRLENBQUMsV0FBVyxDQUN0RiwyQkFBMkIsQ0FBRSxJQUFLLENBQ2xDLFNBQVMsQ0FBRSx1Q0FBK0IsQ0FBYSxFQUFFLENBQUMsUUFBUSxDQUFDLFdBQVcsQ0FDOUUsbUJBQW1CLENBQUUsSUFBSyxDQUMzQixBQXJCTCxBQXVCSSxvQ0F2QmdDLENBUWxDLGVBQWUsQ0FlYixpQkFBaUIsQUFBQyxDQUNoQix1QkFBdUIsQ0FBRSxFQUFHLENBQzVCLGVBQWUsQ0FBRSxFQUFHLENBQ3JCLEFBMUJMLEFBNEJJLG9DQTVCZ0MsQ0FRbEMsZUFBZSxDQW9CYixpQkFBaUIsQUFBQyxDQUNoQix1QkFBdUIsQ0FBRSxHQUFJLENBQzdCLGVBQWUsQ0FBRSxHQUFJLENBQ3RCLEFBL0JMLEFBaUNJLG9DQWpDZ0MsQ0FRbEMsZUFBZSxDQXlCYixpQkFBaUIsQUFBQyxDQUNoQix1QkFBdUIsQ0FBRSxHQUFJLENBQzdCLGVBQWUsQ0FBRSxHQUFJLENBQ3RCLEFBcENMLEFBc0NJLG9DQXRDZ0MsQ0FRbEMsZUFBZSxDQThCYixpQkFBaUIsQUFBQyxDQUNoQix1QkFBdUIsQ0FBRSxHQUFJLENBQzdCLGVBQWUsQ0FBRSxHQUFJLENBQ3RCLEFBekNMLEFBMkNJLG9DQTNDZ0MsQ0FRbEMsZUFBZSxDQW1DYixpQkFBaUIsQUFBQyxDQUNoQix1QkFBdUIsQ0FBRSxHQUFJLENBQzdCLGVBQWUsQ0FBRSxHQUFJLENBQ3RCLEFBOUNMLEFBaURFLG9DQWpEa0MsQ0FpRGxDLGNBQWMsQUFBQyxDQUNiLE1BQU0sQUFBQyxDQUFDLEFBQ04sR0FBRyxDQUFFLEtBQU0sQ0FEYixNQUFNLEFBQUMsQ0FBQyxBQUVOLElBQUksQ0FBRSxLQUFNLENBRWQsaUJBQWlCLENBQUUsZ0NBQXdCLENBQU0sRUFBRSxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQ25FLFNBQVMsQ0FBRSxnQ0FBd0IsQ0FBTSxFQUFFLENBQUMsUUFBUSxDQUFDLE1BQU0sQ0FDNUQsQUF4REgsQUEwREUsb0NBMURrQyxDQTBEbEMsZUFBZSxBQUFDLENBQ2QsaUJBQWlCLENBQUUsZ0NBQXdCLENBQU0sUUFBUSxDQUFDLE1BQU0sQ0FDaEUsU0FBUyxDQUFFLGdDQUF3QixDQUFNLFFBQVEsQ0FBQyxNQUFNLENBQ3pELEFBR0gsa0JBQWtCLENBQWxCLHVDQUFrQixDQUNoQixBQUFBLEVBQUUsQ0FBRSxBQUFBLEdBQUcsQ0FBRSxBQUFBLElBQUksQ0FBRyxPQUFPLENBQUUsQ0FBRSxDQUMzQixBQUFBLEdBQUcsQ0FBRyxPQUFPLENBQUUsQ0FBRyxFQUdwQixVQUFVLENBQVYsdUNBQVUsQ0FDUixBQUFBLEVBQUUsQ0FBRSxBQUFBLEdBQUcsQ0FBRSxBQUFBLElBQUksQ0FBRyxPQUFPLENBQUUsQ0FBRSxDQUMzQixBQUFBLEdBQUcsQ0FBRyxPQUFPLENBQUUsQ0FBRSxFQUduQixrQkFBa0IsQ0FBbEIsa0NBQWtCLENBQ2hCLEFBQUEsSUFBSSxDQUFHLE9BQU8sQ0FBRSxDQUFFLENBQ2xCLEFBQUEsRUFBRSxDQUFHLE9BQU8sQ0FBRSxDQUFFLEVBR2xCLFVBQVUsQ0FBVixrQ0FBVSxDQUNSLEFBQUEsSUFBSSxDQUFHLE9BQU8sQ0FBRSxDQUFFLENBQ2xCLEFBQUEsRUFBRSxDQUFHLE9BQU8sQ0FBRSxDQUFFLEVBR2xCLGtCQUFrQixDQUFsQixnQ0FBa0IsQ0FDaEIsQUFBQSxJQUFJLENBQUcsaUJBQWlCLENBQUUsWUFBTSxDQUNoQyxBQUFBLEVBQUUsQ0FBRyxpQkFBaUIsQ0FBRSxjQUFNLEVBR2hDLFVBQVUsQ0FBVixnQ0FBVSxDQUNSLEFBQUEsSUFBSSxDQUFHLFNBQVMsQ0FBRSxZQUFNLENBQ3hCLEFBQUEsRUFBRSxDQUFHLFNBQVMsQ0FBRSxjQUFNIiwKCSJuYW1lcyI6IFtdCn0= */")},{sassify:2}],12:[function(e,t,n){t.exports="1.0.6"},{}],bowser:[function(e,t,n){!function(e,n){void 0!==t&&t.exports?t.exports=n():this[e]=n()}("bowser",(function(){function e(e){function t(t){var n=e.match(t);return n&&n.length>1&&n[1]||""}var n,i=t(/(ipod|iphone|ipad)/i).toLowerCase(),o=!/like android/i.test(e)&&/android/i.test(e),a=/nexus\s*[0-6]\s*/i.test(e),s=!a&&/nexus\s*[0-9]+/i.test(e),l=/CrOS/.test(e),c=/silk/i.test(e),d=/sailfish/i.test(e),u=/tizen/i.test(e),h=/(web|hpw)os/i.test(e),p=/windows phone/i.test(e),f=!p&&/windows/i.test(e),v=!i&&!c&&/macintosh/i.test(e),m=!o&&!d&&!u&&!h&&/linux/i.test(e),g=t(/edge\/(\d+(\.\d+)?)/i),y=t(/version\/(\d+(\.\d+)?)/i),b=/tablet/i.test(e),w=!b&&/[^-]mobi/i.test(e),x=/xbox/i.test(e);/opera|opr|opios/i.test(e)?n={name:"Opera",opera:r,version:y||t(/(?:opera|opr|opios)[\s\/](\d+(\.\d+)?)/i)}:/coast/i.test(e)?n={name:"Opera Coast",coast:r,version:y||t(/(?:coast)[\s\/](\d+(\.\d+)?)/i)}:/yabrowser/i.test(e)?n={name:"Yandex Browser",yandexbrowser:r,version:y||t(/(?:yabrowser)[\s\/](\d+(\.\d+)?)/i)}:/ucbrowser/i.test(e)?n={name:"UC Browser",ucbrowser:r,version:t(/(?:ucbrowser)[\s\/](\d+(?:\.\d+)+)/i)}:/mxios/i.test(e)?n={name:"Maxthon",maxthon:r,version:t(/(?:mxios)[\s\/](\d+(?:\.\d+)+)/i)}:/epiphany/i.test(e)?n={name:"Epiphany",epiphany:r,version:t(/(?:epiphany)[\s\/](\d+(?:\.\d+)+)/i)}:/puffin/i.test(e)?n={name:"Puffin",puffin:r,version:t(/(?:puffin)[\s\/](\d+(?:\.\d+)?)/i)}:/sleipnir/i.test(e)?n={name:"Sleipnir",sleipnir:r,version:t(/(?:sleipnir)[\s\/](\d+(?:\.\d+)+)/i)}:/k-meleon/i.test(e)?n={name:"K-Meleon",kMeleon:r,version:t(/(?:k-meleon)[\s\/](\d+(?:\.\d+)+)/i)}:p?(n={name:"Windows Phone",windowsphone:r},g?(n.msedge=r,n.version=g):(n.msie=r,n.version=t(/iemobile\/(\d+(\.\d+)?)/i))):/msie|trident/i.test(e)?n={name:"Internet Explorer",msie:r,version:t(/(?:msie |rv:)(\d+(\.\d+)?)/i)}:l?n={name:"Chrome",chromeos:r,chromeBook:r,chrome:r,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:/chrome.+? edge/i.test(e)?n={name:"Microsoft Edge",msedge:r,version:g}:/vivaldi/i.test(e)?n={name:"Vivaldi",vivaldi:r,version:t(/vivaldi\/(\d+(\.\d+)?)/i)||y}:d?n={name:"Sailfish",sailfish:r,version:t(/sailfish\s?browser\/(\d+(\.\d+)?)/i)}:/seamonkey\//i.test(e)?n={name:"SeaMonkey",seamonkey:r,version:t(/seamonkey\/(\d+(\.\d+)?)/i)}:/firefox|iceweasel|fxios/i.test(e)?(n={name:"Firefox",firefox:r,version:t(/(?:firefox|iceweasel|fxios)[ \/](\d+(\.\d+)?)/i)},/\((mobile|tablet);[^\)]*rv:[\d\.]+\)/i.test(e)&&(n.firefoxos=r)):c?n={name:"Amazon Silk",silk:r,version:t(/silk\/(\d+(\.\d+)?)/i)}:/phantom/i.test(e)?n={name:"PhantomJS",phantom:r,version:t(/phantomjs\/(\d+(\.\d+)?)/i)}:/slimerjs/i.test(e)?n={name:"SlimerJS",slimer:r,version:t(/slimerjs\/(\d+(\.\d+)?)/i)}:/blackberry|\bbb\d+/i.test(e)||/rim\stablet/i.test(e)?n={name:"BlackBerry",blackberry:r,version:y||t(/blackberry[\d]+\/(\d+(\.\d+)?)/i)}:h?(n={name:"WebOS",webos:r,version:y||t(/w(?:eb)?osbrowser\/(\d+(\.\d+)?)/i)},/touchpad\//i.test(e)&&(n.touchpad=r)):/bada/i.test(e)?n={name:"Bada",bada:r,version:t(/dolfin\/(\d+(\.\d+)?)/i)}:u?n={name:"Tizen",tizen:r,version:t(/(?:tizen\s?)?browser\/(\d+(\.\d+)?)/i)||y}:/qupzilla/i.test(e)?n={name:"QupZilla",qupzilla:r,version:t(/(?:qupzilla)[\s\/](\d+(?:\.\d+)+)/i)||y}:/chromium/i.test(e)?n={name:"Chromium",chromium:r,version:t(/(?:chromium)[\s\/](\d+(?:\.\d+)?)/i)||y}:/chrome|crios|crmo/i.test(e)?n={name:"Chrome",chrome:r,version:t(/(?:chrome|crios|crmo)\/(\d+(\.\d+)?)/i)}:o?n={name:"Android",version:y}:/safari|applewebkit/i.test(e)?(n={name:"Safari",safari:r},y&&(n.version=y)):i?(n={name:"iphone"==i?"iPhone":"ipad"==i?"iPad":"iPod"},y&&(n.version=y)):n=/googlebot/i.test(e)?{name:"Googlebot",googlebot:r,version:t(/googlebot\/(\d+(\.\d+))/i)||y}:{name:t(/^(.*)\/(.*) /),version:function(t){var n=e.match(t);return n&&n.length>1&&n[2]||""}(/^(.*)\/(.*) /)},!n.msedge&&/(apple)?webkit/i.test(e)?(/(apple)?webkit\/537\.36/i.test(e)?(n.name=n.name||"Blink",n.blink=r):(n.name=n.name||"Webkit",n.webkit=r),!n.version&&y&&(n.version=y)):!n.opera&&/gecko\//i.test(e)&&(n.name=n.name||"Gecko",n.gecko=r,n.version=n.version||t(/gecko\/(\d+(\.\d+)?)/i)),n.msedge||!o&&!n.silk?i?(n[i]=r,n.ios=r):v?n.mac=r:x?n.xbox=r:f?n.windows=r:m&&(n.linux=r):n.android=r;var P="";n.windowsphone?P=t(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i):i?P=(P=t(/os (\d+([_\s]\d+)*) like mac os x/i)).replace(/[_\s]/g,"."):o?P=t(/android[ \/-](\d+(\.\d+)*)/i):n.webos?P=t(/(?:web|hpw)os\/(\d+(\.\d+)*)/i):n.blackberry?P=t(/rim\stablet\sos\s(\d+(\.\d+)*)/i):n.bada?P=t(/bada\/(\d+(\.\d+)*)/i):n.tizen&&(P=t(/tizen[\/\s](\d+(\.\d+)*)/i)),P&&(n.osversion=P);var E=P.split(".")[0];return b||s||"ipad"==i||o&&(3==E||E>=4&&!w)||n.silk?n.tablet=r:(w||"iphone"==i||"ipod"==i||o||a||n.blackberry||n.webos||n.bada)&&(n.mobile=r),n.msedge||n.msie&&n.version>=10||n.yandexbrowser&&n.version>=15||n.vivaldi&&n.version>=1||n.chrome&&n.version>=20||n.firefox&&n.version>=20||n.safari&&n.version>=6||n.opera&&n.version>=10||n.ios&&n.osversion&&n.osversion.split(".")[0]>=6||n.blackberry&&n.version>=10.1||n.chromium&&n.version>=20?n.a=r:n.msie&&n.version<10||n.chrome&&n.version<20||n.firefox&&n.version<20||n.safari&&n.version<6||n.opera&&n.version<10||n.ios&&n.osversion&&n.osversion.split(".")[0]<6||n.chromium&&n.version<20?n.c=r:n.x=r,n}function t(e){return e.split(".").length}function n(e,t){var n,i=[];if(Array.prototype.map)return Array.prototype.map.call(e,t);for(n=0;n<e.length;n++)i.push(t(e[n]));return i}function i(e){for(var i=Math.max(t(e[0]),t(e[1])),o=n(e,(function(e){var o=i-t(e);return n((e+=new Array(o+1).join(".0")).split("."),(function(e){return new Array(20-e.length).join("0")+e})).reverse()}));--i>=0;){if(o[0][i]>o[1][i])return 1;if(o[0][i]!==o[1][i])return-1;if(0===i)return 0}}function o(t,n,o){var r=a;"string"==typeof n&&(o=n,n=void 0),void 0===n&&(n=!1),o&&(r=e(o));var s=""+r.version;for(var l in t)if(t.hasOwnProperty(l)&&r[l])return i([s,t[l]])<0;return n}var r=!0,a=e("undefined"!=typeof navigator?navigator.userAgent:"");return a.test=function(e){for(var t=0;t<e.length;++t){var n=e[t];if("string"==typeof n&&n in a)return!0}return!1},a.isUnsupportedBrowser=o,a.compareVersions=i,a.check=function(e,t,n){return!o(e,t,n)},a._detect=e,a}))},{}],jquery:[function(e,t,n){!function(e,n){"object"==typeof t&&"object"==typeof t.exports?t.exports=e.document?n(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return n(e)}:n(e)}("undefined"!=typeof window?window:this,(function(e,t){function n(e){var t="length"in e&&e.length,n=X.type(e);return"function"!==n&&!X.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===n||0===t||"number"==typeof t&&t>0&&t-1 in e))}function i(e,t,n){if(X.isFunction(t))return X.grep(e,(function(e,i){return!!t.call(e,i,e)!==n}));if(t.nodeType)return X.grep(e,(function(e){return e===t!==n}));if("string"==typeof t){if(ne.test(t))return X.filter(t,e,n);t=X.filter(t,e)}return X.grep(e,(function(e){return U.call(t,e)>=0!==n}))}function o(e,t){for(;(e=e[t])&&1!==e.nodeType;);return e}function r(){q.removeEventListener("DOMContentLoaded",r,!1),e.removeEventListener("load",r,!1),X.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=X.expando+a.uid++}function s(e,t,n){var i;if(void 0===n&&1===e.nodeType)if(i="data-"+t.replace(ve,"-$1").toLowerCase(),"string"==typeof(n=e.getAttribute(i))){try{n="true"===n||"false"!==n&&("null"===n?null:+n+""===n?+n:fe.test(n)?X.parseJSON(n):n)}catch(e){}pe.set(e,t,n)}else n=void 0;return n}function l(){return!0}function c(){return!1}function d(){try{return q.activeElement}catch(e){}}function u(e,t){return X.nodeName(e,"table")&&X.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function h(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function p(e){var t=Me.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function f(e,t){for(var n=0,i=e.length;i>n;n++)he.set(e[n],"globalEval",!t||he.get(t[n],"globalEval"))}function v(e,t){var n,i,o,r,a,s,l,c;if(1===t.nodeType){if(he.hasData(e)&&(r=he.access(e),a=he.set(t,r),c=r.events))for(o in delete a.handle,a.events={},c)for(n=0,i=c[o].length;i>n;n++)X.event.add(t,o,c[o][n]);pe.hasData(e)&&(s=pe.access(e),l=X.extend({},s),pe.set(t,l))}}function m(e,t){var n=e.getElementsByTagName?e.getElementsByTagName(t||"*"):e.querySelectorAll?e.querySelectorAll(t||"*"):[];return void 0===t||t&&X.nodeName(e,t)?X.merge([e],n):n}function g(e,t){var n=t.nodeName.toLowerCase();"input"===n&&be.test(e.type)?t.checked=e.checked:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}function y(t,n){var i,o=X(n.createElement(t)).appendTo(n.body),r=e.getDefaultComputedStyle&&(i=e.getDefaultComputedStyle(o[0]))?i.display:X.css(o[0],"display");return o.detach(),r}function b(e){var t=q,n=Oe[e];return n||("none"!==(n=y(e,t))&&n||((t=(_e=(_e||X("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentDocument).write(),t.close(),n=y(e,t),_e.detach()),Oe[e]=n),n}function w(e,t,n){var i,o,r,a,s=e.style;return(n=n||je(e))&&(a=n.getPropertyValue(t)||n[t]),n&&(""!==a||X.contains(e.ownerDocument,e)||(a=X.style(e,t)),Fe.test(a)&&De.test(t)&&(i=s.width,o=s.minWidth,r=s.maxWidth,s.minWidth=s.maxWidth=s.width=a,a=n.width,s.width=i,s.minWidth=o,s.maxWidth=r)),void 0!==a?a+"":a}function x(e,t){return{get:function(){return e()?void delete this.get:(this.get=t).apply(this,arguments)}}}function P(e,t){if(t in e)return t;for(var n=t[0].toUpperCase()+t.slice(1),i=t,o=He.length;o--;)if((t=He[o]+n)in e)return t;return i}function E(e,t,n){var i=Re.exec(t);return i?Math.max(0,i[1]-(n||0))+(i[2]||"px"):t}function C(e,t,n,i,o){for(var r=n===(i?"border":"content")?4:"width"===t?1:0,a=0;4>r;r+=2)"margin"===n&&(a+=X.css(e,n+ge[r],!0,o)),i?("content"===n&&(a-=X.css(e,"padding"+ge[r],!0,o)),"margin"!==n&&(a-=X.css(e,"border"+ge[r]+"Width",!0,o))):(a+=X.css(e,"padding"+ge[r],!0,o),"padding"!==n&&(a+=X.css(e,"border"+ge[r]+"Width",!0,o)));return a}function k(e,t,n){var i=!0,o="width"===t?e.offsetWidth:e.offsetHeight,r=je(e),a="border-box"===X.css(e,"boxSizing",!1,r);if(0>=o||null==o){if((0>(o=w(e,t,r))||null==o)&&(o=e.style[t]),Fe.test(o))return o;i=a&&(G.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+C(e,t,n||(a?"border":"content"),i,r)+"px"}function S(e,t){for(var n,i,o,r=[],a=0,s=e.length;s>a;a++)(i=e[a]).style&&(r[a]=he.get(i,"olddisplay"),n=i.style.display,t?(r[a]||"none"!==n||(i.style.display=""),""===i.style.display&&ye(i)&&(r[a]=he.access(i,"olddisplay",b(i.nodeName)))):(o=ye(i),"none"===n&&o||he.set(i,"olddisplay",o?n:X.css(i,"display"))));for(a=0;s>a;a++)(i=e[a]).style&&(t&&"none"!==i.style.display&&""!==i.style.display||(i.style.display=t?r[a]||"":"none"));return e}function T(e,t,n,i,o){return new T.prototype.init(e,t,n,i,o)}function L(){return setTimeout((function(){Ge=void 0})),Ge=X.now()}function I(e,t){var n,i=0,o={height:e};for(t=t?1:0;4>i;i+=2-t)o["margin"+(n=ge[i])]=o["padding"+n]=e;return t&&(o.opacity=o.width=e),o}function B(e,t,n){for(var i,o=(Je[t]||[]).concat(Je["*"]),r=0,a=o.length;a>r;r++)if(i=o[r].call(n,t,e))return i}function M(e,t,n){var i,o,r=0,a=Ye.length,s=X.Deferred().always((function(){delete l.elem})),l=function(){if(o)return!1;for(var t=Ge||L(),n=Math.max(0,c.startTime+c.duration-t),i=1-(n/c.duration||0),r=0,a=c.tweens.length;a>r;r++)c.tweens[r].run(i);return s.notifyWith(e,[c,i,n]),1>i&&a?n:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:X.extend({},t),opts:X.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Ge||L(),duration:n.duration,tweens:[],createTween:function(t,n){var i=X.Tween(e,c.opts,t,n,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(i),i},stop:function(t){var n=0,i=t?c.tweens.length:0;if(o)return this;for(o=!0;i>n;n++)c.tweens[n].run(1);return t?s.resolveWith(e,[c,t]):s.rejectWith(e,[c,t]),this}}),d=c.props;for(function(e,t){var n,i,o,r,a;for(n in e)if(o=t[i=X.camelCase(n)],r=e[n],X.isArray(r)&&(o=r[1],r=e[n]=r[0]),n!==i&&(e[i]=r,delete e[n]),(a=X.cssHooks[i])&&"expand"in a)for(n in r=a.expand(r),delete e[i],r)n in e||(e[n]=r[n],t[n]=o);else t[i]=o}(d,c.opts.specialEasing);a>r;r++)if(i=Ye[r].call(c,e,d,c.opts))return i;return X.map(d,B,c),X.isFunction(c.opts.start)&&c.opts.start.call(e,c),X.fx.timer(X.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function A(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var i,o=0,r=t.toLowerCase().match(ce)||[];if(X.isFunction(n))for(;i=r[o++];)"+"===i[0]?(i=i.slice(1)||"*",(e[i]=e[i]||[]).unshift(n)):(e[i]=e[i]||[]).push(n)}}function $(e,t,n,i){function o(s){var l;return r[s]=!0,X.each(e[s]||[],(function(e,s){var c=s(t,n,i);return"string"!=typeof c||a||r[c]?a?!(l=c):void 0:(t.dataTypes.unshift(c),o(c),!1)})),l}var r={},a=e===ht;return o(t.dataTypes[0])||!r["*"]&&o("*")}function _(e,t){var n,i,o=X.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:i||(i={}))[n]=t[n]);return i&&X.extend(!0,e,i),e}function O(e,t,n,i){var o;if(X.isArray(t))X.each(t,(function(t,o){n||gt.test(e)?i(e,o):O(e+"["+("object"==typeof o?t:"")+"]",o,n,i)}));else if(n||"object"!==X.type(t))i(e,t);else for(o in t)O(e+"["+o+"]",t[o],n,i)}function D(e){return X.isWindow(e)?e:9===e.nodeType&&e.defaultView}var F=[],j=F.slice,N=F.concat,R=F.push,U=F.indexOf,Q={},W=Q.toString,H=Q.hasOwnProperty,G={},q=e.document,V="2.1.4",X=function(e,t){return new X.fn.init(e,t)},z=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,Y=/^-ms-/,J=/-([\da-z])/gi,Z=function(e,t){return t.toUpperCase()};X.fn=X.prototype={jquery:V,constructor:X,selector:"",length:0,toArray:function(){return j.call(this)},get:function(e){return null!=e?0>e?this[e+this.length]:this[e]:j.call(this)},pushStack:function(e){var t=X.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return X.each(this,e,t)},map:function(e){return this.pushStack(X.map(this,(function(t,n){return e.call(t,n,t)})))},slice:function(){return this.pushStack(j.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:R,sort:F.sort,splice:F.splice},X.extend=X.fn.extend=function(){var e,t,n,i,o,r,a=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof a&&(c=a,a=arguments[s]||{},s++),"object"==typeof a||X.isFunction(a)||(a={}),s===l&&(a=this,s--);l>s;s++)if(null!=(e=arguments[s]))for(t in e)n=a[t],a!==(i=e[t])&&(c&&i&&(X.isPlainObject(i)||(o=X.isArray(i)))?(o?(o=!1,r=n&&X.isArray(n)?n:[]):r=n&&X.isPlainObject(n)?n:{},a[t]=X.extend(c,r,i)):void 0!==i&&(a[t]=i));return a},X.extend({expando:"jQuery"+(V+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===X.type(e)},isArray:Array.isArray,isWindow:function(e){return null!=e&&e===e.window},isNumeric:function(e){return!X.isArray(e)&&e-parseFloat(e)+1>=0},isPlainObject:function(e){return"object"===X.type(e)&&!e.nodeType&&!X.isWindow(e)&&!(e.constructor&&!H.call(e.constructor.prototype,"isPrototypeOf"))},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Q[W.call(e)]||"object":typeof e},globalEval:function(e){var t,n=eval;(e=X.trim(e))&&(1===e.indexOf("use strict")?((t=q.createElement("script")).text=e,q.head.appendChild(t).parentNode.removeChild(t)):n(e))},camelCase:function(e){return e.replace(Y,"ms-").replace(J,Z)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,i){var o=0,r=e.length,a=n(e);if(i){if(a)for(;r>o&&!1!==t.apply(e[o],i);o++);else for(o in e)if(!1===t.apply(e[o],i))break}else if(a)for(;r>o&&!1!==t.call(e[o],o,e[o]);o++);else for(o in e)if(!1===t.call(e[o],o,e[o]))break;return e},trim:function(e){return null==e?"":(e+"").replace(z,"")},makeArray:function(e,t){var i=t||[];return null!=e&&(n(Object(e))?X.merge(i,"string"==typeof e?[e]:e):R.call(i,e)),i},inArray:function(e,t,n){return null==t?-1:U.call(t,e,n)},merge:function(e,t){for(var n=+t.length,i=0,o=e.length;n>i;i++)e[o++]=t[i];return e.length=o,e},grep:function(e,t,n){for(var i=[],o=0,r=e.length,a=!n;r>o;o++)!t(e[o],o)!==a&&i.push(e[o]);return i},map:function(e,t,i){var o,r=0,a=e.length,s=[];if(n(e))for(;a>r;r++)null!=(o=t(e[r],r,i))&&s.push(o);else for(r in e)null!=(o=t(e[r],r,i))&&s.push(o);return N.apply([],s)},guid:1,proxy:function(e,t){var n,i,o;return"string"==typeof t&&(n=e[t],t=e,e=n),X.isFunction(e)?(i=j.call(arguments,2),o=function(){return e.apply(t||this,i.concat(j.call(arguments)))},o.guid=e.guid=e.guid||X.guid++,o):void 0},now:Date.now,support:G}),X.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),(function(e,t){Q["[object "+t+"]"]=t.toLowerCase()}));var K=function(e){function t(e,t,n,i){var o,r,a,s,l,c,u,p,f,v;if((t?t.ownerDocument||t:R)!==A&&M(t),n=n||[],s=(t=t||A).nodeType,"string"!=typeof e||!e||1!==s&&9!==s&&11!==s)return n;if(!i&&_){if(11!==s&&(o=ye.exec(e)))if(a=o[1]){if(9===s){if(!(r=t.getElementById(a))||!r.parentNode)return n;if(r.id===a)return n.push(r),n}else if(t.ownerDocument&&(r=t.ownerDocument.getElementById(a))&&j(t,r)&&r.id===a)return n.push(r),n}else{if(o[2])return Z.apply(n,t.getElementsByTagName(e)),n;if((a=o[3])&&x.getElementsByClassName)return Z.apply(n,t.getElementsByClassName(a)),n}if(x.qsa&&(!O||!O.test(e))){if(p=u=N,f=t,v=1!==s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(c=k(e),(u=t.getAttribute("id"))?p=u.replace(we,"\\$&"):t.setAttribute("id",p),p="[id='"+p+"'] ",l=c.length;l--;)c[l]=p+h(c[l]);f=be.test(e)&&d(t.parentNode)||t,v=c.join(",")}if(v)try{return Z.apply(n,f.querySelectorAll(v)),n}catch(e){}finally{u||t.removeAttribute("id")}}}return T(e.replace(le,"$1"),t,n,i)}function n(){var e=[];return function t(n,i){return e.push(n+" ")>P.cacheLength&&delete t[e.shift()],t[n+" "]=i}}function i(e){return e[N]=!0,e}function o(e){var t=A.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function r(e,t){for(var n=e.split("|"),i=e.length;i--;)P.attrHandle[n[i]]=t}function a(e,t){var n=t&&e,i=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||V)-(~e.sourceIndex||V);if(i)return i;if(n)for(;n=n.nextSibling;)if(n===t)return-1;return e?1:-1}function s(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}function l(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function c(e){return i((function(t){return t=+t,i((function(n,i){for(var o,r=e([],n.length,t),a=r.length;a--;)n[o=r[a]]&&(n[o]=!(i[o]=n[o]))}))}))}function d(e){return e&&void 0!==e.getElementsByTagName&&e}function u(){}function h(e){for(var t=0,n=e.length,i="";n>t;t++)i+=e[t].value;return i}function p(e,t,n){var i=t.dir,o=n&&"parentNode"===i,r=Q++;return t.first?function(t,n,r){for(;t=t[i];)if(1===t.nodeType||o)return e(t,n,r)}:function(t,n,a){var s,l,c=[U,r];if(a){for(;t=t[i];)if((1===t.nodeType||o)&&e(t,n,a))return!0}else for(;t=t[i];)if(1===t.nodeType||o){if((s=(l=t[N]||(t[N]={}))[i])&&s[0]===U&&s[1]===r)return c[2]=s[2];if(l[i]=c,c[2]=e(t,n,a))return!0}}}function f(e){return e.length>1?function(t,n,i){for(var o=e.length;o--;)if(!e[o](t,n,i))return!1;return!0}:e[0]}function v(e,n,i){for(var o=0,r=n.length;r>o;o++)t(e,n[o],i);return i}function m(e,t,n,i,o){for(var r,a=[],s=0,l=e.length,c=null!=t;l>s;s++)(r=e[s])&&(!n||n(r,i,o))&&(a.push(r),c&&t.push(s));return a}function g(e,t,n,o,r,a){return o&&!o[N]&&(o=g(o)),r&&!r[N]&&(r=g(r,a)),i((function(i,a,s,l){var c,d,u,h=[],p=[],f=a.length,g=i||v(t||"*",s.nodeType?[s]:s,[]),y=!e||!i&&t?g:m(g,h,e,s,l),b=n?r||(i?e:f||o)?[]:a:y;if(n&&n(y,b,s,l),o)for(c=m(b,p),o(c,[],s,l),d=c.length;d--;)(u=c[d])&&(b[p[d]]=!(y[p[d]]=u));if(i){if(r||e){if(r){for(c=[],d=b.length;d--;)(u=b[d])&&c.push(y[d]=u);r(null,b=[],c,l)}for(d=b.length;d--;)(u=b[d])&&(c=r?ee(i,u):h[d])>-1&&(i[c]=!(a[c]=u))}}else b=m(b===a?b.splice(f,b.length):b),r?r(null,a,b,l):Z.apply(a,b)}))}function y(e){for(var t,n,i,o=e.length,r=P.relative[e[0].type],a=r||P.relative[" "],s=r?1:0,l=p((function(e){return e===t}),a,!0),c=p((function(e){return ee(t,e)>-1}),a,!0),d=[function(e,n,i){var o=!r&&(i||n!==L)||((t=n).nodeType?l(e,n,i):c(e,n,i));return t=null,o}];o>s;s++)if(n=P.relative[e[s].type])d=[p(f(d),n)];else{if((n=P.filter[e[s].type].apply(null,e[s].matches))[N]){for(i=++s;o>i&&!P.relative[e[i].type];i++);return g(s>1&&f(d),s>1&&h(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(le,"$1"),n,i>s&&y(e.slice(s,i)),o>i&&y(e=e.slice(i)),o>i&&h(e))}d.push(n)}return f(d)}function b(e,n){var o=n.length>0,r=e.length>0,a=function(i,a,s,l,c){var d,u,h,p=0,f="0",v=i&&[],g=[],y=L,b=i||r&&P.find.TAG("*",c),w=U+=null==y?1:Math.random()||.1,x=b.length;for(c&&(L=a!==A&&a);f!==x&&null!=(d=b[f]);f++){if(r&&d){for(u=0;h=e[u++];)if(h(d,a,s)){l.push(d);break}c&&(U=w)}o&&((d=!h&&d)&&p--,i&&v.push(d))}if(p+=f,o&&f!==p){for(u=0;h=n[u++];)h(v,g,a,s);if(i){if(p>0)for(;f--;)v[f]||g[f]||(g[f]=Y.call(l));g=m(g)}Z.apply(l,g),c&&!i&&g.length>0&&p+n.length>1&&t.uniqueSort(l)}return c&&(U=w,L=y),v};return o?i(a):a}var w,x,P,E,C,k,S,T,L,I,B,M,A,$,_,O,D,F,j,N="sizzle"+1*new Date,R=e.document,U=0,Q=0,W=n(),H=n(),G=n(),q=function(e,t){return e===t&&(B=!0),0},V=1<<31,X={}.hasOwnProperty,z=[],Y=z.pop,J=z.push,Z=z.push,K=z.slice,ee=function(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n]===t)return n;return-1},te="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ne="[\\x20\\t\\r\\n\\f]",ie="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",oe=ie.replace("w","w#"),re="\\["+ne+"*("+ie+")(?:"+ne+"*([*^$|!~]?=)"+ne+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+oe+"))|)"+ne+"*\\]",ae=":("+ie+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+re+")*)|.*)\\)|)",se=new RegExp(ne+"+","g"),le=new RegExp("^"+ne+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ne+"+$","g"),ce=new RegExp("^"+ne+"*,"+ne+"*"),de=new RegExp("^"+ne+"*([>+~]|"+ne+")"+ne+"*"),ue=new RegExp("="+ne+"*([^\\]'\"]*?)"+ne+"*\\]","g"),he=new RegExp(ae),pe=new RegExp("^"+oe+"$"),fe={ID:new RegExp("^#("+ie+")"),CLASS:new RegExp("^\\.("+ie+")"),TAG:new RegExp("^("+ie.replace("w","w*")+")"),ATTR:new RegExp("^"+re),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ne+"*(even|odd|(([+-]|)(\\d*)n|)"+ne+"*(?:([+-]|)"+ne+"*(\\d+)|))"+ne+"*\\)|)","i"),bool:new RegExp("^(?:"+te+")$","i"),needsContext:new RegExp("^"+ne+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ne+"*((?:-\\d)?\\d*)"+ne+"*\\)|)(?=[^-]|$)","i")},ve=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,ge=/^[^{]+\{\s*\[native \w/,ye=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,be=/[+~]/,we=/'|\\/g,xe=new RegExp("\\\\([\\da-f]{1,6}"+ne+"?|("+ne+")|.)","ig"),Pe=function(e,t,n){var i="0x"+t-65536;return i!=i||n?t:0>i?String.fromCharCode(i+65536):String.fromCharCode(i>>10|55296,1023&i|56320)},Ee=function(){M()};try{Z.apply(z=K.call(R.childNodes),R.childNodes),z[R.childNodes.length].nodeType}catch(e){Z={apply:z.length?function(e,t){J.apply(e,K.call(t))}:function(e,t){for(var n=e.length,i=0;e[n++]=t[i++];);e.length=n-1}}}for(w in x=t.support={},C=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},M=t.setDocument=function(e){var t,n,i=e?e.ownerDocument||e:R;return i!==A&&9===i.nodeType&&i.documentElement?(A=i,$=i.documentElement,(n=i.defaultView)&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",Ee,!1):n.attachEvent&&n.attachEvent("onunload",Ee)),_=!C(i),x.attributes=o((function(e){return e.className="i",!e.getAttribute("className")})),x.getElementsByTagName=o((function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length})),x.getElementsByClassName=ge.test(i.getElementsByClassName),x.getById=o((function(e){return $.appendChild(e).id=N,!i.getElementsByName||!i.getElementsByName(N).length})),x.getById?(P.find.ID=function(e,t){if(void 0!==t.getElementById&&_){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},P.filter.ID=function(e){var t=e.replace(xe,Pe);return function(e){return e.getAttribute("id")===t}}):(delete P.find.ID,P.filter.ID=function(e){var t=e.replace(xe,Pe);return function(e){var n=void 0!==e.getAttributeNode&&e.getAttributeNode("id");return n&&n.value===t}}),P.find.TAG=x.getElementsByTagName?function(e,t){return void 0!==t.getElementsByTagName?t.getElementsByTagName(e):x.qsa?t.querySelectorAll(e):void 0}:function(e,t){var n,i=[],o=0,r=t.getElementsByTagName(e);if("*"===e){for(;n=r[o++];)1===n.nodeType&&i.push(n);return i}return r},P.find.CLASS=x.getElementsByClassName&&function(e,t){return _?t.getElementsByClassName(e):void 0},D=[],O=[],(x.qsa=ge.test(i.querySelectorAll))&&(o((function(e){$.appendChild(e).innerHTML="<a id='"+N+"'></a><select id='"+N+"-\f]' msallowcapture=''><option selected=''></option></select>",e.querySelectorAll("[msallowcapture^='']").length&&O.push("[*^$]="+ne+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||O.push("\\["+ne+"*(?:value|"+te+")"),e.querySelectorAll("[id~="+N+"-]").length||O.push("~="),e.querySelectorAll(":checked").length||O.push(":checked"),e.querySelectorAll("a#"+N+"+*").length||O.push(".#.+[+~]")})),o((function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&O.push("name"+ne+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||O.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),O.push(",.*:")}))),(x.matchesSelector=ge.test(F=$.matches||$.webkitMatchesSelector||$.mozMatchesSelector||$.oMatchesSelector||$.msMatchesSelector))&&o((function(e){x.disconnectedMatch=F.call(e,"div"),F.call(e,"[s!='']:x"),D.push("!=",ae)})),O=O.length&&new RegExp(O.join("|")),D=D.length&&new RegExp(D.join("|")),t=ge.test($.compareDocumentPosition),j=t||ge.test($.contains)?function(e,t){var n=9===e.nodeType?e.documentElement:e,i=t&&t.parentNode;return e===i||!(!i||1!==i.nodeType||!(n.contains?n.contains(i):e.compareDocumentPosition&&16&e.compareDocumentPosition(i)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},q=t?function(e,t){if(e===t)return B=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!x.sortDetached&&t.compareDocumentPosition(e)===n?e===i||e.ownerDocument===R&&j(R,e)?-1:t===i||t.ownerDocument===R&&j(R,t)?1:I?ee(I,e)-ee(I,t):0:4&n?-1:1)}:function(e,t){if(e===t)return B=!0,0;var n,o=0,r=e.parentNode,s=t.parentNode,l=[e],c=[t];if(!r||!s)return e===i?-1:t===i?1:r?-1:s?1:I?ee(I,e)-ee(I,t):0;if(r===s)return a(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)c.unshift(n);for(;l[o]===c[o];)o++;return o?a(l[o],c[o]):l[o]===R?-1:c[o]===R?1:0},i):A},t.matches=function(e,n){return t(e,null,null,n)},t.matchesSelector=function(e,n){if((e.ownerDocument||e)!==A&&M(e),n=n.replace(ue,"='$1']"),!(!x.matchesSelector||!_||D&&D.test(n)||O&&O.test(n)))try{var i=F.call(e,n);if(i||x.disconnectedMatch||e.document&&11!==e.document.nodeType)return i}catch(e){}return t(n,A,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==A&&M(e),j(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==A&&M(e);var n=P.attrHandle[t.toLowerCase()],i=n&&X.call(P.attrHandle,t.toLowerCase())?n(e,t,!_):void 0;return void 0!==i?i:x.attributes||!_?e.getAttribute(t):(i=e.getAttributeNode(t))&&i.specified?i.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,n=[],i=0,o=0;if(B=!x.detectDuplicates,I=!x.sortStable&&e.slice(0),e.sort(q),B){for(;t=e[o++];)t===e[o]&&(i=n.push(o));for(;i--;)e.splice(n[i],1)}return I=null,e},E=t.getText=function(e){var t,n="",i=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=E(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[i++];)n+=E(t);return n},P=t.selectors={cacheLength:50,createPseudo:i,match:fe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(xe,Pe),e[3]=(e[3]||e[4]||e[5]||"").replace(xe,Pe),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return fe.CHILD.test(e[0])?null:(e[3]?e[2]=e[4]||e[5]||"":n&&he.test(n)&&(t=k(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(xe,Pe).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=W[e+" "];return t||(t=new RegExp("(^|"+ne+")"+e+"("+ne+"|$)"))&&W(e,(function(e){return t.test("string"==typeof e.className&&e.className||void 0!==e.getAttribute&&e.getAttribute("class")||"")}))},ATTR:function(e,n,i){return function(o){var r=t.attr(o,e);return null==r?"!="===n:!n||(r+="","="===n?r===i:"!="===n?r!==i:"^="===n?i&&0===r.indexOf(i):"*="===n?i&&r.indexOf(i)>-1:"$="===n?i&&r.slice(-i.length)===i:"~="===n?(" "+r.replace(se," ")+" ").indexOf(i)>-1:"|="===n&&(r===i||r.slice(0,i.length+1)===i+"-"))}},CHILD:function(e,t,n,i,o){var r="nth"!==e.slice(0,3),a="last"!==e.slice(-4),s="of-type"===t;return 1===i&&0===o?function(e){return!!e.parentNode}:function(t,n,l){var c,d,u,h,p,f,v=r!==a?"nextSibling":"previousSibling",m=t.parentNode,g=s&&t.nodeName.toLowerCase(),y=!l&&!s;if(m){if(r){for(;v;){for(u=t;u=u[v];)if(s?u.nodeName.toLowerCase()===g:1===u.nodeType)return!1;f=v="only"===e&&!f&&"nextSibling"}return!0}if(f=[a?m.firstChild:m.lastChild],a&&y){for(p=(c=(d=m[N]||(m[N]={}))[e]||[])[0]===U&&c[1],h=c[0]===U&&c[2],u=p&&m.childNodes[p];u=++p&&u&&u[v]||(h=p=0)||f.pop();)if(1===u.nodeType&&++h&&u===t){d[e]=[U,p,h];break}}else if(y&&(c=(t[N]||(t[N]={}))[e])&&c[0]===U)h=c[1];else for(;(u=++p&&u&&u[v]||(h=p=0)||f.pop())&&((s?u.nodeName.toLowerCase()!==g:1!==u.nodeType)||!++h||(y&&((u[N]||(u[N]={}))[e]=[U,h]),u!==t)););return(h-=o)===i||h%i==0&&h/i>=0}}},PSEUDO:function(e,n){var o,r=P.pseudos[e]||P.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return r[N]?r(n):r.length>1?(o=[e,e,"",n],P.setFilters.hasOwnProperty(e.toLowerCase())?i((function(e,t){for(var i,o=r(e,n),a=o.length;a--;)e[i=ee(e,o[a])]=!(t[i]=o[a])})):function(e){return r(e,0,o)}):r}},pseudos:{not:i((function(e){var t=[],n=[],o=S(e.replace(le,"$1"));return o[N]?i((function(e,t,n,i){for(var r,a=o(e,null,i,[]),s=e.length;s--;)(r=a[s])&&(e[s]=!(t[s]=r))})):function(e,i,r){return t[0]=e,o(t,null,r,n),t[0]=null,!n.pop()}})),has:i((function(e){return function(n){return t(e,n).length>0}})),contains:i((function(e){return e=e.replace(xe,Pe),function(t){return(t.textContent||t.innerText||E(t)).indexOf(e)>-1}})),lang:i((function(e){return pe.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(xe,Pe).toLowerCase(),function(t){var n;do{if(n=_?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(n=n.toLowerCase())===e||0===n.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}})),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===$},focus:function(e){return e===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!P.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return ve.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:c((function(){return[0]})),last:c((function(e,t){return[t-1]})),eq:c((function(e,t,n){return[0>n?n+t:n]})),even:c((function(e,t){for(var n=0;t>n;n+=2)e.push(n);return e})),odd:c((function(e,t){for(var n=1;t>n;n+=2)e.push(n);return e})),lt:c((function(e,t,n){for(var i=0>n?n+t:n;--i>=0;)e.push(i);return e})),gt:c((function(e,t,n){for(var i=0>n?n+t:n;++i<t;)e.push(i);return e}))}},P.pseudos.nth=P.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})P.pseudos[w]=s(w);for(w in{submit:!0,reset:!0})P.pseudos[w]=l(w);return u.prototype=P.filters=P.pseudos,P.setFilters=new u,k=t.tokenize=function(e,n){var i,o,r,a,s,l,c,d=H[e+" "];if(d)return n?0:d.slice(0);for(s=e,l=[],c=P.preFilter;s;){for(a in(!i||(o=ce.exec(s)))&&(o&&(s=s.slice(o[0].length)||s),l.push(r=[])),i=!1,(o=de.exec(s))&&(i=o.shift(),r.push({value:i,type:o[0].replace(le," ")}),s=s.slice(i.length)),P.filter)!(o=fe[a].exec(s))||c[a]&&!(o=c[a](o))||(i=o.shift(),r.push({value:i,type:a,matches:o}),s=s.slice(i.length));if(!i)break}return n?s.length:s?t.error(e):H(e,l).slice(0)},S=t.compile=function(e,t){var n,i=[],o=[],r=G[e+" "];if(!r){for(t||(t=k(e)),n=t.length;n--;)(r=y(t[n]))[N]?i.push(r):o.push(r);(r=G(e,b(o,i))).selector=e}return r},T=t.select=function(e,t,n,i){var o,r,a,s,l,c="function"==typeof e&&e,u=!i&&k(e=c.selector||e);if(n=n||[],1===u.length){if((r=u[0]=u[0].slice(0)).length>2&&"ID"===(a=r[0]).type&&x.getById&&9===t.nodeType&&_&&P.relative[r[1].type]){if(!(t=(P.find.ID(a.matches[0].replace(xe,Pe),t)||[])[0]))return n;c&&(t=t.parentNode),e=e.slice(r.shift().value.length)}for(o=fe.needsContext.test(e)?0:r.length;o--&&(a=r[o],!P.relative[s=a.type]);)if((l=P.find[s])&&(i=l(a.matches[0].replace(xe,Pe),be.test(r[0].type)&&d(t.parentNode)||t))){if(r.splice(o,1),!(e=i.length&&h(r)))return Z.apply(n,i),n;break}}return(c||S(e,u))(i,t,!_,n,be.test(e)&&d(t.parentNode)||t),n},x.sortStable=N.split("").sort(q).join("")===N,x.detectDuplicates=!!B,M(),x.sortDetached=o((function(e){return 1&e.compareDocumentPosition(A.createElement("div"))})),o((function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")}))||r("type|href|height|width",(function(e,t,n){return n?void 0:e.getAttribute(t,"type"===t.toLowerCase()?1:2)})),x.attributes&&o((function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")}))||r("value",(function(e,t,n){return n||"input"!==e.nodeName.toLowerCase()?void 0:e.defaultValue})),o((function(e){return null==e.getAttribute("disabled")}))||r(te,(function(e,t,n){var i;return n?void 0:!0===e[t]?t.toLowerCase():(i=e.getAttributeNode(t))&&i.specified?i.value:null})),t}(e);X.find=K,X.expr=K.selectors,X.expr[":"]=X.expr.pseudos,X.unique=K.uniqueSort,X.text=K.getText,X.isXMLDoc=K.isXML,X.contains=K.contains;var ee=X.expr.match.needsContext,te=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ne=/^.[^:#\[\.,]*$/;X.filter=function(e,t,n){var i=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===i.nodeType?X.find.matchesSelector(i,e)?[i]:[]:X.find.matches(e,X.grep(t,(function(e){return 1===e.nodeType})))},X.fn.extend({find:function(e){var t,n=this.length,i=[],o=this;if("string"!=typeof e)return this.pushStack(X(e).filter((function(){for(t=0;n>t;t++)if(X.contains(o[t],this))return!0})));for(t=0;n>t;t++)X.find(e,o[t],i);return(i=this.pushStack(n>1?X.unique(i):i)).selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(i(this,e||[],!1))},not:function(e){return this.pushStack(i(this,e||[],!0))},is:function(e){return!!i(this,"string"==typeof e&&ee.test(e)?X(e):e||[],!1).length}});var ie,oe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,re=X.fn.init=function(e,t){var n,i;if(!e)return this;if("string"==typeof e){if(!(n="<"===e[0]&&">"===e[e.length-1]&&e.length>=3?[null,e,null]:oe.exec(e))||!n[1]&&t)return!t||t.jquery?(t||ie).find(e):this.constructor(t).find(e);if(n[1]){if(t=t instanceof X?t[0]:t,X.merge(this,X.parseHTML(n[1],t&&t.nodeType?t.ownerDocument||t:q,!0)),te.test(n[1])&&X.isPlainObject(t))for(n in t)X.isFunction(this[n])?this[n](t[n]):this.attr(n,t[n]);return this}return(i=q.getElementById(n[2]))&&i.parentNode&&(this.length=1,this[0]=i),this.context=q,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):X.isFunction(e)?void 0!==ie.ready?ie.ready(e):e(X):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),X.makeArray(e,this))};re.prototype=X.fn,ie=X(q);var ae=/^(?:parents|prev(?:Until|All))/,se={children:!0,contents:!0,next:!0,prev:!0};X.extend({dir:function(e,t,n){for(var i=[],o=void 0!==n;(e=e[t])&&9!==e.nodeType;)if(1===e.nodeType){if(o&&X(e).is(n))break;i.push(e)}return i},sibling:function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}}),X.fn.extend({has:function(e){var t=X(e,this),n=t.length;return this.filter((function(){for(var e=0;n>e;e++)if(X.contains(this,t[e]))return!0}))},closest:function(e,t){for(var n,i=0,o=this.length,r=[],a=ee.test(e)||"string"!=typeof e?X(e,t||this.context):0;o>i;i++)for(n=this[i];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?a.index(n)>-1:1===n.nodeType&&X.find.matchesSelector(n,e))){r.push(n);break}return this.pushStack(r.length>1?X.unique(r):r)},index:function(e){return e?"string"==typeof e?U.call(X(e),this[0]):U.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(X.unique(X.merge(this.get(),X(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),X.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return X.dir(e,"parentNode")},parentsUntil:function(e,t,n){return X.dir(e,"parentNode",n)},next:function(e){return o(e,"nextSibling")},prev:function(e){return o(e,"previousSibling")},nextAll:function(e){return X.dir(e,"nextSibling")},prevAll:function(e){return X.dir(e,"previousSibling")},nextUntil:function(e,t,n){return X.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return X.dir(e,"previousSibling",n)},siblings:function(e){return X.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return X.sibling(e.firstChild)},contents:function(e){return e.contentDocument||X.merge([],e.childNodes)}},(function(e,t){X.fn[e]=function(n,i){var o=X.map(this,t,n);return"Until"!==e.slice(-5)&&(i=n),i&&"string"==typeof i&&(o=X.filter(i,o)),this.length>1&&(se[e]||X.unique(o),ae.test(e)&&o.reverse()),this.pushStack(o)}}));var le,ce=/\S+/g,de={};X.Callbacks=function(e){e="string"==typeof e?de[e]||function(e){var t=de[e]={};return X.each(e.match(ce)||[],(function(e,n){t[n]=!0})),t}(e):X.extend({},e);var t,n,i,o,r,a,s=[],l=!e.once&&[],c=function(u){for(t=e.memory&&u,n=!0,a=o||0,o=0,r=s.length,i=!0;s&&r>a;a++)if(!1===s[a].apply(u[0],u[1])&&e.stopOnFalse){t=!1;break}i=!1,s&&(l?l.length&&c(l.shift()):t?s=[]:d.disable())},d={add:function(){if(s){var n=s.length;!function t(n){X.each(n,(function(n,i){var o=X.type(i);"function"===o?e.unique&&d.has(i)||s.push(i):i&&i.length&&"string"!==o&&t(i)}))}(arguments),i?r=s.length:t&&(o=n,c(t))}return this},remove:function(){return s&&X.each(arguments,(function(e,t){for(var n;(n=X.inArray(t,s,n))>-1;)s.splice(n,1),i&&(r>=n&&r--,a>=n&&a--)})),this},has:function(e){return e?X.inArray(e,s)>-1:!(!s||!s.length)},empty:function(){return s=[],r=0,this},disable:function(){return s=l=t=void 0,this},disabled:function(){return!s},lock:function(){return l=void 0,t||d.disable(),this},locked:function(){return!l},fireWith:function(e,t){return!s||n&&!l||(t=[e,(t=t||[]).slice?t.slice():t],i?l.push(t):c(t)),this},fire:function(){return d.fireWith(this,arguments),this},fired:function(){return!!n}};return d},X.extend({Deferred:function(e){var t=[["resolve","done",X.Callbacks("once memory"),"resolved"],["reject","fail",X.Callbacks("once memory"),"rejected"],["notify","progress",X.Callbacks("memory")]],n="pending",i={state:function(){return n},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return X.Deferred((function(n){X.each(t,(function(t,r){var a=X.isFunction(e[t])&&e[t];o[r[1]]((function(){var e=a&&a.apply(this,arguments);e&&X.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[r[0]+"With"](this===i?n.promise():this,a?[e]:arguments)}))})),e=null})).promise()},promise:function(e){return null!=e?X.extend(e,i):i}},o={};return i.pipe=i.then,X.each(t,(function(e,r){var a=r[2],s=r[3];i[r[1]]=a.add,s&&a.add((function(){n=s}),t[1^e][2].disable,t[2][2].lock),o[r[0]]=function(){return o[r[0]+"With"](this===o?i:this,arguments),this},o[r[0]+"With"]=a.fireWith})),i.promise(o),e&&e.call(o,o),o},when:function(e){var t,n,i,o=0,r=j.call(arguments),a=r.length,s=1!==a||e&&X.isFunction(e.promise)?a:0,l=1===s?e:X.Deferred(),c=function(e,n,i){return function(o){n[e]=this,i[e]=arguments.length>1?j.call(arguments):o,i===t?l.notifyWith(n,i):--s||l.resolveWith(n,i)}};if(a>1)for(t=new Array(a),n=new Array(a),i=new Array(a);a>o;o++)r[o]&&X.isFunction(r[o].promise)?r[o].promise().done(c(o,i,r)).fail(l.reject).progress(c(o,n,t)):--s;return s||l.resolveWith(i,r),l.promise()}}),X.fn.ready=function(e){return X.ready.promise().done(e),this},X.extend({isReady:!1,readyWait:1,holdReady:function(e){e?X.readyWait++:X.ready(!0)},ready:function(e){(!0===e?--X.readyWait:X.isReady)||(X.isReady=!0,!0!==e&&--X.readyWait>0||(le.resolveWith(q,[X]),X.fn.triggerHandler&&(X(q).triggerHandler("ready"),X(q).off("ready"))))}}),X.ready.promise=function(t){return le||(le=X.Deferred(),"complete"===q.readyState?setTimeout(X.ready):(q.addEventListener("DOMContentLoaded",r,!1),e.addEventListener("load",r,!1))),le.promise(t)},X.ready.promise();var ue=X.access=function(e,t,n,i,o,r,a){var s=0,l=e.length,c=null==n;if("object"===X.type(n))for(s in o=!0,n)X.access(e,t,s,n[s],!0,r,a);else if(void 0!==i&&(o=!0,X.isFunction(i)||(a=!0),c&&(a?(t.call(e,i),t=null):(c=t,t=function(e,t,n){return c.call(X(e),n)})),t))for(;l>s;s++)t(e[s],n,a?i:i.call(e[s],s,t(e[s],n)));return o?e:c?t.call(e):l?t(e[0],n):r};X.acceptData=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType},a.uid=1,a.accepts=X.acceptData,a.prototype={key:function(e){if(!a.accepts(e))return 0;var t={},n=e[this.expando];if(!n){n=a.uid++;try{t[this.expando]={value:n},Object.defineProperties(e,t)}catch(i){t[this.expando]=n,X.extend(e,t)}}return this.cache[n]||(this.cache[n]={}),n},set:function(e,t,n){var i,o=this.key(e),r=this.cache[o];if("string"==typeof t)r[t]=n;else if(X.isEmptyObject(r))X.extend(this.cache[o],t);else for(i in t)r[i]=t[i];return r},get:function(e,t){var n=this.cache[this.key(e)];return void 0===t?n:n[t]},access:function(e,t,n){var i;return void 0===t||t&&"string"==typeof t&&void 0===n?void 0!==(i=this.get(e,t))?i:this.get(e,X.camelCase(t)):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,i,o,r=this.key(e),a=this.cache[r];if(void 0===t)this.cache[r]={};else{X.isArray(t)?i=t.concat(t.map(X.camelCase)):(o=X.camelCase(t),t in a?i=[t,o]:i=(i=o)in a?[i]:i.match(ce)||[]),n=i.length;for(;n--;)delete a[i[n]]}},hasData:function(e){return!X.isEmptyObject(this.cache[e[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}};var he=new a,pe=new a,fe=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,ve=/([A-Z])/g;X.extend({hasData:function(e){return pe.hasData(e)||he.hasData(e)},data:function(e,t,n){return pe.access(e,t,n)},removeData:function(e,t){pe.remove(e,t)},_data:function(e,t,n){return he.access(e,t,n)},_removeData:function(e,t){he.remove(e,t)}}),X.fn.extend({data:function(e,t){var n,i,o,r=this[0],a=r&&r.attributes;if(void 0===e){if(this.length&&(o=pe.get(r),1===r.nodeType&&!he.get(r,"hasDataAttrs"))){for(n=a.length;n--;)a[n]&&(0===(i=a[n].name).indexOf("data-")&&(i=X.camelCase(i.slice(5)),s(r,i,o[i])));he.set(r,"hasDataAttrs",!0)}return o}return"object"==typeof e?this.each((function(){pe.set(this,e)})):ue(this,(function(t){var n,i=X.camelCase(e);if(r&&void 0===t){if(void 0!==(n=pe.get(r,e)))return n;if(void 0!==(n=pe.get(r,i)))return n;if(void 0!==(n=s(r,i,void 0)))return n}else this.each((function(){var n=pe.get(this,i);pe.set(this,i,t),-1!==e.indexOf("-")&&void 0!==n&&pe.set(this,e,t)}))}),null,t,arguments.length>1,null,!0)},removeData:function(e){return this.each((function(){pe.remove(this,e)}))}}),X.extend({queue:function(e,t,n){var i;return e?(t=(t||"fx")+"queue",i=he.get(e,t),n&&(!i||X.isArray(n)?i=he.access(e,t,X.makeArray(n)):i.push(n)),i||[]):void 0},dequeue:function(e,t){t=t||"fx";var n=X.queue(e,t),i=n.length,o=n.shift(),r=X._queueHooks(e,t);"inprogress"===o&&(o=n.shift(),i--),o&&("fx"===t&&n.unshift("inprogress"),delete r.stop,o.call(e,(function(){X.dequeue(e,t)}),r)),!i&&r&&r.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return he.get(e,n)||he.access(e,n,{empty:X.Callbacks("once memory").add((function(){he.remove(e,[t+"queue",n])}))})}}),X.fn.extend({queue:function(e,t){var n=2;return"string"!=typeof e&&(t=e,e="fx",n--),arguments.length<n?X.queue(this[0],e):void 0===t?this:this.each((function(){var n=X.queue(this,e,t);X._queueHooks(this,e),"fx"===e&&"inprogress"!==n[0]&&X.dequeue(this,e)}))},dequeue:function(e){return this.each((function(){X.dequeue(this,e)}))},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,i=1,o=X.Deferred(),r=this,a=this.length,s=function(){--i||o.resolveWith(r,[r])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";a--;)(n=he.get(r[a],e+"queueHooks"))&&n.empty&&(i++,n.empty.add(s));return s(),o.promise(t)}});var me=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ge=["Top","Right","Bottom","Left"],ye=function(e,t){return e=t||e,"none"===X.css(e,"display")||!X.contains(e.ownerDocument,e)},be=/^(?:checkbox|radio)$/i;!function(){var e=q.createDocumentFragment().appendChild(q.createElement("div")),t=q.createElement("input");t.setAttribute("type","radio"),t.setAttribute("checked","checked"),t.setAttribute("name","t"),e.appendChild(t),G.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",G.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var we="undefined";G.focusinBubbles="onfocusin"in e;var xe=/^key/,Pe=/^(?:mouse|pointer|contextmenu)|click/,Ee=/^(?:focusinfocus|focusoutblur)$/,Ce=/^([^.]*)(?:\.(.+)|)$/;X.event={global:{},add:function(e,t,n,i,o){var r,a,s,l,c,d,u,h,p,f,v,m=he.get(e);if(m)for(n.handler&&(n=(r=n).handler,o=r.selector),n.guid||(n.guid=X.guid++),(l=m.events)||(l=m.events={}),(a=m.handle)||(a=m.handle=function(t){return typeof X!==we&&X.event.triggered!==t.type?X.event.dispatch.apply(e,arguments):void 0}),c=(t=(t||"").match(ce)||[""]).length;c--;)p=v=(s=Ce.exec(t[c])||[])[1],f=(s[2]||"").split(".").sort(),p&&(u=X.event.special[p]||{},p=(o?u.delegateType:u.bindType)||p,u=X.event.special[p]||{},d=X.extend({type:p,origType:v,data:i,handler:n,guid:n.guid,selector:o,needsContext:o&&X.expr.match.needsContext.test(o),namespace:f.join(".")},r),(h=l[p])||((h=l[p]=[]).delegateCount=0,u.setup&&!1!==u.setup.call(e,i,f,a)||e.addEventListener&&e.addEventListener(p,a,!1)),u.add&&(u.add.call(e,d),d.handler.guid||(d.handler.guid=n.guid)),o?h.splice(h.delegateCount++,0,d):h.push(d),X.event.global[p]=!0)},remove:function(e,t,n,i,o){var r,a,s,l,c,d,u,h,p,f,v,m=he.hasData(e)&&he.get(e);if(m&&(l=m.events)){for(c=(t=(t||"").match(ce)||[""]).length;c--;)if(p=v=(s=Ce.exec(t[c])||[])[1],f=(s[2]||"").split(".").sort(),p){for(u=X.event.special[p]||{},h=l[p=(i?u.delegateType:u.bindType)||p]||[],s=s[2]&&new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=r=h.length;r--;)d=h[r],!o&&v!==d.origType||n&&n.guid!==d.guid||s&&!s.test(d.namespace)||i&&i!==d.selector&&("**"!==i||!d.selector)||(h.splice(r,1),d.selector&&h.delegateCount--,u.remove&&u.remove.call(e,d));a&&!h.length&&(u.teardown&&!1!==u.teardown.call(e,f,m.handle)||X.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)X.event.remove(e,p+t[c],n,i,!0);X.isEmptyObject(l)&&(delete m.handle,he.remove(e,"events"))}},trigger:function(t,n,i,o){var r,a,s,l,c,d,u,h=[i||q],p=H.call(t,"type")?t.type:t,f=H.call(t,"namespace")?t.namespace.split("."):[];if(a=s=i=i||q,3!==i.nodeType&&8!==i.nodeType&&!Ee.test(p+X.event.triggered)&&(p.indexOf(".")>=0&&(f=p.split("."),p=f.shift(),f.sort()),c=p.indexOf(":")<0&&"on"+p,(t=t[X.expando]?t:new X.Event(p,"object"==typeof t&&t)).isTrigger=o?2:3,t.namespace=f.join("."),t.namespace_re=t.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,t.result=void 0,t.target||(t.target=i),n=null==n?[t]:X.makeArray(n,[t]),u=X.event.special[p]||{},o||!u.trigger||!1!==u.trigger.apply(i,n))){if(!o&&!u.noBubble&&!X.isWindow(i)){for(l=u.delegateType||p,Ee.test(l+p)||(a=a.parentNode);a;a=a.parentNode)h.push(a),s=a;s===(i.ownerDocument||q)&&h.push(s.defaultView||s.parentWindow||e)}for(r=0;(a=h[r++])&&!t.isPropagationStopped();)t.type=r>1?l:u.bindType||p,(d=(he.get(a,"events")||{})[t.type]&&he.get(a,"handle"))&&d.apply(a,n),(d=c&&a[c])&&d.apply&&X.acceptData(a)&&(t.result=d.apply(a,n),!1===t.result&&t.preventDefault());return t.type=p,o||t.isDefaultPrevented()||u._default&&!1!==u._default.apply(h.pop(),n)||!X.acceptData(i)||c&&X.isFunction(i[p])&&!X.isWindow(i)&&((s=i[c])&&(i[c]=null),X.event.triggered=p,i[p](),X.event.triggered=void 0,s&&(i[c]=s)),t.result}},dispatch:function(e){e=X.event.fix(e);var t,n,i,o,r,a=[],s=j.call(arguments),l=(he.get(this,"events")||{})[e.type]||[],c=X.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(a=X.event.handlers.call(this,e,l),t=0;(o=a[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,n=0;(r=o.handlers[n++])&&!e.isImmediatePropagationStopped();)(!e.namespace_re||e.namespace_re.test(r.namespace))&&(e.handleObj=r,e.data=r.data,void 0!==(i=((X.event.special[r.origType]||{}).handle||r.handler).apply(o.elem,s))&&!1===(e.result=i)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var n,i,o,r,a=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!==this;l=l.parentNode||this)if(!0!==l.disabled||"click"!==e.type){for(i=[],n=0;s>n;n++)void 0===i[o=(r=t[n]).selector+" "]&&(i[o]=r.needsContext?X(o,this).index(l)>=0:X.find(o,this,null,[l]).length),i[o]&&i.push(r);i.length&&a.push({elem:l,handlers:i})}return s<t.length&&a.push({elem:this,handlers:t.slice(s)}),a},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var n,i,o,r=t.button;return null==e.pageX&&null!=t.clientX&&(i=(n=e.target.ownerDocument||q).documentElement,o=n.body,e.pageX=t.clientX+(i&&i.scrollLeft||o&&o.scrollLeft||0)-(i&&i.clientLeft||o&&o.clientLeft||0),e.pageY=t.clientY+(i&&i.scrollTop||o&&o.scrollTop||0)-(i&&i.clientTop||o&&o.clientTop||0)),e.which||void 0===r||(e.which=1&r?1:2&r?3:4&r?2:0),e}},fix:function(e){if(e[X.expando])return e;var t,n,i,o=e.type,r=e,a=this.fixHooks[o];for(a||(this.fixHooks[o]=a=Pe.test(o)?this.mouseHooks:xe.test(o)?this.keyHooks:{}),i=a.props?this.props.concat(a.props):this.props,e=new X.Event(r),t=i.length;t--;)e[n=i[t]]=r[n];return e.target||(e.target=q),3===e.target.nodeType&&(e.target=e.target.parentNode),a.filter?a.filter(e,r):e},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==d()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===d()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&X.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(e){return X.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,i){var o=X.extend(new X.Event,n,{type:e,isSimulated:!0,originalEvent:{}});i?X.event.trigger(o,null,t):X.event.dispatch.call(t,o),o.isDefaultPrevented()&&n.preventDefault()}},X.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)},X.Event=function(e,t){return this instanceof X.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?l:c):this.type=e,t&&X.extend(this,t),this.timeStamp=e&&e.timeStamp||X.now(),void(this[X.expando]=!0)):new X.Event(e,t)},X.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=l,e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=l,e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=l,e&&e.stopImmediatePropagation&&e.stopImmediatePropagation(),this.stopPropagation()}},X.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},(function(e,t){X.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,i=this,o=e.relatedTarget,r=e.handleObj;return(!o||o!==i&&!X.contains(i,o))&&(e.type=r.origType,n=r.handler.apply(this,arguments),e.type=t),n}}})),G.focusinBubbles||X.each({focus:"focusin",blur:"focusout"},(function(e,t){var n=function(e){X.event.simulate(t,e.target,X.event.fix(e),!0)};X.event.special[t]={setup:function(){var i=this.ownerDocument||this,o=he.access(i,t);o||i.addEventListener(e,n,!0),he.access(i,t,(o||0)+1)},teardown:function(){var i=this.ownerDocument||this,o=he.access(i,t)-1;o?he.access(i,t,o):(i.removeEventListener(e,n,!0),he.remove(i,t))}}})),X.fn.extend({on:function(e,t,n,i,o){var r,a;if("object"==typeof e){for(a in"string"!=typeof t&&(n=n||t,t=void 0),e)this.on(a,t,n,e[a],o);return this}if(null==n&&null==i?(i=t,n=t=void 0):null==i&&("string"==typeof t?(i=n,n=void 0):(i=n,n=t,t=void 0)),!1===i)i=c;else if(!i)return this;return 1===o&&(r=i,i=function(e){return X().off(e),r.apply(this,arguments)},i.guid=r.guid||(r.guid=X.guid++)),this.each((function(){X.event.add(this,e,i,n,t)}))},one:function(e,t,n,i){return this.on(e,t,n,i,1)},off:function(e,t,n){var i,o;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,X(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return(!1===t||"function"==typeof t)&&(n=t,t=void 0),!1===n&&(n=c),this.each((function(){X.event.remove(this,e,n,t)}))},trigger:function(e,t){return this.each((function(){X.event.trigger(e,t,this)}))},triggerHandler:function(e,t){var n=this[0];return n?X.event.trigger(e,t,n,!0):void 0}});var ke=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Se=/<([\w:]+)/,Te=/<|&#?\w+;/,Le=/<(?:script|style|link)/i,Ie=/checked\s*(?:[^=]|=\s*.checked.)/i,Be=/^$|\/(?:java|ecma)script/i,Me=/^true\/(.*)/,Ae=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,$e={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};$e.optgroup=$e.option,$e.tbody=$e.tfoot=$e.colgroup=$e.caption=$e.thead,$e.th=$e.td,X.extend({clone:function(e,t,n){var i,o,r,a,s=e.cloneNode(!0),l=X.contains(e.ownerDocument,e);if(!(G.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||X.isXMLDoc(e)))for(a=m(s),i=0,o=(r=m(e)).length;o>i;i++)g(r[i],a[i]);if(t)if(n)for(r=r||m(e),a=a||m(s),i=0,o=r.length;o>i;i++)v(r[i],a[i]);else v(e,s);return(a=m(s,"script")).length>0&&f(a,!l&&m(e,"script")),s},buildFragment:function(e,t,n,i){for(var o,r,a,s,l,c,d=t.createDocumentFragment(),u=[],h=0,p=e.length;p>h;h++)if((o=e[h])||0===o)if("object"===X.type(o))X.merge(u,o.nodeType?[o]:o);else if(Te.test(o)){for(r=r||d.appendChild(t.createElement("div")),a=(Se.exec(o)||["",""])[1].toLowerCase(),s=$e[a]||$e._default,r.innerHTML=s[1]+o.replace(ke,"<$1></$2>")+s[2],c=s[0];c--;)r=r.lastChild;X.merge(u,r.childNodes),(r=d.firstChild).textContent=""}else u.push(t.createTextNode(o));for(d.textContent="",h=0;o=u[h++];)if((!i||-1===X.inArray(o,i))&&(l=X.contains(o.ownerDocument,o),r=m(d.appendChild(o),"script"),l&&f(r),n))for(c=0;o=r[c++];)Be.test(o.type||"")&&n.push(o);return d},cleanData:function(e){for(var t,n,i,o,r=X.event.special,a=0;void 0!==(n=e[a]);a++){if(X.acceptData(n)&&((o=n[he.expando])&&(t=he.cache[o]))){if(t.events)for(i in t.events)r[i]?X.event.remove(n,i):X.removeEvent(n,i,t.handle);he.cache[o]&&delete he.cache[o]}delete pe.cache[n[pe.expando]]}}}),X.fn.extend({text:function(e){return ue(this,(function(e){return void 0===e?X.text(this):this.empty().each((function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=e)}))}),null,e,arguments.length)},append:function(){return this.domManip(arguments,(function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||u(this,e).appendChild(e)}))},prepend:function(){return this.domManip(arguments,(function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=u(this,e);t.insertBefore(e,t.firstChild)}}))},before:function(){return this.domManip(arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this)}))},after:function(){return this.domManip(arguments,(function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)}))},remove:function(e,t){for(var n,i=e?X.filter(e,this):this,o=0;null!=(n=i[o]);o++)t||1!==n.nodeType||X.cleanData(m(n)),n.parentNode&&(t&&X.contains(n.ownerDocument,n)&&f(m(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(X.cleanData(m(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map((function(){return X.clone(this,e,t)}))},html:function(e){return ue(this,(function(e){var t=this[0]||{},n=0,i=this.length;if(void 0===e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Le.test(e)&&!$e[(Se.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(ke,"<$1></$2>");try{for(;i>n;n++)1===(t=this[n]||{}).nodeType&&(X.cleanData(m(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)}),null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,(function(t){e=this.parentNode,X.cleanData(m(this)),e&&e.replaceChild(t,this)})),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=N.apply([],e);var n,i,o,r,a,s,l=0,c=this.length,d=this,u=c-1,f=e[0],v=X.isFunction(f);if(v||c>1&&"string"==typeof f&&!G.checkClone&&Ie.test(f))return this.each((function(n){var i=d.eq(n);v&&(e[0]=f.call(this,n,i.html())),i.domManip(e,t)}));if(c&&(i=(n=X.buildFragment(e,this[0].ownerDocument,!1,this)).firstChild,1===n.childNodes.length&&(n=i),i)){for(r=(o=X.map(m(n,"script"),h)).length;c>l;l++)a=n,l!==u&&(a=X.clone(a,!0,!0),r&&X.merge(o,m(a,"script"))),t.call(this[l],a,l);if(r)for(s=o[o.length-1].ownerDocument,X.map(o,p),l=0;r>l;l++)a=o[l],Be.test(a.type||"")&&!he.access(a,"globalEval")&&X.contains(s,a)&&(a.src?X._evalUrl&&X._evalUrl(a.src):X.globalEval(a.textContent.replace(Ae,"")))}return this}}),X.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},(function(e,t){X.fn[e]=function(e){for(var n,i=[],o=X(e),r=o.length-1,a=0;r>=a;a++)n=a===r?this:this.clone(!0),X(o[a])[t](n),R.apply(i,n.get());return this.pushStack(i)}}));var _e,Oe={},De=/^margin/,Fe=new RegExp("^("+me+")(?!px)[a-z%]+$","i"),je=function(t){return t.ownerDocument.defaultView.opener?t.ownerDocument.defaultView.getComputedStyle(t,null):e.getComputedStyle(t,null)};!function(){function t(){a.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",a.innerHTML="",o.appendChild(r);var t=e.getComputedStyle(a,null);n="1%"!==t.top,i="4px"===t.width,o.removeChild(r)}var n,i,o=q.documentElement,r=q.createElement("div"),a=q.createElement("div");a.style&&(a.style.backgroundClip="content-box",a.cloneNode(!0).style.backgroundClip="",G.clearCloneStyle="content-box"===a.style.backgroundClip,r.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",r.appendChild(a),e.getComputedStyle&&X.extend(G,{pixelPosition:function(){return t(),n},boxSizingReliable:function(){return null==i&&t(),i},reliableMarginRight:function(){var t,n=a.appendChild(q.createElement("div"));return n.style.cssText=a.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",a.style.width="1px",o.appendChild(r),t=!parseFloat(e.getComputedStyle(n,null).marginRight),o.removeChild(r),a.removeChild(n),t}}))}(),X.swap=function(e,t,n,i){var o,r,a={};for(r in t)a[r]=e.style[r],e.style[r]=t[r];for(r in o=n.apply(e,i||[]),t)e.style[r]=a[r];return o};var Ne=/^(none|table(?!-c[ea]).+)/,Re=new RegExp("^("+me+")(.*)$","i"),Ue=new RegExp("^([+-])=("+me+")","i"),Qe={position:"absolute",visibility:"hidden",display:"block"},We={letterSpacing:"0",fontWeight:"400"},He=["Webkit","O","Moz","ms"];X.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=w(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:"cssFloat"},style:function(e,t,n,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,r,a,s=X.camelCase(t),l=e.style;return t=X.cssProps[s]||(X.cssProps[s]=P(l,s)),a=X.cssHooks[t]||X.cssHooks[s],void 0===n?a&&"get"in a&&void 0!==(o=a.get(e,!1,i))?o:l[t]:("string"===(r=typeof n)&&(o=Ue.exec(n))&&(n=(o[1]+1)*o[2]+parseFloat(X.css(e,t)),r="number"),void(null!=n&&n==n&&("number"!==r||X.cssNumber[s]||(n+="px"),G.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,i))||(l[t]=n))))}},css:function(e,t,n,i){var o,r,a,s=X.camelCase(t);return t=X.cssProps[s]||(X.cssProps[s]=P(e.style,s)),(a=X.cssHooks[t]||X.cssHooks[s])&&"get"in a&&(o=a.get(e,!0,n)),void 0===o&&(o=w(e,t,i)),"normal"===o&&t in We&&(o=We[t]),""===n||n?(r=parseFloat(o),!0===n||X.isNumeric(r)?r||0:o):o}}),X.each(["height","width"],(function(e,t){X.cssHooks[t]={get:function(e,n,i){return n?Ne.test(X.css(e,"display"))&&0===e.offsetWidth?X.swap(e,Qe,(function(){return k(e,t,i)})):k(e,t,i):void 0},set:function(e,n,i){var o=i&&je(e);return E(0,n,i?C(e,t,i,"border-box"===X.css(e,"boxSizing",!1,o),o):0)}}})),X.cssHooks.marginRight=x(G.reliableMarginRight,(function(e,t){return t?X.swap(e,{display:"inline-block"},w,[e,"marginRight"]):void 0})),X.each({margin:"",padding:"",border:"Width"},(function(e,t){X.cssHooks[e+t]={expand:function(n){for(var i=0,o={},r="string"==typeof n?n.split(" "):[n];4>i;i++)o[e+ge[i]+t]=r[i]||r[i-2]||r[0];return o}},De.test(e)||(X.cssHooks[e+t].set=E)})),X.fn.extend({css:function(e,t){return ue(this,(function(e,t,n){var i,o,r={},a=0;if(X.isArray(t)){for(i=je(e),o=t.length;o>a;a++)r[t[a]]=X.css(e,t[a],!1,i);return r}return void 0!==n?X.style(e,t,n):X.css(e,t)}),e,t,arguments.length>1)},show:function(){return S(this,!0)},hide:function(){return S(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each((function(){ye(this)?X(this).show():X(this).hide()}))}}),X.Tween=T,T.prototype={constructor:T,init:function(e,t,n,i,o,r){this.elem=e,this.prop=n,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=i,this.unit=r||(X.cssNumber[n]?"":"px")},cur:function(){var e=T.propHooks[this.prop];return e&&e.get?e.get(this):T.propHooks._default.get(this)},run:function(e){var t,n=T.propHooks[this.prop];return this.pos=t=this.options.duration?X.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):T.propHooks._default.set(this),this}},T.prototype.init.prototype=T.prototype,T.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=X.css(e.elem,e.prop,""))&&"auto"!==t?t:0:e.elem[e.prop]},set:function(e){X.fx.step[e.prop]?X.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[X.cssProps[e.prop]]||X.cssHooks[e.prop])?X.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},T.propHooks.scrollTop=T.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},X.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},X.fx=T.prototype.init,X.fx.step={};var Ge,qe,Ve=/^(?:toggle|show|hide)$/,Xe=new RegExp("^(?:([+-])=|)("+me+")([a-z%]*)$","i"),ze=/queueHooks$/,Ye=[function(e,t,n){var i,o,r,a,s,l,c,d=this,u={},h=e.style,p=e.nodeType&&ye(e),f=he.get(e,"fxshow");for(i in n.queue||(null==(s=X._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,d.always((function(){d.always((function(){s.unqueued--,X.queue(e,"fx").length||s.empty.fire()}))}))),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],"inline"===("none"===(c=X.css(e,"display"))?he.get(e,"olddisplay")||b(e.nodeName):c)&&"none"===X.css(e,"float")&&(h.display="inline-block")),n.overflow&&(h.overflow="hidden",d.always((function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]}))),t)if(o=t[i],Ve.exec(o)){if(delete t[i],r=r||"toggle"===o,o===(p?"hide":"show")){if("show"!==o||!f||void 0===f[i])continue;p=!0}u[i]=f&&f[i]||X.style(e,i)}else c=void 0;if(X.isEmptyObject(u))"inline"===("none"===c?b(e.nodeName):c)&&(h.display=c);else for(i in f?"hidden"in f&&(p=f.hidden):f=he.access(e,"fxshow",{}),r&&(f.hidden=!p),p?X(e).show():d.done((function(){X(e).hide()})),d.done((function(){var t;for(t in he.remove(e,"fxshow"),u)X.style(e,t,u[t])})),u)a=B(p?f[i]:0,i,d),i in f||(f[i]=a.start,p&&(a.end=a.start,a.start="width"===i||"height"===i?1:0))}],Je={"*":[function(e,t){var n=this.createTween(e,t),i=n.cur(),o=Xe.exec(t),r=o&&o[3]||(X.cssNumber[e]?"":"px"),a=(X.cssNumber[e]||"px"!==r&&+i)&&Xe.exec(X.css(n.elem,e)),s=1,l=20;if(a&&a[3]!==r){r=r||a[3],o=o||[],a=+i||1;do{a/=s=s||".5",X.style(n.elem,e,a+r)}while(s!==(s=n.cur()/i)&&1!==s&&--l)}return o&&(a=n.start=+a||+i||0,n.unit=r,n.end=o[1]?a+(o[1]+1)*o[2]:+o[2]),n}]};X.Animation=X.extend(M,{tweener:function(e,t){X.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var n,i=0,o=e.length;o>i;i++)n=e[i],Je[n]=Je[n]||[],Je[n].unshift(t)},prefilter:function(e,t){t?Ye.unshift(e):Ye.push(e)}}),X.speed=function(e,t,n){var i=e&&"object"==typeof e?X.extend({},e):{complete:n||!n&&t||X.isFunction(e)&&e,duration:e,easing:n&&t||t&&!X.isFunction(t)&&t};return i.duration=X.fx.off?0:"number"==typeof i.duration?i.duration:i.duration in X.fx.speeds?X.fx.speeds[i.duration]:X.fx.speeds._default,(null==i.queue||!0===i.queue)&&(i.queue="fx"),i.old=i.complete,i.complete=function(){X.isFunction(i.old)&&i.old.call(this),i.queue&&X.dequeue(this,i.queue)},i},X.fn.extend({fadeTo:function(e,t,n,i){return this.filter(ye).css("opacity",0).show().end().animate({opacity:t},e,n,i)},animate:function(e,t,n,i){var o=X.isEmptyObject(e),r=X.speed(t,n,i),a=function(){var t=M(this,X.extend({},e),r);(o||he.get(this,"finish"))&&t.stop(!0)};return a.finish=a,o||!1===r.queue?this.each(a):this.queue(r.queue,a)},stop:function(e,t,n){var i=function(e){var t=e.stop;delete e.stop,t(n)};return"string"!=typeof e&&(n=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each((function(){var t=!0,o=null!=e&&e+"queueHooks",r=X.timers,a=he.get(this);if(o)a[o]&&a[o].stop&&i(a[o]);else for(o in a)a[o]&&a[o].stop&&ze.test(o)&&i(a[o]);for(o=r.length;o--;)r[o].elem!==this||null!=e&&r[o].queue!==e||(r[o].anim.stop(n),t=!1,r.splice(o,1));(t||!n)&&X.dequeue(this,e)}))},finish:function(e){return!1!==e&&(e=e||"fx"),this.each((function(){var t,n=he.get(this),i=n[e+"queue"],o=n[e+"queueHooks"],r=X.timers,a=i?i.length:0;for(n.finish=!0,X.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=r.length;t--;)r[t].elem===this&&r[t].queue===e&&(r[t].anim.stop(!0),r.splice(t,1));for(t=0;a>t;t++)i[t]&&i[t].finish&&i[t].finish.call(this);delete n.finish}))}}),X.each(["toggle","show","hide"],(function(e,t){var n=X.fn[t];X.fn[t]=function(e,i,o){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(I(t,!0),e,i,o)}})),X.each({slideDown:I("show"),slideUp:I("hide"),slideToggle:I("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},(function(e,t){X.fn[e]=function(e,n,i){return this.animate(t,e,n,i)}})),X.timers=[],X.fx.tick=function(){var e,t=0,n=X.timers;for(Ge=X.now();t<n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||X.fx.stop(),Ge=void 0},X.fx.timer=function(e){X.timers.push(e),e()?X.fx.start():X.timers.pop()},X.fx.interval=13,X.fx.start=function(){qe||(qe=setInterval(X.fx.tick,X.fx.interval))},X.fx.stop=function(){clearInterval(qe),qe=null},X.fx.speeds={slow:600,fast:200,_default:400},X.fn.delay=function(e,t){return e=X.fx&&X.fx.speeds[e]||e,t=t||"fx",this.queue(t,(function(t,n){var i=setTimeout(t,e);n.stop=function(){clearTimeout(i)}}))},function(){var e=q.createElement("input"),t=q.createElement("select"),n=t.appendChild(q.createElement("option"));e.type="checkbox",G.checkOn=""!==e.value,G.optSelected=n.selected,t.disabled=!0,G.optDisabled=!n.disabled,(e=q.createElement("input")).value="t",e.type="radio",G.radioValue="t"===e.value}();var Ze,Ke=X.expr.attrHandle;X.fn.extend({attr:function(e,t){return ue(this,X.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each((function(){X.removeAttr(this,e)}))}}),X.extend({attr:function(e,t,n){var i,o,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return typeof e.getAttribute===we?X.prop(e,t,n):(1===r&&X.isXMLDoc(e)||(t=t.toLowerCase(),i=X.attrHooks[t]||(X.expr.match.bool.test(t)?Ze:undefined)),void 0===n?i&&"get"in i&&null!==(o=i.get(e,t))?o:null==(o=X.find.attr(e,t))?void 0:o:null!==n?i&&"set"in i&&void 0!==(o=i.set(e,n,t))?o:(e.setAttribute(t,n+""),n):void X.removeAttr(e,t))},removeAttr:function(e,t){var n,i,o=0,r=t&&t.match(ce);if(r&&1===e.nodeType)for(;n=r[o++];)i=X.propFix[n]||n,X.expr.match.bool.test(n)&&(e[i]=!1),e.removeAttribute(n)},attrHooks:{type:{set:function(e,t){if(!G.radioValue&&"radio"===t&&X.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}}}),Ze={set:function(e,t,n){return!1===t?X.removeAttr(e,n):e.setAttribute(n,n),n}},X.each(X.expr.match.bool.source.match(/\w+/g),(function(e,t){var n=Ke[t]||X.find.attr;Ke[t]=function(e,t,i){var o,r;return i||(r=Ke[t],Ke[t]=o,o=null!=n(e,t,i)?t.toLowerCase():null,Ke[t]=r),o}}));var et=/^(?:input|select|textarea|button)$/i;X.fn.extend({prop:function(e,t){return ue(this,X.prop,e,t,arguments.length>1)},removeProp:function(e){return this.each((function(){delete this[X.propFix[e]||e]}))}}),X.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,n){var i,o,r=e.nodeType;if(e&&3!==r&&8!==r&&2!==r)return(1!==r||!X.isXMLDoc(e))&&(t=X.propFix[t]||t,o=X.propHooks[t]),void 0!==n?o&&"set"in o&&void 0!==(i=o.set(e,n,t))?i:e[t]=n:o&&"get"in o&&null!==(i=o.get(e,t))?i:e[t]},propHooks:{tabIndex:{get:function(e){return e.hasAttribute("tabindex")||et.test(e.nodeName)||e.href?e.tabIndex:-1}}}}),G.optSelected||(X.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null}}),X.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],(function(){X.propFix[this.toLowerCase()]=this}));var tt=/[\t\r\n\f]/g;X.fn.extend({addClass:function(e){var t,n,i,o,r,a,s="string"==typeof e&&e,l=0,c=this.length;if(X.isFunction(e))return this.each((function(t){X(this).addClass(e.call(this,t,this.className))}));if(s)for(t=(e||"").match(ce)||[];c>l;l++)if(i=1===(n=this[l]).nodeType&&(n.className?(" "+n.className+" ").replace(tt," "):" ")){for(r=0;o=t[r++];)i.indexOf(" "+o+" ")<0&&(i+=o+" ");a=X.trim(i),n.className!==a&&(n.className=a)}return this},removeClass:function(e){var t,n,i,o,r,a,s=0===arguments.length||"string"==typeof e&&e,l=0,c=this.length;if(X.isFunction(e))return this.each((function(t){X(this).removeClass(e.call(this,t,this.className))}));if(s)for(t=(e||"").match(ce)||[];c>l;l++)if(i=1===(n=this[l]).nodeType&&(n.className?(" "+n.className+" ").replace(tt," "):"")){for(r=0;o=t[r++];)for(;i.indexOf(" "+o+" ")>=0;)i=i.replace(" "+o+" "," ");a=e?X.trim(i):"",n.className!==a&&(n.className=a)}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):this.each(X.isFunction(e)?function(n){X(this).toggleClass(e.call(this,n,this.className,t),t)}:function(){if("string"===n)for(var t,i=0,o=X(this),r=e.match(ce)||[];t=r[i++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else(n===we||"boolean"===n)&&(this.className&&he.set(this,"__className__",this.className),this.className=this.className||!1===e?"":he.get(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",n=0,i=this.length;i>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(tt," ").indexOf(t)>=0)return!0;return!1}});var nt=/\r/g;X.fn.extend({val:function(e){var t,n,i,o=this[0];return arguments.length?(i=X.isFunction(e),this.each((function(n){var o;1===this.nodeType&&(null==(o=i?e.call(this,n,X(this).val()):e)?o="":"number"==typeof o?o+="":X.isArray(o)&&(o=X.map(o,(function(e){return null==e?"":e+""}))),(t=X.valHooks[this.type]||X.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))}))):o?(t=X.valHooks[o.type]||X.valHooks[o.nodeName.toLowerCase()])&&"get"in t&&void 0!==(n=t.get(o,"value"))?n:"string"==typeof(n=o.value)?n.replace(nt,""):null==n?"":n:void 0}}),X.extend({valHooks:{option:{get:function(e){var t=X.find.attr(e,"value");return null!=t?t:X.trim(X.text(e))}},select:{get:function(e){for(var t,n,i=e.options,o=e.selectedIndex,r="select-one"===e.type||0>o,a=r?null:[],s=r?o+1:i.length,l=0>o?s:r?o:0;s>l;l++)if(!(!(n=i[l]).selected&&l!==o||(G.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&X.nodeName(n.parentNode,"optgroup"))){if(t=X(n).val(),r)return t;a.push(t)}return a},set:function(e,t){for(var n,i,o=e.options,r=X.makeArray(t),a=o.length;a--;)((i=o[a]).selected=X.inArray(i.value,r)>=0)&&(n=!0);return n||(e.selectedIndex=-1),r}}}}),X.each(["radio","checkbox"],(function(){X.valHooks[this]={set:function(e,t){return X.isArray(t)?e.checked=X.inArray(X(e).val(),t)>=0:void 0}},G.checkOn||(X.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})})),X.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),(function(e,t){X.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}})),X.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,i){return this.on(t,e,n,i)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var it=X.now(),ot=/\?/;X.parseJSON=function(e){return JSON.parse(e+"")},X.parseXML=function(e){var t;if(!e||"string"!=typeof e)return null;try{t=(new DOMParser).parseFromString(e,"text/xml")}catch(e){t=void 0}return(!t||t.getElementsByTagName("parsererror").length)&&X.error("Invalid XML: "+e),t};var rt=/#.*$/,at=/([?&])_=[^&]*/,st=/^(.*?):[ \t]*([^\r\n]*)$/gm,lt=/^(?:GET|HEAD)$/,ct=/^\/\//,dt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ut={},ht={},pt="*/".concat("*"),ft=e.location.href,vt=dt.exec(ft.toLowerCase())||[];X.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ft,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(vt[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":pt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":X.parseJSON,"text xml":X.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?_(_(e,X.ajaxSettings),t):_(X.ajaxSettings,e)},ajaxPrefilter:A(ut),ajaxTransport:A(ht),ajax:function(e,t){function n(e,t,n,a){var l,d,g,y,w,P=t;2!==b&&(b=2,s&&clearTimeout(s),i=void 0,r=a||"",x.readyState=e>0?4:0,l=e>=200&&300>e||304===e,n&&(y=function(e,t,n){for(var i,o,r,a,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===i&&(i=e.mimeType||t.getResponseHeader("Content-Type"));if(i)for(o in s)if(s[o]&&s[o].test(i)){l.unshift(o);break}if(l[0]in n)r=l[0];else{for(o in n){if(!l[0]||e.converters[o+" "+l[0]]){r=o;break}a||(a=o)}r=r||a}return r?(r!==l[0]&&l.unshift(r),n[r]):void 0}(u,x,n)),y=function(e,t,n,i){var o,r,a,s,l,c={},d=e.dataTypes.slice();if(d[1])for(a in e.converters)c[a.toLowerCase()]=e.converters[a];for(r=d.shift();r;)if(e.responseFields[r]&&(n[e.responseFields[r]]=t),!l&&i&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=r,r=d.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(!(a=c[l+" "+r]||c["* "+r]))for(o in c)if((s=o.split(" "))[1]===r&&(a=c[l+" "+s[0]]||c["* "+s[0]])){!0===a?a=c[o]:!0!==c[o]&&(r=s[0],d.unshift(s[1]));break}if(!0!==a)if(a&&e.throws)t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+l+" to "+r}}}return{state:"success",data:t}}(u,y,x,l),l?(u.ifModified&&((w=x.getResponseHeader("Last-Modified"))&&(X.lastModified[o]=w),(w=x.getResponseHeader("etag"))&&(X.etag[o]=w)),204===e||"HEAD"===u.type?P="nocontent":304===e?P="notmodified":(P=y.state,d=y.data,l=!(g=y.error))):(g=P,(e||!P)&&(P="error",0>e&&(e=0))),x.status=e,x.statusText=(t||P)+"",l?f.resolveWith(h,[d,P,x]):f.rejectWith(h,[x,P,g]),x.statusCode(m),m=void 0,c&&p.trigger(l?"ajaxSuccess":"ajaxError",[x,u,l?d:g]),v.fireWith(h,[x,P]),c&&(p.trigger("ajaxComplete",[x,u]),--X.active||X.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var i,o,r,a,s,l,c,d,u=X.ajaxSetup({},t),h=u.context||u,p=u.context&&(h.nodeType||h.jquery)?X(h):X.event,f=X.Deferred(),v=X.Callbacks("once memory"),m=u.statusCode||{},g={},y={},b=0,w="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!a)for(a={};t=st.exec(r);)a[t[1].toLowerCase()]=t[2];t=a[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?r:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return b||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||w;return i&&i.abort(t),n(0,t),this}};if(f.promise(x).complete=v.add,x.success=x.done,x.error=x.fail,u.url=((e||u.url||ft)+"").replace(rt,"").replace(ct,vt[1]+"//"),u.type=t.method||t.type||u.method||u.type,u.dataTypes=X.trim(u.dataType||"*").toLowerCase().match(ce)||[""],null==u.crossDomain&&(l=dt.exec(u.url.toLowerCase()),u.crossDomain=!(!l||l[1]===vt[1]&&l[2]===vt[2]&&(l[3]||("http:"===l[1]?"80":"443"))===(vt[3]||("http:"===vt[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=X.param(u.data,u.traditional)),$(ut,u,t,x),2===b)return x;for(d in(c=X.event&&u.global)&&0==X.active++&&X.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!lt.test(u.type),o=u.url,u.hasContent||(u.data&&(o=u.url+=(ot.test(o)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=at.test(o)?o.replace(at,"$1_="+it++):o+(ot.test(o)?"&":"?")+"_="+it++)),u.ifModified&&(X.lastModified[o]&&x.setRequestHeader("If-Modified-Since",X.lastModified[o]),X.etag[o]&&x.setRequestHeader("If-None-Match",X.etag[o])),(u.data&&u.hasContent&&!1!==u.contentType||t.contentType)&&x.setRequestHeader("Content-Type",u.contentType),x.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+pt+"; q=0.01":""):u.accepts["*"]),u.headers)x.setRequestHeader(d,u.headers[d]);if(u.beforeSend&&(!1===u.beforeSend.call(h,x,u)||2===b))return x.abort();for(d in w="abort",{success:1,error:1,complete:1})x[d](u[d]);if(i=$(ht,u,t,x)){x.readyState=1,c&&p.trigger("ajaxSend",[x,u]),u.async&&u.timeout>0&&(s=setTimeout((function(){x.abort("timeout")}),u.timeout));try{b=1,i.send(g,n)}catch(e){if(!(2>b))throw e;n(-1,e)}}else n(-1,"No Transport");return x},getJSON:function(e,t,n){return X.get(e,t,n,"json")},getScript:function(e,t){return X.get(e,void 0,t,"script")}}),X.each(["get","post"],(function(e,t){X[t]=function(e,n,i,o){return X.isFunction(n)&&(o=o||i,i=n,n=void 0),X.ajax({url:e,type:t,dataType:o,data:n,success:i})}})),X._evalUrl=function(e){return X.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},X.fn.extend({wrapAll:function(e){var t;return X.isFunction(e)?this.each((function(t){X(this).wrapAll(e.call(this,t))})):(this[0]&&(t=X(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map((function(){for(var e=this;e.firstElementChild;)e=e.firstElementChild;return e})).append(this)),this)},wrapInner:function(e){return this.each(X.isFunction(e)?function(t){X(this).wrapInner(e.call(this,t))}:function(){var t=X(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=X.isFunction(e);return this.each((function(n){X(this).wrapAll(t?e.call(this,n):e)}))},unwrap:function(){return this.parent().each((function(){X.nodeName(this,"body")||X(this).replaceWith(this.childNodes)})).end()}}),X.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0},X.expr.filters.visible=function(e){return!X.expr.filters.hidden(e)};var mt=/%20/g,gt=/\[\]$/,yt=/\r?\n/g,bt=/^(?:submit|button|image|reset|file)$/i,wt=/^(?:input|select|textarea|keygen)/i;X.param=function(e,t){var n,i=[],o=function(e,t){t=X.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=X.ajaxSettings&&X.ajaxSettings.traditional),X.isArray(e)||e.jquery&&!X.isPlainObject(e))X.each(e,(function(){o(this.name,this.value)}));else for(n in e)O(n,e[n],t,o);return i.join("&").replace(mt,"+")},X.fn.extend({serialize:function(){return X.param(this.serializeArray())},serializeArray:function(){return this.map((function(){var e=X.prop(this,"elements");return e?X.makeArray(e):this})).filter((function(){var e=this.type;return this.name&&!X(this).is(":disabled")&&wt.test(this.nodeName)&&!bt.test(e)&&(this.checked||!be.test(e))})).map((function(e,t){var n=X(this).val();return null==n?null:X.isArray(n)?X.map(n,(function(e){return{name:t.name,value:e.replace(yt,"\r\n")}})):{name:t.name,value:n.replace(yt,"\r\n")}})).get()}}),X.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(e){}};var xt=0,Pt={},Et={0:200,1223:204},Ct=X.ajaxSettings.xhr();e.attachEvent&&e.attachEvent("onunload",(function(){for(var e in Pt)Pt[e]()})),G.cors=!!Ct&&"withCredentials"in Ct,G.ajax=Ct=!!Ct,X.ajaxTransport((function(e){var t;return G.cors||Ct&&!e.crossDomain?{send:function(n,i){var o,r=e.xhr(),a=++xt;if(r.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)r[o]=e.xhrFields[o];for(o in e.mimeType&&r.overrideMimeType&&r.overrideMimeType(e.mimeType),e.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest"),n)r.setRequestHeader(o,n[o]);t=function(e){return function(){t&&(delete Pt[a],t=r.onload=r.onerror=null,"abort"===e?r.abort():"error"===e?i(r.status,r.statusText):i(Et[r.status]||r.status,r.statusText,"string"==typeof r.responseText?{text:r.responseText}:void 0,r.getAllResponseHeaders()))}},r.onload=t(),r.onerror=t("error"),t=Pt[a]=t("abort");try{r.send(e.hasContent&&e.data||null)}catch(e){if(t)throw e}},abort:function(){t&&t()}}:void 0})),X.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return X.globalEval(e),e}}}),X.ajaxPrefilter("script",(function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")})),X.ajaxTransport("script",(function(e){var t,n;if(e.crossDomain)return{send:function(i,o){t=X("<script>").prop({async:!0,charset:e.scriptCharset,src:e.url}).on("load error",n=function(e){t.remove(),n=null,e&&o("error"===e.type?404:200,e.type)}),q.head.appendChild(t[0])},abort:function(){n&&n()}}}));var kt=[],St=/(=)\?(?=&|$)|\?\?/;X.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=kt.pop()||X.expando+"_"+it++;return this[e]=!0,e}}),X.ajaxPrefilter("json jsonp",(function(t,n,i){var o,r,a,s=!1!==t.jsonp&&(St.test(t.url)?"url":"string"==typeof t.data&&!(t.contentType||"").indexOf("application/x-www-form-urlencoded")&&St.test(t.data)&&"data");return s||"jsonp"===t.dataTypes[0]?(o=t.jsonpCallback=X.isFunction(t.jsonpCallback)?t.jsonpCallback():t.jsonpCallback,s?t[s]=t[s].replace(St,"$1"+o):!1!==t.jsonp&&(t.url+=(ot.test(t.url)?"&":"?")+t.jsonp+"="+o),t.converters["script json"]=function(){return a||X.error(o+" was not called"),a[0]},t.dataTypes[0]="json",r=e[o],e[o]=function(){a=arguments},i.always((function(){e[o]=r,t[o]&&(t.jsonpCallback=n.jsonpCallback,kt.push(o)),a&&X.isFunction(r)&&r(a[0]),a=r=void 0})),"script"):void 0})),X.parseHTML=function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||q;var i=te.exec(e),o=!n&&[];return i?[t.createElement(i[1])]:(i=X.buildFragment([e],t,o),o&&o.length&&X(o).remove(),X.merge([],i.childNodes))};var Tt=X.fn.load;X.fn.load=function(e,t,n){if("string"!=typeof e&&Tt)return Tt.apply(this,arguments);var i,o,r,a=this,s=e.indexOf(" ");return s>=0&&(i=X.trim(e.slice(s)),e=e.slice(0,s)),X.isFunction(t)?(n=t,t=void 0):t&&"object"==typeof t&&(o="POST"),a.length>0&&X.ajax({url:e,type:o,dataType:"html",data:t}).done((function(e){r=arguments,a.html(i?X("<div>").append(X.parseHTML(e)).find(i):e)})).complete(n&&function(e,t){a.each(n,r||[e.responseText,t,e])}),this},X.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],(function(e,t){X.fn[t]=function(e){return this.on(t,e)}})),X.expr.filters.animated=function(e){return X.grep(X.timers,(function(t){return e===t.elem})).length};var Lt=e.document.documentElement;X.offset={setOffset:function(e,t,n){var i,o,r,a,s,l,c=X.css(e,"position"),d=X(e),u={};"static"===c&&(e.style.position="relative"),s=d.offset(),r=X.css(e,"top"),l=X.css(e,"left"),("absolute"===c||"fixed"===c)&&(r+l).indexOf("auto")>-1?(a=(i=d.position()).top,o=i.left):(a=parseFloat(r)||0,o=parseFloat(l)||0),X.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(u.top=t.top-s.top+a),null!=t.left&&(u.left=t.left-s.left+o),"using"in t?t.using.call(e,u):d.css(u)}},X.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each((function(t){X.offset.setOffset(this,e,t)}));var t,n,i=this[0],o={top:0,left:0},r=i&&i.ownerDocument;return r?(t=r.documentElement,X.contains(t,i)?(typeof i.getBoundingClientRect!==we&&(o=i.getBoundingClientRect()),n=D(r),{top:o.top+n.pageYOffset-t.clientTop,left:o.left+n.pageXOffset-t.clientLeft}):o):void 0},position:function(){if(this[0]){var e,t,n=this[0],i={top:0,left:0};return"fixed"===X.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),X.nodeName(e[0],"html")||(i=e.offset()),i.top+=X.css(e[0],"borderTopWidth",!0),i.left+=X.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-X.css(n,"marginTop",!0),left:t.left-i.left-X.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map((function(){for(var e=this.offsetParent||Lt;e&&!X.nodeName(e,"html")&&"static"===X.css(e,"position");)e=e.offsetParent;return e||Lt}))}}),X.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},(function(t,n){var i="pageYOffset"===n;X.fn[t]=function(o){return ue(this,(function(t,o,r){var a=D(t);return void 0===r?a?a[n]:t[o]:void(a?a.scrollTo(i?e.pageXOffset:r,i?r:e.pageYOffset):t[o]=r)}),t,o,arguments.length,null)}})),X.each(["top","left"],(function(e,t){X.cssHooks[t]=x(G.pixelPosition,(function(e,n){return n?(n=w(e,t),Fe.test(n)?X(e).position()[t]+"px":n):void 0}))})),X.each({Height:"height",Width:"width"},(function(e,t){X.each({padding:"inner"+e,content:t,"":"outer"+e},(function(n,i){X.fn[i]=function(i,o){var r=arguments.length&&(n||"boolean"!=typeof i),a=n||(!0===i||!0===o?"margin":"border");return ue(this,(function(t,n,i){var o;return X.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===i?X.css(t,n,a):X.style(t,n,i,a)}),t,r?i:void 0,r,null)}}))})),X.fn.size=function(){return this.length},X.fn.andSelf=X.fn.addBack;var It=e.jQuery,Bt=e.$;return X.noConflict=function(t){return e.$===X&&(e.$=Bt),t&&e.jQuery===X&&(e.jQuery=It),X},typeof t===we&&(e.jQuery=e.$=X),X}))},{}],lodash:[function(e,t,n){(function(e){(function(){function i(e,t){if(e!==t){var n=null===e,i=e===E,o=e==e,r=null===t,a=t===E,s=t==t;if(e>t&&!r||!o||n&&!a&&s||i&&s)return 1;if(t>e&&!n||!s||r&&!i&&o||a&&o)return-1}return 0}function o(e,t,n){for(var i=e.length,o=n?i:-1;n?o--:++o<i;)if(t(e[o],o,e))return o;return-1}function r(e,t,n){if(t!=t)return m(e,n);for(var i=n-1,o=e.length;++i<o;)if(e[i]===t)return i;return-1}function a(e){return"function"==typeof e||!1}function s(e){return null==e?"":e+""}function l(e,t){for(var n=-1,i=e.length;++n<i&&t.indexOf(e.charAt(n))>-1;);return n}function c(e,t){for(var n=e.length;n--&&t.indexOf(e.charAt(n))>-1;);return n}function d(e,t){return i(e.criteria,t.criteria)||e.index-t.index}function u(e,t,n){for(var o=-1,r=e.criteria,a=t.criteria,s=r.length,l=n.length;++o<s;){var c=i(r[o],a[o]);if(c){if(o>=l)return c;var d=n[o];return c*("asc"===d||!0===d?1:-1)}}return e.index-t.index}function h(e){return Qe[e]}function p(e){return We[e]}function f(e,t,n){return t?e=qe[e]:n&&(e=Ve[e]),"\\"+e}function v(e){return"\\"+Ve[e]}function m(e,t,n){for(var i=e.length,o=t+(n?0:-1);n?o--:++o<i;){var r=e[o];if(r!=r)return o}return-1}function g(e){return!!e&&"object"==typeof e}function y(e){return 160>=e&&e>=9&&13>=e||32==e||160==e||5760==e||6158==e||e>=8192&&(8202>=e||8232==e||8233==e||8239==e||8287==e||12288==e||65279==e)}function b(e,t){for(var n=-1,i=e.length,o=-1,r=[];++n<i;)e[n]===t&&(e[n]=Q,r[++o]=n);return r}function w(e){for(var t=-1,n=e.length;++t<n&&y(e.charCodeAt(t)););return t}function x(e){for(var t=e.length;t--&&y(e.charCodeAt(t)););return t}function P(e){return He[e]}var E,C="3.10.1",k=1,S=2,T=4,L=8,I=16,B=32,M=64,A=128,$=256,_=30,O="...",D=150,F=16,j=200,N=1,R=2,U="Expected a function",Q="__lodash_placeholder__",W="[object Arguments]",H="[object Array]",G="[object Boolean]",q="[object Date]",V="[object Error]",X="[object Function]",z="[object Map]",Y="[object Number]",J="[object Object]",Z="[object RegExp]",K="[object Set]",ee="[object String]",te="[object WeakMap]",ne="[object ArrayBuffer]",ie="[object Float32Array]",oe="[object Float64Array]",re="[object Int8Array]",ae="[object Int16Array]",se="[object Int32Array]",le="[object Uint8Array]",ce="[object Uint8ClampedArray]",de="[object Uint16Array]",ue="[object Uint32Array]",he=/\b__p \+= '';/g,pe=/\b(__p \+=) '' \+/g,fe=/(__e\(.*?\)|\b__t\)) \+\n'';/g,ve=/&(?:amp|lt|gt|quot|#39|#96);/g,me=/[&<>"'`]/g,ge=RegExp(ve.source),ye=RegExp(me.source),be=/<%-([\s\S]+?)%>/g,we=/<%([\s\S]+?)%>/g,xe=/<%=([\s\S]+?)%>/g,Pe=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,Ee=/^\w*$/,Ce=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,ke=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,Se=RegExp(ke.source),Te=/[\u0300-\u036f\ufe20-\ufe23]/g,Le=/\\(\\)?/g,Ie=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Be=/\w*$/,Me=/^0[xX]/,Ae=/^\[object .+?Constructor\]$/,$e=/^\d+$/,_e=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Oe=/($^)/,De=/['\n\r\u2028\u2029\\]/g,Fe=function(){var e="[A-Z\\xc0-\\xd6\\xd8-\\xde]",t="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(e+"+(?="+e+t+")|"+e+"?"+t+"|"+e+"+|[0-9]+","g")}(),je=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],Ne=-1,Re={};Re[ie]=Re[oe]=Re[re]=Re[ae]=Re[se]=Re[le]=Re[ce]=Re[de]=Re[ue]=!0,Re[W]=Re[H]=Re[ne]=Re[G]=Re[q]=Re[V]=Re[X]=Re[z]=Re[Y]=Re[J]=Re[Z]=Re[K]=Re[ee]=Re[te]=!1;var Ue={};Ue[W]=Ue[H]=Ue[ne]=Ue[G]=Ue[q]=Ue[ie]=Ue[oe]=Ue[re]=Ue[ae]=Ue[se]=Ue[Y]=Ue[J]=Ue[Z]=Ue[ee]=Ue[le]=Ue[ce]=Ue[de]=Ue[ue]=!0,Ue[V]=Ue[X]=Ue[z]=Ue[K]=Ue[te]=!1;var Qe={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},We={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},He={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},Ge={function:!0,object:!0},qe={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},Ve={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Xe=Ge[typeof n]&&n&&!n.nodeType&&n,ze=Ge[typeof t]&&t&&!t.nodeType&&t,Ye=Xe&&ze&&"object"==typeof e&&e&&e.Object&&e,Je=Ge[typeof self]&&self&&self.Object&&self,Ze=Ge[typeof window]&&window&&window.Object&&window,Ke=ze&&ze.exports===Xe&&Xe,et=Ye||Ze!==(this&&this.window)&&Ze||Je||this,tt=function e(t){function n(e){if(g(e)&&!Cr(e)&&!(e instanceof K)){if(e instanceof z)return e;if(zi.call(e,"__chain__")&&zi.call(e,"__wrapped__"))return Fn(e)}return new z(e)}function y(){}function z(e,t,n){this.__wrapped__=e,this.__actions__=n||[],this.__chain__=!!t}function K(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Eo,this.__views__=[]}function te(){this.__data__={}}function Qe(e){var t=e?e.length:0;for(this.data={hash:ho(null),set:new ro};t--;)this.push(e[t])}function We(e,t){var n=e.data;return("string"==typeof t||ui(t)?n.set.has(t):n.hash[t])?0:-1}function He(e,t){var n=-1,i=e.length;for(t||(t=Oi(i));++n<i;)t[n]=e[n];return t}function Ge(e,t){for(var n=-1,i=e.length;++n<i&&!1!==t(e[n],n,e););return e}function qe(e,t){for(var n=-1,i=e.length;++n<i;)if(!t(e[n],n,e))return!1;return!0}function Ve(e,t){for(var n=-1,i=e.length,o=-1,r=[];++n<i;){var a=e[n];t(a,n,e)&&(r[++o]=a)}return r}function Xe(e,t){for(var n=-1,i=e.length,o=Oi(i);++n<i;)o[n]=t(e[n],n,e);return o}function ze(e,t){for(var n=-1,i=t.length,o=e.length;++n<i;)e[o+n]=t[n];return e}function Ye(e,t,n,i){var o=-1,r=e.length;for(i&&r&&(n=e[++o]);++o<r;)n=t(n,e[o],o,e);return n}function Je(e,t){for(var n=-1,i=e.length;++n<i;)if(t(e[n],n,e))return!0;return!1}function Ze(e,t,n,i){return e!==E&&zi.call(i,n)?e:t}function Ke(e,t,n){for(var i=-1,o=Or(t),r=o.length;++i<r;){var a=o[i],s=e[a],l=n(s,t[a],a,e,t);(l==l?l===s:s!=s)&&(s!==E||a in e)||(e[a]=l)}return e}function nt(e,t){return null==t?e:ot(t,Or(t),e)}function it(e,t){for(var n=-1,i=null==e,o=!i&&En(e),r=o?e.length:0,a=t.length,s=Oi(a);++n<a;){var l=t[n];s[n]=o?Cn(l,r)?e[l]:E:i?E:e[l]}return s}function ot(e,t,n){n||(n={});for(var i=-1,o=t.length;++i<o;){var r=t[i];n[r]=e[r]}return n}function rt(e,t,n){var i=typeof e;return"function"==i?t===E?e:Ft(e,t,n):null==e?Bi:"object"==i?xt(e):t===E?_i(e):Pt(e,t)}function at(e,t,n,i,o,r,a){var s;if(n&&(s=o?n(e,i,o):n(e)),s!==E)return s;if(!ui(e))return e;var l=Cr(e);if(l){if(s=function(e){var t=e.length,n=new e.constructor(t);return t&&"string"==typeof e[0]&&zi.call(e,"index")&&(n.index=e.index,n.input=e.input),n}(e),!t)return He(e,s)}else{var c=Ji.call(e),d=c==X;if(c!=J&&c!=W&&(!d||o))return Ue[c]?function(e,t,n){var i=e.constructor;switch(t){case ne:return jt(e);case G:case q:return new i(+e);case ie:case oe:case re:case ae:case se:case le:case ce:case de:case ue:var o=e.buffer;return new i(n?jt(o):o,e.byteOffset,e.length);case Y:case ee:return new i(e);case Z:var r=new i(e.source,Be.exec(e));r.lastIndex=e.lastIndex}return r}(e,c,t):o?e:{};if(s=function(e){var t=e.constructor;return"function"==typeof t&&t instanceof t||(t=Ui),new t}(d?{}:e),!t)return nt(s,e)}r||(r=[]),a||(a=[]);for(var u=r.length;u--;)if(r[u]==e)return a[u];return r.push(e),a.push(s),(l?Ge:ft)(e,(function(i,o){s[o]=at(i,t,n,o,e,r,a)})),s}function st(e,t,n){if("function"!=typeof e)throw new Hi(U);return ao((function(){e.apply(E,n)}),t)}function lt(e,t){var n=e?e.length:0,i=[];if(!n)return i;var o=-1,a=bn(),s=a===r,l=s&&t.length>=j?Gt(t):null,c=t.length;l&&(a=We,s=!1,t=l);e:for(;++o<n;){var d=e[o];if(s&&d==d){for(var u=c;u--;)if(t[u]===d)continue e;i.push(d)}else a(t,d,0)<0&&i.push(d)}return i}function ct(e,t){var n=!0;return Mo(e,(function(e,i,o){return n=!!t(e,i,o)})),n}function dt(e,t){var n=[];return Mo(e,(function(e,i,o){t(e,i,o)&&n.push(e)})),n}function ut(e,t,n,i){var o;return n(e,(function(e,n,r){return t(e,n,r)?(o=i?n:e,!1):void 0})),o}function ht(e,t,n,i){i||(i=[]);for(var o=-1,r=e.length;++o<r;){var a=e[o];g(a)&&En(a)&&(n||Cr(a)||si(a))?t?ht(a,t,n,i):ze(i,a):n||(i[i.length]=a)}return i}function pt(e,t){return $o(e,t,Pi)}function ft(e,t){return $o(e,t,Or)}function vt(e,t){return _o(e,t,Or)}function mt(e,t){for(var n=-1,i=t.length,o=-1,r=[];++n<i;){var a=t[n];di(e[a])&&(r[++o]=a)}return r}function gt(e,t,n){if(null!=e){n!==E&&n in On(e)&&(t=[n]);for(var i=0,o=t.length;null!=e&&o>i;)e=e[t[i++]];return i&&i==o?e:E}}function yt(e,t,n,i,o,r){return e===t||(null==e||null==t||!ui(e)&&!g(t)?e!=e&&t!=t:function(e,t,n,i,o,r,a){var s=Cr(e),l=Cr(t),c=H,d=H;s||((c=Ji.call(e))==W?c=J:c!=J&&(s=gi(e))),l||((d=Ji.call(t))==W?d=J:d!=J&&(l=gi(t)));var u=c==J,h=d==J,p=c==d;if(p&&!s&&!u)return function(e,t,n){switch(n){case G:case q:return+e==+t;case V:return e.name==t.name&&e.message==t.message;case Y:return e!=+e?t!=+t:e==+t;case Z:case ee:return e==t+""}return!1}(e,t,c);if(!o){var f=u&&zi.call(e,"__wrapped__"),v=h&&zi.call(t,"__wrapped__");if(f||v)return n(f?e.value():e,v?t.value():t,i,o,r,a)}if(!p)return!1;r||(r=[]),a||(a=[]);for(var m=r.length;m--;)if(r[m]==e)return a[m]==t;r.push(e),a.push(t);var g=(s?vn:mn)(e,t,n,i,o,r,a);return r.pop(),a.pop(),g}(e,t,yt,n,i,o,r))}function bt(e,t,n){var i=t.length,o=i,r=!n;if(null==e)return!o;for(e=On(e);i--;){var a=t[i];if(r&&a[2]?a[1]!==e[a[0]]:!(a[0]in e))return!1}for(;++i<o;){var s=(a=t[i])[0],l=e[s],c=a[1];if(r&&a[2]){if(l===E&&!(s in e))return!1}else{var d=n?n(l,c,s):E;if(!(d===E?yt(c,l,n,!0):d))return!1}}return!0}function wt(e,t){var n=-1,i=En(e)?Oi(e.length):[];return Mo(e,(function(e,o,r){i[++n]=t(e,o,r)})),i}function xt(e){var t=wn(e);if(1==t.length&&t[0][2]){var n=t[0][0],i=t[0][1];return function(e){return null!=e&&(e[n]===i&&(i!==E||n in On(e)))}}return function(e){return bt(e,t)}}function Pt(e,t){var n=Cr(e),i=Sn(e)&&In(t),o=e+"";return e=Dn(e),function(r){if(null==r)return!1;var a=o;if(r=On(r),!(!n&&i||a in r)){if(null==(r=1==e.length?r:gt(r,Tt(e,0,-1))))return!1;a=Qn(e),r=On(r)}return r[a]===t?t!==E||a in r:yt(t,r[a],E,!0)}}function Et(e){return function(t){return null==t?E:t[e]}}function Ct(e,t){for(var n=e?t.length:0;n--;){var i=t[n];if(i!=o&&Cn(i)){var o=i;so.call(e,i,1)}}return e}function kt(e,t){return e+po(xo()*(t-e+1))}function St(e,t,n,i,o){return o(e,(function(e,o,r){n=i?(i=!1,e):t(n,e,o,r)})),n}function Tt(e,t,n){var i=-1,o=e.length;0>(t=null==t?0:+t||0)&&(t=-t>o?0:o+t),0>(n=n===E||n>o?o:+n||0)&&(n+=o),o=t>n?0:n-t>>>0,t>>>=0;for(var r=Oi(o);++i<o;)r[i]=e[i+t];return r}function Lt(e,t){var n;return Mo(e,(function(e,i,o){return!(n=t(e,i,o))})),!!n}function It(e,t){var n=e.length;for(e.sort(t);n--;)e[n]=e[n].value;return e}function Bt(e,t,n){var i=gn(),o=-1;t=Xe(t,(function(e){return i(e)}));var r=wt(e,(function(e){var n=Xe(t,(function(t){return t(e)}));return{criteria:n,index:++o,value:e}}));return It(r,(function(e,t){return u(e,t,n)}))}function Mt(e,t){var n=-1,i=bn(),o=e.length,a=i===r,s=a&&o>=j,l=s?Gt():null,c=[];l?(i=We,a=!1):(s=!1,l=t?[]:c);e:for(;++n<o;){var d=e[n],u=t?t(d,n,e):d;if(a&&d==d){for(var h=l.length;h--;)if(l[h]===u)continue e;t&&l.push(u),c.push(d)}else i(l,u,0)<0&&((t||s)&&l.push(u),c.push(d))}return c}function At(e,t){for(var n=-1,i=t.length,o=Oi(i);++n<i;)o[n]=e[t[n]];return o}function $t(e,t,n,i){for(var o=e.length,r=i?o:-1;(i?r--:++r<o)&&t(e[r],r,e););return n?Tt(e,i?0:r,i?r+1:o):Tt(e,i?r+1:0,i?o:r)}function _t(e,t){var n=e;n instanceof K&&(n=n.value());for(var i=-1,o=t.length;++i<o;){var r=t[i];n=r.func.apply(r.thisArg,ze([n],r.args))}return n}function Ot(e,t,n){var i=0,o=e?e.length:i;if("number"==typeof t&&t==t&&So>=o){for(;o>i;){var r=i+o>>>1,a=e[r];(n?t>=a:t>a)&&null!==a?i=r+1:o=r}return o}return Dt(e,t,Bi,n)}function Dt(e,t,n,i){t=n(t);for(var o=0,r=e?e.length:0,a=t!=t,s=null===t,l=t===E;r>o;){var c=po((o+r)/2),d=n(e[c]),u=d!==E,h=d==d;if(a)var p=h||i;else p=s?h&&u&&(i||null!=d):l?h&&(i||u):null!=d&&(i?t>=d:t>d);p?o=c+1:r=c}return yo(r,ko)}function Ft(e,t,n){if("function"!=typeof e)return Bi;if(t===E)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 3:return function(n,i,o){return e.call(t,n,i,o)};case 4:return function(n,i,o,r){return e.call(t,n,i,o,r)};case 5:return function(n,i,o,r,a){return e.call(t,n,i,o,r,a)}}return function(){return e.apply(t,arguments)}}function jt(e){var t=new eo(e.byteLength);return new lo(t).set(new lo(e)),t}function Nt(e,t,n){for(var i=n.length,o=-1,r=go(e.length-i,0),a=-1,s=t.length,l=Oi(s+r);++a<s;)l[a]=t[a];for(;++o<i;)l[n[o]]=e[o];for(;r--;)l[a++]=e[o++];return l}function Rt(e,t,n){for(var i=-1,o=n.length,r=-1,a=go(e.length-o,0),s=-1,l=t.length,c=Oi(a+l);++r<a;)c[r]=e[r];for(var d=r;++s<l;)c[d+s]=t[s];for(;++i<o;)c[d+n[i]]=e[r++];return c}function Ut(e,t){return function(n,i,o){var r=t?t():{};if(i=gn(i,o,3),Cr(n))for(var a=-1,s=n.length;++a<s;){var l=n[a];e(r,l,i(l,a,n),n)}else Mo(n,(function(t,n,o){e(r,t,i(t,n,o),o)}));return r}}function Qt(e){return ri((function(t,n){var i=-1,o=null==t?0:n.length,r=o>2?n[o-2]:E,a=o>2?n[2]:E,s=o>1?n[o-1]:E;for("function"==typeof r?(r=Ft(r,s,5),o-=2):o-=(r="function"==typeof s?s:E)?1:0,a&&kn(n[0],n[1],a)&&(r=3>o?E:r,o=1);++i<o;){var l=n[i];l&&e(t,l,r)}return t}))}function Wt(e,t){return function(n,i){var o=n?Fo(n):0;if(!Ln(o))return e(n,i);for(var r=t?o:-1,a=On(n);(t?r--:++r<o)&&!1!==i(a[r],r,a););return n}}function Ht(e){return function(t,n,i){for(var o=On(t),r=i(t),a=r.length,s=e?a:-1;e?s--:++s<a;){var l=r[s];if(!1===n(o[l],l,o))break}return t}}function Gt(e){return ho&&ro?new Qe(e):null}function qt(e){return function(t){for(var n=-1,i=Li(ki(t)),o=i.length,r="";++n<o;)r=e(r,i[n],n);return r}}function Vt(e){return function(){var t=arguments;switch(t.length){case 0:return new e;case 1:return new e(t[0]);case 2:return new e(t[0],t[1]);case 3:return new e(t[0],t[1],t[2]);case 4:return new e(t[0],t[1],t[2],t[3]);case 5:return new e(t[0],t[1],t[2],t[3],t[4]);case 6:return new e(t[0],t[1],t[2],t[3],t[4],t[5]);case 7:return new e(t[0],t[1],t[2],t[3],t[4],t[5],t[6])}var n=Bo(e.prototype),i=e.apply(n,t);return ui(i)?i:n}}function Xt(e){return function t(n,i,o){o&&kn(n,i,o)&&(i=E);var r=fn(n,e,E,E,E,E,E,i);return r.placeholder=t.placeholder,r}}function zt(e,t){return ri((function(n){var i=n[0];return null==i?i:(n.push(t),e.apply(E,n))}))}function Yt(e,t){return function(n,i,o){if(o&&kn(n,i,o)&&(i=E),1==(i=gn(i,o,3)).length){var r=function(e,t,n,i){for(var o=-1,r=e.length,a=i,s=a;++o<r;){var l=e[o],c=+t(l);n(c,a)&&(a=c,s=l)}return s}(n=Cr(n)?n:_n(n),i,e,t);if(!n.length||r!==t)return r}return function(e,t,n,i){var o=i,r=o;return Mo(e,(function(e,a,s){var l=+t(e,a,s);(n(l,o)||l===i&&l===r)&&(o=l,r=e)})),r}(n,i,e,t)}}function Jt(e,t){return function(n,i,r){if(i=gn(i,r,3),Cr(n)){var a=o(n,i,t);return a>-1?n[a]:E}return ut(n,i,e)}}function Zt(e){return function(t,n,i){return t&&t.length?o(t,n=gn(n,i,3),e):-1}}function Kt(e){return function(t,n,i){return ut(t,n=gn(n,i,3),e,!0)}}function en(e){return function(){for(var t,n=arguments.length,i=e?n:-1,o=0,r=Oi(n);e?i--:++i<n;){var a=r[o++]=arguments[i];if("function"!=typeof a)throw new Hi(U);!t&&z.prototype.thru&&"wrapper"==yn(a)&&(t=new z([],!0))}for(i=t?-1:n;++i<n;){var s=yn(a=r[i]),l="wrapper"==s?Do(a):E;t=l&&Tn(l[0])&&l[1]==(A|L|B|$)&&!l[4].length&&1==l[9]?t[yn(l[0])].apply(t,l[3]):1==a.length&&Tn(a)?t[s]():t.thru(a)}return function(){var e=arguments,i=e[0];if(t&&1==e.length&&Cr(i)&&i.length>=j)return t.plant(i).value();for(var o=0,a=n?r[o].apply(this,e):i;++o<n;)a=r[o].call(this,a);return a}}}function tn(e,t){return function(n,i,o){return"function"==typeof i&&o===E&&Cr(n)?e(n,i):t(n,Ft(i,o,3))}}function nn(e){return function(t,n,i){return("function"!=typeof n||i!==E)&&(n=Ft(n,i,3)),e(t,n,Pi)}}function on(e){return function(t,n,i){return("function"!=typeof n||i!==E)&&(n=Ft(n,i,3)),e(t,n)}}function rn(e){return function(t,n,i){var o={};return n=gn(n,i,3),ft(t,(function(t,i,r){var a=n(t,i,r);t=e?t:a,o[i=e?a:i]=t})),o}}function an(e){return function(t,n,i){return t=s(t),(e?t:"")+dn(t,n,i)+(e?"":t)}}function sn(e){var t=ri((function(n,i){var o=b(i,t.placeholder);return fn(n,e,E,i,o)}));return t}function ln(e,t){return function(n,i,o,r){var a=arguments.length<3;return"function"==typeof i&&r===E&&Cr(n)?e(n,i,o,a):St(n,gn(i,r,4),o,a,t)}}function cn(e,t,n,i,o,r,a,s,l,c){var d=t&A,u=t&k,h=t&S,p=t&L,f=t&T,v=t&I,m=h?E:Vt(e);return function g(){for(var y=arguments.length,w=y,x=Oi(y);w--;)x[w]=arguments[w];if(i&&(x=Nt(x,i,o)),r&&(x=Rt(x,r,a)),p||v){var P=g.placeholder,C=b(x,P);if(y-=C.length,c>y){var T=s?He(s):E,L=go(c-y,0),I=p?C:E,A=p?E:C,$=p?x:E,_=p?E:x;t|=p?B:M,t&=~(p?M:B),f||(t&=~(k|S));var O=[e,t,n,$,I,_,A,T,l,L],D=cn.apply(E,O);return Tn(e)&&jo(D,O),D.placeholder=P,D}}var F=u?n:this,j=h?F[e]:e;return s&&(x=An(x,s)),d&&l<x.length&&(x.length=l),this&&this!==et&&this instanceof g&&(j=m||Vt(e)),j.apply(F,x)}}function dn(e,t,n){var i=e.length;if(i>=(t=+t)||!vo(t))return"";var o=t-i;return Si(n=null==n?" ":n+"",uo(o/n.length)).slice(0,o)}function un(e,t,n,i){var o=t&k,r=Vt(e);return function t(){for(var a=-1,s=arguments.length,l=-1,c=i.length,d=Oi(c+s);++l<c;)d[l]=i[l];for(;s--;)d[l++]=arguments[++a];var u=this&&this!==et&&this instanceof t?r:e;return u.apply(o?n:this,d)}}function hn(e){var t=Ni[e];return function(e,n){return(n=n===E?0:+n||0)?(n=io(10,n),t(e*n)/n):t(e)}}function pn(e){return function(t,n,i,o){var r=gn(i);return null==i&&r===rt?Ot(t,n,e):Dt(t,n,r(i,o,1),e)}}function fn(e,t,n,i,o,r,a,s){var l=t&S;if(!l&&"function"!=typeof e)throw new Hi(U);var c=i?i.length:0;if(c||(t&=~(B|M),i=o=E),c-=o?o.length:0,t&M){var d=i,u=o;i=o=E}var h=l?E:Do(e),p=[e,t,n,i,o,d,u,r,a,s];if(h&&(function(e,t){var n=e[1],i=t[1],o=n|i,r=A>o,a=i==A&&n==L||i==A&&n==$&&e[7].length<=t[8]||i==(A|$)&&n==L;if(!r&&!a)return e;i&k&&(e[2]=t[2],o|=n&k?0:T);var s=t[3];if(s){var l=e[3];e[3]=l?Nt(l,s,t[4]):He(s),e[4]=l?b(e[3],Q):He(t[4])}(s=t[5])&&(l=e[5],e[5]=l?Rt(l,s,t[6]):He(s),e[6]=l?b(e[5],Q):He(t[6])),(s=t[7])&&(e[7]=He(s)),i&A&&(e[8]=null==e[8]?t[8]:yo(e[8],t[8])),null==e[9]&&(e[9]=t[9]),e[0]=t[0],e[1]=o}(p,h),t=p[1],s=p[9]),p[9]=null==s?l?0:e.length:go(s-c,0)||0,t==k)var f=function(e,t){var n=Vt(e);return function i(){return(this&&this!==et&&this instanceof i?n:e).apply(t,arguments)}}(p[0],p[2]);else f=t!=B&&t!=(k|B)||p[4].length?cn.apply(E,p):un.apply(E,p);return(h?Oo:jo)(f,p)}function vn(e,t,n,i,o,r,a){var s=-1,l=e.length,c=t.length;if(l!=c&&!(o&&c>l))return!1;for(;++s<l;){var d=e[s],u=t[s],h=i?i(o?u:d,o?d:u,s):E;if(h!==E){if(h)continue;return!1}if(o){if(!Je(t,(function(e){return d===e||n(d,e,i,o,r,a)})))return!1}else if(d!==u&&!n(d,u,i,o,r,a))return!1}return!0}function mn(e,t,n,i,o,r,a){var s=Or(e),l=s.length;if(l!=Or(t).length&&!o)return!1;for(var c=l;c--;){var d=s[c];if(!(o?d in t:zi.call(t,d)))return!1}for(var u=o;++c<l;){var h=e[d=s[c]],p=t[d],f=i?i(o?p:h,o?h:p,d):E;if(!(f===E?n(h,p,i,o,r,a):f))return!1;u||(u="constructor"==d)}if(!u){var v=e.constructor,m=t.constructor;if(v!=m&&"constructor"in e&&"constructor"in t&&!("function"==typeof v&&v instanceof v&&"function"==typeof m&&m instanceof m))return!1}return!0}function gn(e,t,i){var o=n.callback||Ii;return o=o===Ii?rt:o,i?o(e,t,i):o}function yn(e){for(var t=e.name+"",n=Io[t],i=n?n.length:0;i--;){var o=n[i],r=o.func;if(null==r||r==e)return o.name}return t}function bn(e,t,i){var o=n.indexOf||Un;return o=o===Un?r:o,e?o(e,t,i):o}function wn(e){for(var t=Ei(e),n=t.length;n--;)t[n][2]=In(t[n][1]);return t}function xn(e,t){var n=null==e?E:e[t];return hi(n)?n:E}function Pn(e,t,n){null==e||Sn(t,e)||(e=1==(t=Dn(t)).length?e:gt(e,Tt(t,0,-1)),t=Qn(t));var i=null==e?e:e[t];return null==i?E:i.apply(e,n)}function En(e){return null!=e&&Ln(Fo(e))}function Cn(e,t){return e="number"==typeof e||$e.test(e)?+e:-1,t=null==t?To:t,e>-1&&e%1==0&&t>e}function kn(e,t,n){if(!ui(n))return!1;var i=typeof t;if("number"==i?En(n)&&Cn(t,n.length):"string"==i&&t in n){var o=n[t];return e==e?e===o:o!=o}return!1}function Sn(e,t){var n=typeof e;return!!("string"==n&&Ee.test(e)||"number"==n)||!Cr(e)&&(!Pe.test(e)||null!=t&&e in On(t))}function Tn(e){var t=yn(e),i=n[t];if("function"!=typeof i||!(t in K.prototype))return!1;if(e===i)return!0;var o=Do(i);return!!o&&e===o[0]}function Ln(e){return"number"==typeof e&&e>-1&&e%1==0&&To>=e}function In(e){return e==e&&!ui(e)}function Bn(e,t){e=On(e);for(var n=-1,i=t.length,o={};++n<i;){var r=t[n];r in e&&(o[r]=e[r])}return o}function Mn(e,t){var n={};return pt(e,(function(e,i,o){t(e,i,o)&&(n[i]=e)})),n}function An(e,t){for(var n=e.length,i=yo(t.length,n),o=He(e);i--;){var r=t[i];e[i]=Cn(r,n)?o[r]:E}return e}function $n(e){for(var t=Pi(e),n=t.length,i=n&&e.length,o=!!i&&Ln(i)&&(Cr(e)||si(e)),r=-1,a=[];++r<n;){var s=t[r];(o&&Cn(s,i)||zi.call(e,s))&&a.push(s)}return a}function _n(e){return null==e?[]:En(e)?ui(e)?e:Ui(e):Ci(e)}function On(e){return ui(e)?e:Ui(e)}function Dn(e){if(Cr(e))return e;var t=[];return s(e).replace(Ce,(function(e,n,i,o){t.push(i?o.replace(Le,"$1"):n||e)})),t}function Fn(e){return e instanceof K?e.clone():new z(e.__wrapped__,e.__chain__,He(e.__actions__))}function jn(e,t,n){return(e?e.length:0)?((n?kn(e,t,n):null==t)&&(t=1),Tt(e,0>t?0:t)):[]}function Nn(e,t,n){var i=e?e.length:0;return i?((n?kn(e,t,n):null==t)&&(t=1),Tt(e,0,0>(t=i-(+t||0))?0:t)):[]}function Rn(e){return e?e[0]:E}function Un(e,t,n){var i=e?e.length:0;if(!i)return-1;if("number"==typeof n)n=0>n?go(i+n,0):n;else if(n){var o=Ot(e,t);return i>o&&(t==t?t===e[o]:e[o]!=e[o])?o:-1}return r(e,t,n||0)}function Qn(e){var t=e?e.length:0;return t?e[t-1]:E}function Wn(e){return jn(e,1)}function Hn(e,t,n,i){if(!(e?e.length:0))return[];null!=t&&"boolean"!=typeof t&&(n=kn(e,t,i=n)?E:t,t=!1);var o=gn();return(null!=n||o!==rt)&&(n=o(n,i,3)),t&&bn()===r?function(e,t){for(var n,i=-1,o=e.length,r=-1,a=[];++i<o;){var s=e[i],l=t?t(s,i,e):s;i&&n===l||(n=l,a[++r]=s)}return a}(e,n):Mt(e,n)}function Gn(e){if(!e||!e.length)return[];var t=-1,n=0;e=Ve(e,(function(e){return En(e)?(n=go(e.length,n),!0):void 0}));for(var i=Oi(n);++t<n;)i[t]=Xe(e,Et(t));return i}function qn(e,t,n){if(!(e?e.length:0))return[];var i=Gn(e);return null==t?i:(t=Ft(t,n,4),Xe(i,(function(e){return Ye(e,t,E,!0)})))}function Vn(e,t){var n=-1,i=e?e.length:0,o={};for(!i||t||Cr(e[0])||(t=[]);++n<i;){var r=e[n];t?o[r]=t[n]:r&&(o[r[0]]=r[1])}return o}function Xn(e){var t=n(e);return t.__chain__=!0,t}function zn(e,t,n){return t.call(n,e)}function Yn(e,t,n){var i=Cr(e)?qe:ct;return n&&kn(e,t,n)&&(t=E),("function"!=typeof t||n!==E)&&(t=gn(t,n,3)),i(e,t)}function Jn(e,t,n){return(Cr(e)?Ve:dt)(e,t=gn(t,n,3))}function Zn(e,t,n,i){var o=e?Fo(e):0;return Ln(o)||(o=(e=Ci(e)).length),n="number"!=typeof n||i&&kn(t,n,i)?0:0>n?go(o+n,0):n||0,"string"==typeof e||!Cr(e)&&mi(e)?o>=n&&e.indexOf(t,n)>-1:!!o&&bn(e,t,n)>-1}function Kn(e,t,n){return(Cr(e)?Xe:wt)(e,t=gn(t,n,3))}function ei(e,t,n){if(n?kn(e,t,n):null==t)return(i=(e=_n(e)).length)>0?e[kt(0,i-1)]:E;var i,o=-1,r=bi(e),a=(i=r.length)-1;for(t=yo(0>t?0:+t||0,i);++o<t;){var s=kt(o,a),l=r[s];r[s]=r[o],r[o]=l}return r.length=t,r}function ti(e,t,n){var i=Cr(e)?Je:Lt;return n&&kn(e,t,n)&&(t=E),("function"!=typeof t||n!==E)&&(t=gn(t,n,3)),i(e,t)}function ni(e,t){var n;if("function"!=typeof t){if("function"!=typeof e)throw new Hi(U);var i=e;e=t,t=i}return function(){return--e>0&&(n=t.apply(this,arguments)),1>=e&&(t=E),n}}function ii(e,t,n){function i(t,n){n&&to(n),l=h=p=E,t&&(f=dr(),c=e.apply(u,s),h||l||(s=u=E))}function o(){var e=t-(dr()-d);0>=e||e>t?i(p,l):h=ao(o,e)}function r(){i(m,h)}function a(){if(s=arguments,d=dr(),u=this,p=m&&(h||!g),!1===v)var n=g&&!h;else{l||g||(f=d);var i=v-(d-f),a=0>=i||i>v;a?(l&&(l=to(l)),f=d,c=e.apply(u,s)):l||(l=ao(r,i))}return a&&h?h=to(h):h||t===v||(h=ao(o,t)),n&&(a=!0,c=e.apply(u,s)),!a||h||l||(s=u=E),c}var s,l,c,d,u,h,p,f=0,v=!1,m=!0;if("function"!=typeof e)throw new Hi(U);if(t=0>t?0:+t||0,!0===n){var g=!0;m=!1}else ui(n)&&(g=!!n.leading,v="maxWait"in n&&go(+n.maxWait||0,t),m="trailing"in n?!!n.trailing:m);return a.cancel=function(){h&&to(h),l&&to(l),f=0,l=h=p=E},a}function oi(e,t){if("function"!=typeof e||t&&"function"!=typeof t)throw new Hi(U);var n=function(){var i=arguments,o=t?t.apply(this,i):i[0],r=n.cache;if(r.has(o))return r.get(o);var a=e.apply(this,i);return n.cache=r.set(o,a),a};return n.cache=new oi.Cache,n}function ri(e,t){if("function"!=typeof e)throw new Hi(U);return t=go(t===E?e.length-1:+t||0,0),function(){for(var n=arguments,i=-1,o=go(n.length-t,0),r=Oi(o);++i<o;)r[i]=n[t+i];switch(t){case 0:return e.call(this,r);case 1:return e.call(this,n[0],r);case 2:return e.call(this,n[0],n[1],r)}var a=Oi(t+1);for(i=-1;++i<t;)a[i]=n[i];return a[t]=r,e.apply(this,a)}}function ai(e,t){return e>t}function si(e){return g(e)&&En(e)&&zi.call(e,"callee")&&!oo.call(e,"callee")}function li(e,t,n,i){var o=(n="function"==typeof n?Ft(n,i,3):E)?n(e,t):E;return o===E?yt(e,t,n):!!o}function ci(e){return g(e)&&"string"==typeof e.message&&Ji.call(e)==V}function di(e){return ui(e)&&Ji.call(e)==X}function ui(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function hi(e){return null!=e&&(di(e)?Ki.test(Xi.call(e)):g(e)&&Ae.test(e))}function pi(e){return"number"==typeof e||g(e)&&Ji.call(e)==Y}function fi(e){var t,n;return!(!g(e)||Ji.call(e)!=J||si(e)||!(zi.call(e,"constructor")||(t=e.constructor,"function"!=typeof t||t instanceof t)))&&(pt(e,(function(e,t){n=t})),n===E||zi.call(e,n))}function vi(e){return ui(e)&&Ji.call(e)==Z}function mi(e){return"string"==typeof e||g(e)&&Ji.call(e)==ee}function gi(e){return g(e)&&Ln(e.length)&&!!Re[Ji.call(e)]}function yi(e,t){return t>e}function bi(e){var t=e?Fo(e):0;return Ln(t)?t?He(e):[]:Ci(e)}function wi(e){return ot(e,Pi(e))}function xi(e){return mt(e,Pi(e))}function Pi(e){if(null==e)return[];ui(e)||(e=Ui(e));var t=e.length;t=t&&Ln(t)&&(Cr(e)||si(e))&&t||0;for(var n=e.constructor,i=-1,o="function"==typeof n&&n.prototype===e,r=Oi(t),a=t>0;++i<t;)r[i]=i+"";for(var s in e)a&&Cn(s,t)||"constructor"==s&&(o||!zi.call(e,s))||r.push(s);return r}function Ei(e){e=On(e);for(var t=-1,n=Or(e),i=n.length,o=Oi(i);++t<i;){var r=n[t];o[t]=[r,e[r]]}return o}function Ci(e){return At(e,Or(e))}function ki(e){return(e=s(e))&&e.replace(_e,h).replace(Te,"")}function Si(e,t){var n="";if(e=s(e),1>(t=+t)||!e||!vo(t))return n;do{t%2&&(n+=e),t=po(t/2),e+=e}while(t);return n}function Ti(e,t,n){var i=e;return(e=s(e))?(n?kn(i,t,n):null==t)?e.slice(w(e),x(e)+1):(t+="",e.slice(l(e,t),c(e,t)+1)):e}function Li(e,t,n){return n&&kn(e,t,n)&&(t=E),(e=s(e)).match(t||Fe)||[]}function Ii(e,t,n){return n&&kn(e,t,n)&&(t=E),g(e)?Mi(e):rt(e,t)}function Bi(e){return e}function Mi(e){return xt(at(e,!0))}function Ai(e,t,n){if(null==n){var i=ui(t),o=i?Or(t):E,r=o&&o.length?mt(t,o):E;(r?r.length:i)||(r=!1,n=t,t=e,e=this)}r||(r=mt(t,Or(t)));var a=!0,s=-1,l=di(e),c=r.length;!1===n?a=!1:ui(n)&&"chain"in n&&(a=n.chain);for(;++s<c;){var d=r[s],u=t[d];e[d]=u,l&&(e.prototype[d]=function(t){return function(){var n=this.__chain__;if(a||n){var i=e(this.__wrapped__),o=i.__actions__=He(this.__actions__);return o.push({func:t,args:arguments,thisArg:e}),i.__chain__=n,i}return t.apply(e,ze([this.value()],arguments))}}(u))}return e}function $i(){}function _i(e){return Sn(e)?Et(e):function(e){var t=e+"";return e=Dn(e),function(n){return gt(n,e,t)}}(e)}var Oi=(t=t?tt.defaults(et.Object(),t,tt.pick(et,je)):et).Array,Di=t.Date,Fi=t.Error,ji=t.Function,Ni=t.Math,Ri=t.Number,Ui=t.Object,Qi=t.RegExp,Wi=t.String,Hi=t.TypeError,Gi=Oi.prototype,qi=Ui.prototype,Vi=Wi.prototype,Xi=ji.prototype.toString,zi=qi.hasOwnProperty,Yi=0,Ji=qi.toString,Zi=et._,Ki=Qi("^"+Xi.call(zi).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),eo=t.ArrayBuffer,to=t.clearTimeout,no=t.parseFloat,io=Ni.pow,oo=qi.propertyIsEnumerable,ro=xn(t,"Set"),ao=t.setTimeout,so=Gi.splice,lo=t.Uint8Array,co=xn(t,"WeakMap"),uo=Ni.ceil,ho=xn(Ui,"create"),po=Ni.floor,fo=xn(Oi,"isArray"),vo=t.isFinite,mo=xn(Ui,"keys"),go=Ni.max,yo=Ni.min,bo=xn(Di,"now"),wo=t.parseInt,xo=Ni.random,Po=Ri.NEGATIVE_INFINITY,Eo=Ri.POSITIVE_INFINITY,Co=4294967295,ko=Co-1,So=Co>>>1,To=9007199254740991,Lo=co&&new co,Io={};n.support={},n.templateSettings={escape:be,evaluate:we,interpolate:xe,variable:"",imports:{_:n}};var Bo=function(){function e(){}return function(t){if(ui(t)){e.prototype=t;var n=new e;e.prototype=E}return n||{}}}(),Mo=Wt(ft),Ao=Wt(vt,!0),$o=Ht(),_o=Ht(!0),Oo=Lo?function(e,t){return Lo.set(e,t),e}:Bi,Do=Lo?function(e){return Lo.get(e)}:$i,Fo=Et("length"),jo=function(){var e=0,t=0;return function(n,i){var o=dr(),r=F-(o-t);if(t=o,r>0){if(++e>=D)return n}else e=0;return Oo(n,i)}}(),No=ri((function(e,t){return g(e)&&En(e)?lt(e,ht(t,!1,!0)):[]})),Ro=Zt(),Uo=Zt(!0),Qo=ri((function(e){for(var t=e.length,n=t,i=Oi(u),o=bn(),a=o===r,s=[];n--;){var l=e[n]=En(l=e[n])?l:[];i[n]=a&&l.length>=120?Gt(n&&l):null}var c=e[0],d=-1,u=c?c.length:0,h=i[0];e:for(;++d<u;)if(l=c[d],(h?We(h,l):o(s,l,0))<0){for(n=t;--n;){var p=i[n];if((p?We(p,l):o(e[n],l,0))<0)continue e}h&&h.push(l),s.push(l)}return s})),Wo=ri((function(e,t){var n=it(e,t=ht(t));return Ct(e,t.sort(i)),n})),Ho=pn(),Go=pn(!0),qo=ri((function(e){return Mt(ht(e,!1,!0))})),Vo=ri((function(e,t){return En(e)?lt(e,t):[]})),Xo=ri(Gn),zo=ri((function(e){var t=e.length,n=t>2?e[t-2]:E,i=t>1?e[t-1]:E;return t>2&&"function"==typeof n?t-=2:(n=t>1&&"function"==typeof i?(--t,i):E,i=E),e.length=t,qn(e,n,i)})),Yo=ri((function(e){return e=ht(e),this.thru((function(t){return function(e,t){for(var n=-1,i=e.length,o=-1,r=t.length,a=Oi(i+r);++n<i;)a[n]=e[n];for(;++o<r;)a[n++]=t[o];return a}(Cr(t)?t:[On(t)],e)}))})),Jo=ri((function(e,t){return it(e,ht(t))})),Zo=Ut((function(e,t,n){zi.call(e,n)?++e[n]:e[n]=1})),Ko=Jt(Mo),er=Jt(Ao,!0),tr=tn(Ge,Mo),nr=tn((function(e,t){for(var n=e.length;n--&&!1!==t(e[n],n,e););return e}),Ao),ir=Ut((function(e,t,n){zi.call(e,n)?e[n].push(t):e[n]=[t]})),or=Ut((function(e,t,n){e[n]=t})),rr=ri((function(e,t,n){var i=-1,o="function"==typeof t,r=Sn(t),a=En(e)?Oi(e.length):[];return Mo(e,(function(e){var s=o?t:r&&null!=e?e[t]:E;a[++i]=s?s.apply(e,n):Pn(e,t,n)})),a})),ar=Ut((function(e,t,n){e[n?0:1].push(t)}),(function(){return[[],[]]})),sr=ln(Ye,Mo),lr=ln((function(e,t,n,i){var o=e.length;for(i&&o&&(n=e[--o]);o--;)n=t(n,e[o],o,e);return n}),Ao),cr=ri((function(e,t){if(null==e)return[];var n=t[2];return n&&kn(t[0],t[1],n)&&(t.length=1),Bt(e,ht(t),[])})),dr=bo||function(){return(new Di).getTime()},ur=ri((function(e,t,n){var i=k;if(n.length){var o=b(n,ur.placeholder);i|=B}return fn(e,i,t,n,o)})),hr=ri((function(e,t){for(var n=-1,i=(t=t.length?ht(t):xi(e)).length;++n<i;){var o=t[n];e[o]=fn(e[o],k,e)}return e})),pr=ri((function(e,t,n){var i=k|S;if(n.length){var o=b(n,pr.placeholder);i|=B}return fn(t,i,e,n,o)})),fr=Xt(L),vr=Xt(I),mr=ri((function(e,t){return st(e,1,t)})),gr=ri((function(e,t,n){return st(e,t,n)})),yr=en(),br=en(!0),wr=ri((function(e,t){if(t=ht(t),"function"!=typeof e||!qe(t,a))throw new Hi(U);var n=t.length;return ri((function(i){for(var o=yo(i.length,n);o--;)i[o]=t[o](i[o]);return e.apply(this,i)}))})),xr=sn(B),Pr=sn(M),Er=ri((function(e,t){return fn(e,$,E,E,E,ht(t))})),Cr=fo||function(e){return g(e)&&Ln(e.length)&&Ji.call(e)==H},kr=Qt((function e(t,n,i,o,r){if(!ui(t))return t;var a=En(n)&&(Cr(n)||gi(n)),s=a?E:Or(n);return Ge(s||n,(function(l,c){if(s&&(l=n[c=l]),g(l))o||(o=[]),r||(r=[]),function(e,t,n,i,o,r,a){for(var s=r.length,l=t[n];s--;)if(r[s]==l)return void(e[n]=a[s]);var c=e[n],d=o?o(c,l,n,e,t):E,u=d===E;u&&(d=l,En(l)&&(Cr(l)||gi(l))?d=Cr(c)?c:En(c)?He(c):[]:fi(l)||si(l)?d=si(c)?wi(c):fi(c)?c:{}:u=!1),r.push(l),a.push(d),u?e[n]=i(d,l,o,r,a):(d==d?d!==c:c==c)&&(e[n]=d)}(t,n,c,e,i,o,r);else{var d=t[c],u=i?i(d,l,c,t,n):E,h=u===E;h&&(u=l),u===E&&(!a||c in t)||!h&&(u==u?u===d:d!=d)||(t[c]=u)}})),t})),Sr=Qt((function(e,t,n){return n?Ke(e,t,n):nt(e,t)})),Tr=zt(Sr,(function(e,t){return e===E?t:e})),Lr=zt(kr,(function e(t,n){return t===E?n:kr(t,n,e)})),Ir=Kt(ft),Br=Kt(vt),Mr=nn($o),Ar=nn(_o),$r=on(ft),_r=on(vt),Or=mo?function(e){var t=null==e?E:e.constructor;return"function"==typeof t&&t.prototype===e||"function"!=typeof e&&En(e)?$n(e):ui(e)?mo(e):[]}:$n,Dr=rn(!0),Fr=rn(),jr=ri((function(e,t){if(null==e)return{};if("function"!=typeof t[0]){t=Xe(ht(t),Wi);return Bn(e,lt(Pi(e),t))}var n=Ft(t[0],t[1],3);return Mn(e,(function(e,t,i){return!n(e,t,i)}))})),Nr=ri((function(e,t){return null==e?{}:"function"==typeof t[0]?Mn(e,Ft(t[0],t[1],3)):Bn(e,ht(t))})),Rr=qt((function(e,t,n){return t=t.toLowerCase(),e+(n?t.charAt(0).toUpperCase()+t.slice(1):t)})),Ur=qt((function(e,t,n){return e+(n?"-":"")+t.toLowerCase()})),Qr=an(),Wr=an(!0),Hr=qt((function(e,t,n){return e+(n?"_":"")+t.toLowerCase()})),Gr=qt((function(e,t,n){return e+(n?" ":"")+(t.charAt(0).toUpperCase()+t.slice(1))})),qr=ri((function(e,t){try{return e.apply(E,t)}catch(e){return ci(e)?e:new Fi(e)}})),Vr=ri((function(e,t){return function(n){return Pn(n,e,t)}})),Xr=ri((function(e,t){return function(n){return Pn(e,n,t)}})),zr=hn("ceil"),Yr=hn("floor"),Jr=Yt(ai,Po),Zr=Yt(yi,Eo),Kr=hn("round");return n.prototype=y.prototype,z.prototype=Bo(y.prototype),z.prototype.constructor=z,K.prototype=Bo(y.prototype),K.prototype.constructor=K,te.prototype.delete=function(e){return this.has(e)&&delete this.__data__[e]},te.prototype.get=function(e){return"__proto__"==e?E:this.__data__[e]},te.prototype.has=function(e){return"__proto__"!=e&&zi.call(this.__data__,e)},te.prototype.set=function(e,t){return"__proto__"!=e&&(this.__data__[e]=t),this},Qe.prototype.push=function(e){var t=this.data;"string"==typeof e||ui(e)?t.set.add(e):t.hash[e]=!0},oi.Cache=te,n.after=function(e,t){if("function"!=typeof t){if("function"!=typeof e)throw new Hi(U);var n=e;e=t,t=n}return e=vo(e=+e)?e:0,function(){return--e<1?t.apply(this,arguments):void 0}},n.ary=function(e,t,n){return n&&kn(e,t,n)&&(t=E),t=e&&null==t?e.length:go(+t||0,0),fn(e,A,E,E,E,E,t)},n.assign=Sr,n.at=Jo,n.before=ni,n.bind=ur,n.bindAll=hr,n.bindKey=pr,n.callback=Ii,n.chain=Xn,n.chunk=function(e,t,n){t=(n?kn(e,t,n):null==t)?1:go(po(t)||1,1);for(var i=0,o=e?e.length:0,r=-1,a=Oi(uo(o/t));o>i;)a[++r]=Tt(e,i,i+=t);return a},n.compact=function(e){for(var t=-1,n=e?e.length:0,i=-1,o=[];++t<n;){var r=e[t];r&&(o[++i]=r)}return o},n.constant=function(e){return function(){return e}},n.countBy=Zo,n.create=function(e,t,n){var i=Bo(e);return n&&kn(e,t,n)&&(t=E),t?nt(i,t):i},n.curry=fr,n.curryRight=vr,n.debounce=ii,n.defaults=Tr,n.defaultsDeep=Lr,n.defer=mr,n.delay=gr,n.difference=No,n.drop=jn,n.dropRight=Nn,n.dropRightWhile=function(e,t,n){return e&&e.length?$t(e,gn(t,n,3),!0,!0):[]},n.dropWhile=function(e,t,n){return e&&e.length?$t(e,gn(t,n,3),!0):[]},n.fill=function(e,t,n,i){var o=e?e.length:0;return o?(n&&"number"!=typeof n&&kn(e,t,n)&&(n=0,i=o),function(e,t,n,i){var o=e.length;for(0>(n=null==n?0:+n||0)&&(n=-n>o?0:o+n),0>(i=i===E||i>o?o:+i||0)&&(i+=o),o=n>i?0:i>>>0,n>>>=0;o>n;)e[n++]=t;return e}(e,t,n,i)):[]},n.filter=Jn,n.flatten=function(e,t,n){var i=e?e.length:0;return n&&kn(e,t,n)&&(t=!1),i?ht(e,t):[]},n.flattenDeep=function(e){return(e?e.length:0)?ht(e,!0):[]},n.flow=yr,n.flowRight=br,n.forEach=tr,n.forEachRight=nr,n.forIn=Mr,n.forInRight=Ar,n.forOwn=$r,n.forOwnRight=_r,n.functions=xi,n.groupBy=ir,n.indexBy=or,n.initial=function(e){return Nn(e,1)},n.intersection=Qo,n.invert=function(e,t,n){n&&kn(e,t,n)&&(t=E);for(var i=-1,o=Or(e),r=o.length,a={};++i<r;){var s=o[i],l=e[s];t?zi.call(a,l)?a[l].push(s):a[l]=[s]:a[l]=s}return a},n.invoke=rr,n.keys=Or,n.keysIn=Pi,n.map=Kn,n.mapKeys=Dr,n.mapValues=Fr,n.matches=Mi,n.matchesProperty=function(e,t){return Pt(e,at(t,!0))},n.memoize=oi,n.merge=kr,n.method=Vr,n.methodOf=Xr,n.mixin=Ai,n.modArgs=wr,n.negate=function(e){if("function"!=typeof e)throw new Hi(U);return function(){return!e.apply(this,arguments)}},n.omit=jr,n.once=function(e){return ni(2,e)},n.pairs=Ei,n.partial=xr,n.partialRight=Pr,n.partition=ar,n.pick=Nr,n.pluck=function(e,t){return Kn(e,_i(t))},n.property=_i,n.propertyOf=function(e){return function(t){return gt(e,Dn(t),t+"")}},n.pull=function(){var e=arguments,t=e[0];if(!t||!t.length)return t;for(var n=0,i=bn(),o=e.length;++n<o;)for(var r=0,a=e[n];(r=i(t,a,r))>-1;)so.call(t,r,1);return t},n.pullAt=Wo,n.range=function(e,t,n){n&&kn(e,t,n)&&(t=n=E),e=+e||0,null==t?(t=e,e=0):t=+t||0;for(var i=-1,o=go(uo((t-e)/((n=null==n?1:+n||0)||1)),0),r=Oi(o);++i<o;)r[i]=e,e+=n;return r},n.rearg=Er,n.reject=function(e,t,n){var i=Cr(e)?Ve:dt;return t=gn(t,n,3),i(e,(function(e,n,i){return!t(e,n,i)}))},n.remove=function(e,t,n){var i=[];if(!e||!e.length)return i;var o=-1,r=[],a=e.length;for(t=gn(t,n,3);++o<a;){var s=e[o];t(s,o,e)&&(i.push(s),r.push(o))}return Ct(e,r),i},n.rest=Wn,n.restParam=ri,n.set=function(e,t,n){if(null==e)return e;for(var i=t+"",o=-1,r=(t=null!=e[i]||Sn(t,e)?[i]:Dn(t)).length,a=r-1,s=e;null!=s&&++o<r;){var l=t[o];ui(s)&&(o==a?s[l]=n:null==s[l]&&(s[l]=Cn(t[o+1])?[]:{})),s=s[l]}return e},n.shuffle=function(e){return ei(e,Eo)},n.slice=function(e,t,n){var i=e?e.length:0;return i?(n&&"number"!=typeof n&&kn(e,t,n)&&(t=0,n=i),Tt(e,t,n)):[]},n.sortBy=function(e,t,n){if(null==e)return[];n&&kn(e,t,n)&&(t=E);var i=-1;t=gn(t,n,3);var o=wt(e,(function(e,n,o){return{criteria:t(e,n,o),index:++i,value:e}}));return It(o,d)},n.sortByAll=cr,n.sortByOrder=function(e,t,n,i){return null==e?[]:(i&&kn(t,n,i)&&(n=E),Cr(t)||(t=null==t?[]:[t]),Cr(n)||(n=null==n?[]:[n]),Bt(e,t,n))},n.spread=function(e){if("function"!=typeof e)throw new Hi(U);return function(t){return e.apply(this,t)}},n.take=function(e,t,n){return(e?e.length:0)?((n?kn(e,t,n):null==t)&&(t=1),Tt(e,0,0>t?0:t)):[]},n.takeRight=function(e,t,n){var i=e?e.length:0;return i?((n?kn(e,t,n):null==t)&&(t=1),Tt(e,0>(t=i-(+t||0))?0:t)):[]},n.takeRightWhile=function(e,t,n){return e&&e.length?$t(e,gn(t,n,3),!1,!0):[]},n.takeWhile=function(e,t,n){return e&&e.length?$t(e,gn(t,n,3)):[]},n.tap=function(e,t,n){return t.call(n,e),e},n.throttle=function(e,t,n){var i=!0,o=!0;if("function"!=typeof e)throw new Hi(U);return!1===n?i=!1:ui(n)&&(i="leading"in n?!!n.leading:i,o="trailing"in n?!!n.trailing:o),ii(e,t,{leading:i,maxWait:+t,trailing:o})},n.thru=zn,n.times=function(e,t,n){if(1>(e=po(e))||!vo(e))return[];var i=-1,o=Oi(yo(e,Co));for(t=Ft(t,n,1);++i<e;)Co>i?o[i]=t(i):t(i);return o},n.toArray=bi,n.toPlainObject=wi,n.transform=function(e,t,n,i){var o=Cr(e)||gi(e);if(t=gn(t,i,4),null==n)if(o||ui(e)){var r=e.constructor;n=o?Cr(e)?new r:[]:Bo(di(r)?r.prototype:E)}else n={};return(o?Ge:ft)(e,(function(e,i,o){return t(n,e,i,o)})),n},n.union=qo,n.uniq=Hn,n.unzip=Gn,n.unzipWith=qn,n.values=Ci,n.valuesIn=function(e){return At(e,Pi(e))},n.where=function(e,t){return Jn(e,xt(t))},n.without=Vo,n.wrap=function(e,t){return fn(t=null==t?Bi:t,B,E,[e],[])},n.xor=function(){for(var e=-1,t=arguments.length;++e<t;){var n=arguments[e];if(En(n))var i=i?ze(lt(i,n),lt(n,i)):n}return i?Mt(i):[]},n.zip=Xo,n.zipObject=Vn,n.zipWith=zo,n.backflow=br,n.collect=Kn,n.compose=br,n.each=tr,n.eachRight=nr,n.extend=Sr,n.iteratee=Ii,n.methods=xi,n.object=Vn,n.select=Jn,n.tail=Wn,n.unique=Hn,Ai(n,n),n.add=function(e,t){return(+e||0)+(+t||0)},n.attempt=qr,n.camelCase=Rr,n.capitalize=function(e){return(e=s(e))&&e.charAt(0).toUpperCase()+e.slice(1)},n.ceil=zr,n.clone=function(e,t,n,i){return t&&"boolean"!=typeof t&&kn(e,t,n)?t=!1:"function"==typeof t&&(i=n,n=t,t=!1),"function"==typeof n?at(e,t,Ft(n,i,3)):at(e,t)},n.cloneDeep=function(e,t,n){return"function"==typeof t?at(e,!0,Ft(t,n,3)):at(e,!0)},n.deburr=ki,n.endsWith=function(e,t,n){t+="";var i=(e=s(e)).length;return n=n===E?i:yo(0>n?0:+n||0,i),(n-=t.length)>=0&&e.indexOf(t,n)==n},n.escape=function(e){return(e=s(e))&&ye.test(e)?e.replace(me,p):e},n.escapeRegExp=function(e){return(e=s(e))&&Se.test(e)?e.replace(ke,f):e||"(?:)"},n.every=Yn,n.find=Ko,n.findIndex=Ro,n.findKey=Ir,n.findLast=er,n.findLastIndex=Uo,n.findLastKey=Br,n.findWhere=function(e,t){return Ko(e,xt(t))},n.first=Rn,n.floor=Yr,n.get=function(e,t,n){var i=null==e?E:gt(e,Dn(t),t+"");return i===E?n:i},n.gt=ai,n.gte=function(e,t){return e>=t},n.has=function(e,t){if(null==e)return!1;var n=zi.call(e,t);if(!n&&!Sn(t)){if(null==(e=1==(t=Dn(t)).length?e:gt(e,Tt(t,0,-1))))return!1;t=Qn(t),n=zi.call(e,t)}return n||Ln(e.length)&&Cn(t,e.length)&&(Cr(e)||si(e))},n.identity=Bi,n.includes=Zn,n.indexOf=Un,n.inRange=function(e,t,n){return t=+t||0,n===E?(n=t,t=0):n=+n||0,e>=yo(t,n)&&e<go(t,n)},n.isArguments=si,n.isArray=Cr,n.isBoolean=function(e){return!0===e||!1===e||g(e)&&Ji.call(e)==G},n.isDate=function(e){return g(e)&&Ji.call(e)==q},n.isElement=function(e){return!!e&&1===e.nodeType&&g(e)&&!fi(e)},n.isEmpty=function(e){return null==e||(En(e)&&(Cr(e)||mi(e)||si(e)||g(e)&&di(e.splice))?!e.length:!Or(e).length)},n.isEqual=li,n.isError=ci,n.isFinite=function(e){return"number"==typeof e&&vo(e)},n.isFunction=di,n.isMatch=function(e,t,n,i){return n="function"==typeof n?Ft(n,i,3):E,bt(e,wn(t),n)},n.isNaN=function(e){return pi(e)&&e!=+e},n.isNative=hi,n.isNull=function(e){return null===e},n.isNumber=pi,n.isObject=ui,n.isPlainObject=fi,n.isRegExp=vi,n.isString=mi,n.isTypedArray=gi,n.isUndefined=function(e){return e===E},n.kebabCase=Ur,n.last=Qn,n.lastIndexOf=function(e,t,n){var i=e?e.length:0;if(!i)return-1;var o=i;if("number"==typeof n)o=(0>n?go(i+n,0):yo(n||0,i-1))+1;else if(n){var r=e[o=Ot(e,t,!0)-1];return(t==t?t===r:r!=r)?o:-1}if(t!=t)return m(e,o,!0);for(;o--;)if(e[o]===t)return o;return-1},n.lt=yi,n.lte=function(e,t){return t>=e},n.max=Jr,n.min=Zr,n.noConflict=function(){return et._=Zi,this},n.noop=$i,n.now=dr,n.pad=function(e,t,n){t=+t;var i=(e=s(e)).length;if(i>=t||!vo(t))return e;var o=(t-i)/2,r=po(o);return(n=dn("",uo(o),n)).slice(0,r)+e+n},n.padLeft=Qr,n.padRight=Wr,n.parseInt=function(e,t,n){return(n?kn(e,t,n):null==t)?t=0:t&&(t=+t),e=Ti(e),wo(e,t||(Me.test(e)?16:10))},n.random=function(e,t,n){n&&kn(e,t,n)&&(t=n=E);var i=null==e,o=null==t;if(null==n&&(o&&"boolean"==typeof e?(n=e,e=1):"boolean"==typeof t&&(n=t,o=!0)),i&&o&&(t=1,o=!1),e=+e||0,o?(t=e,e=0):t=+t||0,n||e%1||t%1){var r=xo();return yo(e+r*(t-e+no("1e-"+((r+"").length-1))),t)}return kt(e,t)},n.reduce=sr,n.reduceRight=lr,n.repeat=Si,n.result=function(e,t,n){var i=null==e?E:e[t];return i===E&&(null==e||Sn(t,e)||(i=null==(e=1==(t=Dn(t)).length?e:gt(e,Tt(t,0,-1)))?E:e[Qn(t)]),i=i===E?n:i),di(i)?i.call(e):i},n.round=Kr,n.runInContext=e,n.size=function(e){var t=e?Fo(e):0;return Ln(t)?t:Or(e).length},n.snakeCase=Hr,n.some=ti,n.sortedIndex=Ho,n.sortedLastIndex=Go,n.startCase=Gr,n.startsWith=function(e,t,n){return e=s(e),n=null==n?0:yo(0>n?0:+n||0,e.length),e.lastIndexOf(t,n)==n},n.sum=function(e,t,n){return n&&kn(e,t,n)&&(t=E),1==(t=gn(t,n,3)).length?function(e,t){for(var n=e.length,i=0;n--;)i+=+t(e[n])||0;return i}(Cr(e)?e:_n(e),t):function(e,t){var n=0;return Mo(e,(function(e,i,o){n+=+t(e,i,o)||0})),n}(e,t)},n.template=function(e,t,i){var o=n.templateSettings;i&&kn(e,t,i)&&(t=i=E),e=s(e),t=Ke(nt({},i||t),o,Ze);var r,a,l=Ke(nt({},t.imports),o.imports,Ze),c=Or(l),d=At(l,c),u=0,h=t.interpolate||Oe,p="__p += '",f=Qi((t.escape||Oe).source+"|"+h.source+"|"+(h===xe?Ie:Oe).source+"|"+(t.evaluate||Oe).source+"|$","g"),m="//# sourceURL="+("sourceURL"in t?t.sourceURL:"lodash.templateSources["+ ++Ne+"]")+"\n";e.replace(f,(function(t,n,i,o,s,l){return i||(i=o),p+=e.slice(u,l).replace(De,v),n&&(r=!0,p+="' +\n__e("+n+") +\n'"),s&&(a=!0,p+="';\n"+s+";\n__p += '"),i&&(p+="' +\n((__t = ("+i+")) == null ? '' : __t) +\n'"),u=l+t.length,t})),p+="';\n";var g=t.variable;g||(p="with (obj) {\n"+p+"\n}\n"),p=(a?p.replace(he,""):p).replace(pe,"$1").replace(fe,"$1;"),p="function("+(g||"obj")+") {\n"+(g?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(r?", __e = _.escape":"")+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var y=qr((function(){return ji(c,m+"return "+p).apply(E,d)}));if(y.source=p,ci(y))throw y;return y},n.trim=Ti,n.trimLeft=function(e,t,n){var i=e;return(e=s(e))?e.slice((n?kn(i,t,n):null==t)?w(e):l(e,t+"")):e},n.trimRight=function(e,t,n){var i=e;return(e=s(e))?(n?kn(i,t,n):null==t)?e.slice(0,x(e)+1):e.slice(0,c(e,t+"")+1):e},n.trunc=function(e,t,n){n&&kn(e,t,n)&&(t=E);var i=_,o=O;if(null!=t)if(ui(t)){var r="separator"in t?t.separator:r;i="length"in t?+t.length||0:i,o="omission"in t?s(t.omission):o}else i=+t||0;if(i>=(e=s(e)).length)return e;var a=i-o.length;if(1>a)return o;var l=e.slice(0,a);if(null==r)return l+o;if(vi(r)){if(e.slice(a).search(r)){var c,d,u=e.slice(0,a);for(r.global||(r=Qi(r.source,(Be.exec(r)||"")+"g")),r.lastIndex=0;c=r.exec(u);)d=c.index;l=l.slice(0,null==d?a:d)}}else if(e.indexOf(r,a)!=a){var h=l.lastIndexOf(r);h>-1&&(l=l.slice(0,h))}return l+o},n.unescape=function(e){return(e=s(e))&&ge.test(e)?e.replace(ve,P):e},n.uniqueId=function(e){var t=++Yi;return s(e)+t},n.words=Li,n.all=Yn,n.any=ti,n.contains=Zn,n.eq=li,n.detect=Ko,n.foldl=sr,n.foldr=lr,n.head=Rn,n.include=Zn,n.inject=sr,Ai(n,function(){var e={};return ft(n,(function(t,i){n.prototype[i]||(e[i]=t)})),e}(),!1),n.sample=ei,n.prototype.sample=function(e){return this.__chain__||null!=e?this.thru((function(t){return ei(t,e)})):ei(this.value())},n.VERSION=C,Ge(["bind","bindKey","curry","curryRight","partial","partialRight"],(function(e){n[e].placeholder=n})),Ge(["drop","take"],(function(e,t){K.prototype[e]=function(n){var i=this.__filtered__;if(i&&!t)return new K(this);n=null==n?1:go(po(n)||0,0);var o=this.clone();return i?o.__takeCount__=yo(o.__takeCount__,n):o.__views__.push({size:n,type:e+(o.__dir__<0?"Right":"")}),o},K.prototype[e+"Right"]=function(t){return this.reverse()[e](t).reverse()}})),Ge(["filter","map","takeWhile"],(function(e,t){var n=t+1,i=n!=R;K.prototype[e]=function(e,t){var o=this.clone();return o.__iteratees__.push({iteratee:gn(e,t,1),type:n}),o.__filtered__=o.__filtered__||i,o}})),Ge(["first","last"],(function(e,t){var n="take"+(t?"Right":"");K.prototype[e]=function(){return this[n](1).value()[0]}})),Ge(["initial","rest"],(function(e,t){var n="drop"+(t?"":"Right");K.prototype[e]=function(){return this.__filtered__?new K(this):this[n](1)}})),Ge(["pluck","where"],(function(e,t){var n=t?"filter":"map",i=t?xt:_i;K.prototype[e]=function(e){return this[n](i(e))}})),K.prototype.compact=function(){return this.filter(Bi)},K.prototype.reject=function(e,t){return e=gn(e,t,1),this.filter((function(t){return!e(t)}))},K.prototype.slice=function(e,t){e=null==e?0:+e||0;var n=this;return n.__filtered__&&(e>0||0>t)?new K(n):(0>e?n=n.takeRight(-e):e&&(n=n.drop(e)),t!==E&&(n=0>(t=+t||0)?n.dropRight(-t):n.take(t-e)),n)},K.prototype.takeRightWhile=function(e,t){return this.reverse().takeWhile(e,t).reverse()},K.prototype.toArray=function(){return this.take(Eo)},ft(K.prototype,(function(e,t){var i=/^(?:filter|map|reject)|While$/.test(t),o=/^(?:first|last)$/.test(t),r=n[o?"take"+("last"==t?"Right":""):t];r&&(n.prototype[t]=function(){var t=o?[1]:arguments,n=this.__chain__,a=this.__wrapped__,s=!!this.__actions__.length,l=a instanceof K,c=t[0],d=l||Cr(a);d&&i&&"function"==typeof c&&1!=c.length&&(l=d=!1);var u=function(e){return o&&n?r(e,1)[0]:r.apply(E,ze([e],t))},h={func:zn,args:[u],thisArg:E},p=l&&!s;if(o&&!n)return p?((a=a.clone()).__actions__.push(h),e.call(a)):r.call(E,this.value())[0];if(!o&&d){a=p?a:new K(this);var f=e.apply(a,t);return f.__actions__.push(h),new z(f,n)}return this.thru(u)})})),Ge(["join","pop","push","replace","shift","sort","splice","split","unshift"],(function(e){var t=(/^(?:replace|split)$/.test(e)?Vi:Gi)[e],i=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",o=/^(?:join|pop|replace|shift)$/.test(e);n.prototype[e]=function(){var e=arguments;return o&&!this.__chain__?t.apply(this.value(),e):this[i]((function(n){return t.apply(n,e)}))}})),ft(K.prototype,(function(e,t){var i=n[t];if(i){var o=i.name+"";(Io[o]||(Io[o]=[])).push({name:t,func:i})}})),Io[cn(E,S).name]=[{name:"wrapper",func:E}],K.prototype.clone=function(){var e=new K(this.__wrapped__);return e.__actions__=He(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=He(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=He(this.__views__),e},K.prototype.reverse=function(){if(this.__filtered__){var e=new K(this);e.__dir__=-1,e.__filtered__=!0}else(e=this.clone()).__dir__*=-1;return e},K.prototype.value=function(){var e=this.__wrapped__.value(),t=this.__dir__,n=Cr(e),i=0>t,o=n?e.length:0,r=function(e,t,n){for(var i=-1,o=n.length;++i<o;){var r=n[i],a=r.size;switch(r.type){case"drop":e+=a;break;case"dropRight":t-=a;break;case"take":t=yo(t,e+a);break;case"takeRight":e=go(e,t-a)}}return{start:e,end:t}}(0,o,this.__views__),a=r.start,s=r.end,l=s-a,c=i?s:a-1,d=this.__iteratees__,u=d.length,h=0,p=yo(l,this.__takeCount__);if(!n||j>o||o==l&&p==l)return _t(e,this.__actions__);var f=[];e:for(;l--&&p>h;){for(var v=-1,m=e[c+=t];++v<u;){var g=d[v],y=g.iteratee,b=g.type,w=y(m);if(b==R)m=w;else if(!w){if(b==N)continue e;break e}}f[h++]=m}return f},n.prototype.chain=function(){return Xn(this)},n.prototype.commit=function(){return new z(this.value(),this.__chain__)},n.prototype.concat=Yo,n.prototype.plant=function(e){for(var t,n=this;n instanceof y;){var i=Fn(n);t?o.__wrapped__=i:t=i;var o=i;n=n.__wrapped__}return o.__wrapped__=e,t},n.prototype.reverse=function(){var e=this.__wrapped__,t=function(e){return e.reverse()};if(e instanceof K){var n=e;return this.__actions__.length&&(n=new K(this)),(n=n.reverse()).__actions__.push({func:zn,args:[t],thisArg:E}),new z(n,this.__chain__)}return this.thru(t)},n.prototype.toString=function(){return this.value()+""},n.prototype.run=n.prototype.toJSON=n.prototype.valueOf=n.prototype.value=function(){return _t(this.__wrapped__,this.__actions__)},n.prototype.collect=n.prototype.map,n.prototype.head=n.prototype.first,n.prototype.select=n.prototype.filter,n.prototype.tail=n.prototype.rest,n}();Xe&&ze?Ke?(ze.exports=tt)._=tt:Xe._=tt:et._=tt}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],main:[function(e,t,n){var i,o=e("lodash"),r=e("jquery"),a=e("./app");t.exports=o.extend(o.object(o.map(["init","open","on","off","sendMessage","onMessage"],(function(e){var t=(i||(i=new a),i);return[e,function(){return t[e].apply(t,arguments)}]}))),{eventTypes:a.eventTypes,$:r})},{"./app":3,jquery:"jquery",lodash:"lodash"}]},{},["main"])("main")})),define("PoE/Shop/XsollaPaymentWidget",["plugins","PoE/Helpers","PoE/Backbone/EventBus","lib/xsolla/widget-1.0.7"],(function(e,t,n,i){return{purchaseDetails:!1,upgrade:!1,xps:!1,txn:!1,initPack:function(e,t){this.purchaseDetails=e,this.init(t)},initTxn:function(e,t){this.txn=e,this.init(t)},init:function(o){this.xps=i,this.sandbox=o;var r=this;e(".shopXsollaOptionContainer").removeClass("loading");var a=!1;e(".xsolla-purchase").click((function(i){n.trigger("shop.purchaseStart");var o=e(i.target).closest("div.shopXsollaOptionContainer"),s=o.find(".details"),l={xsollaMethod:o.data().xsollaMethod};r.txn?l.txn=r.txn:r.purchaseDetails&&(l.purchaseDetails=r.purchaseDetails),o.addClass("loading"),s.removeClass("error"),a=s.html(),s.html(a),e.ajax({url:"/shop/xsolla-purchase",data:JSON.stringify(l),contentType:"application/json",method:"POST",success:function(e){e.token?(token=e.token,r.xps.init({access_token:token,sandbox:r.sandbox}),r.xps.on(r.xps.eventTypes.STATUS_DONE,(function(e,t){t.paymentInfo.invoice&&("object"===_typeof(t.paymentInfo.invoice)?window.location.href="/shop/purchase-complete?completeType=xsolla&id="+t.paymentInfo.invoice.value:window.location.href="/shop/purchase-complete?completeType=xsolla&id="+t.paymentInfo.invoice)})),r.xps.open(),s.show()):(s.html(t.translate("Failed to create Xsolla transaction, please try again later or contact support@grindinggear.com")),s.addClass("error"))},error:function(e){s.html(t.translate("Failed to create Xsolla transaction, please try again later or contact support@grindinggear.com")),s.addClass("error")},complete:function(e){o.removeClass("loading"),n.trigger("shop.purchaseEnd")}})}))}}})),function(){if("function"==typeof window.CustomEvent)return!1;function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};let n=document.createEvent("CustomEvent");return n.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),n}e.prototype=window.Event.prototype,window.CustomEvent=e}(),define("custom-event",function(e){return function(){return e.CustomEvent}}(this)),define("PoE/View/Widget/Modal",["require","custom-event"],(function(e){return e("custom-event"),function(){function e(t,n,i){_classCallCheck(this,e),this.overlay=t,this.container=document.createElement("div"),this.container.id="poe-modal-container",this.content=!1,this.width=n,this.height=i,this.overlay.appendChild(this.container),this.delegateEvents(),this.hideEvent=new CustomEvent("hide",{cancelable:!0})}return _createClass(e,[{key:"delegateEvents",value:function(){var e=this;this.overlay.onclick=function(t){e.hide(),t.stopPropagation()},this.container.onclick=function(e){return e.stopPropagation()}}},{key:"show",value:function(e){this.content=e,this.container.appendChild(e),this.container.style.width=this.width,this.container.style.height=this.height,this.overlay.style.display="block"}},{key:"hide",value:function(){this.container.dispatchEvent(this.hideEvent),this.overlay.style.display="none",this.clear()}},{key:"clear",value:function(){this.container.innerHTML=""}}]),e}()})),define("PoE/View/Widget/ConfirmDialog",["require","PoE/View/Widget/Modal","Handlebars","es6-promise"],(function(e){var t=e("PoE/View/Widget/Modal"),n=e("Handlebars");return e("es6-promise"),function(){function e(n,i,o,r,a,s){_classCallCheck(this,e),this.modal=new t(n,a,s),this.title=i,this.confirmText=o,this.cancelText=r,this.messageClass="",this.container=document.createElement("div"),this.theme="poe",this.render()}return _createClass(e,[{key:"render",value:function(){var t=n.compile(e.template());this.container.innerHTML=t(this),this.buttonContainer=this.container.getElementsByClassName("confirm-buttons").item(0),this.cancelButton=this.container.getElementsByClassName("cancel").item(0),this.confirmButton=this.container.getElementsByClassName("confirm").item(0),this.messages=this.container.getElementsByClassName("messages").item(0),this.extraContainer=this.container.getElementsByClassName("extra").item(0),this.delegateEvents()}},{key:"clear",value:function(){this.message="",this.container.innerHTML="",this.render()}},{key:"error",value:function(e){this.messageClass="error",this.message=e,this.render()}},{key:"success",value:function(e){this.messageClass="success",this.message=e,this.render()}},{key:"loading",value:function(){this.buttonContainer.innerHTML='<div class="loading"></div>'}},{key:"hide",value:function(){this.modal.hide()}},{key:"delegateEvents",value:function(){var e=this;return this.promise=new Promise((function(t,n){e.cancelButton.onclick=function(){t(!1),e.hide()},e.confirmButton.onclick=function(){t(!0)},e.modal.container.addEventListener("hide",(function(){t(!1)}))})),this.promise}},{key:"confirm",value:function(e){var t=e.title,n=e.confirmText,i=e.cancelText,o=e.notes;return this.title=t||this.title,this.confirmText=n||this.confirmText,this.cancelText=i||this.cancelText,this.clear(),this.extraContainer.innerHTML=o&&o instanceof HTMLElement?o.outerHTML:o,this.modal.show(this.container),this.delegateEvents()}}],[{key:"template",value:function(){return'\n<div id="poe-confirm-dialog" class="{{theme}}">\n    <header class="dialog-header">{{title}}</header>\n    <div class="messages {{messageClass}}">{{{message}}}</div>\n    <div class="confirm-buttons">\n        <div class="button-text confirm">{{confirmText}}</div>\n        <div class="button-text red cancel">{{cancelText}}</div>\n    </div>\n    <div class="clear"></div>\n    <div class="extra"></div>\n</div>\n            '}}]),e}()})),"NodeList"in window&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=function(e,t){t=t||window;for(var n=0;n<this.length;n++)e.call(t,this[n],n,this)}),define("nodelist",(function(){})),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("fetch",["exports"],t):t(e.WHATWGFetch={})}(this,(function(e){"use strict";var t="URLSearchParams"in self,n="Symbol"in self&&"iterator"in Symbol,i="FileReader"in self&&"Blob"in self&&function(){try{return new Blob,!0}catch(e){return!1}}(),o="FormData"in self,r="ArrayBuffer"in self;if(r)var a=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],s=ArrayBuffer.isView||function(e){return e&&a.indexOf(Object.prototype.toString.call(e))>-1};function l(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");return e.toLowerCase()}function c(e){return"string"!=typeof e&&(e=String(e)),e}function d(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return n&&(t[Symbol.iterator]=function(){return t}),t}function u(e){this.map={},e instanceof u?e.forEach((function(e,t){this.append(t,e)}),this):Array.isArray(e)?e.forEach((function(e){this.append(e[0],e[1])}),this):e&&Object.getOwnPropertyNames(e).forEach((function(t){this.append(t,e[t])}),this)}function h(e){if(e.bodyUsed)return Promise.reject(new TypeError("Already read"));e.bodyUsed=!0}function p(e){return new Promise((function(t,n){e.onload=function(){t(e.result)},e.onerror=function(){n(e.error)}}))}function f(e){var t=new FileReader,n=p(t);return t.readAsArrayBuffer(e),n}function v(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function m(){return this.bodyUsed=!1,this._initBody=function(e){var n;this._bodyInit=e,e?"string"==typeof e?this._bodyText=e:i&&Blob.prototype.isPrototypeOf(e)?this._bodyBlob=e:o&&FormData.prototype.isPrototypeOf(e)?this._bodyFormData=e:t&&URLSearchParams.prototype.isPrototypeOf(e)?this._bodyText=e.toString():r&&i&&((n=e)&&DataView.prototype.isPrototypeOf(n))?(this._bodyArrayBuffer=v(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer])):r&&(ArrayBuffer.prototype.isPrototypeOf(e)||s(e))?this._bodyArrayBuffer=v(e):this._bodyText=e=Object.prototype.toString.call(e):this._bodyText="",this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):t&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},i&&(this.blob=function(){var e=h(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?h(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(f)}),this.text=function(){var e,t,n,i=h(this);if(i)return i;if(this._bodyBlob)return e=this._bodyBlob,t=new FileReader,n=p(t),t.readAsText(e),n;if(this._bodyArrayBuffer)return Promise.resolve(function(e){for(var t=new Uint8Array(e),n=new Array(t.length),i=0;i<t.length;i++)n[i]=String.fromCharCode(t[i]);return n.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},o&&(this.formData=function(){return this.text().then(b)}),this.json=function(){return this.text().then(JSON.parse)},this}u.prototype.append=function(e,t){e=l(e),t=c(t);var n=this.map[e];this.map[e]=n?n+", "+t:t},u.prototype.delete=function(e){delete this.map[l(e)]},u.prototype.get=function(e){return e=l(e),this.has(e)?this.map[e]:null},u.prototype.has=function(e){return this.map.hasOwnProperty(l(e))},u.prototype.set=function(e,t){this.map[l(e)]=c(t)},u.prototype.forEach=function(e,t){for(var n in this.map)this.map.hasOwnProperty(n)&&e.call(t,this.map[n],n,this)},u.prototype.keys=function(){var e=[];return this.forEach((function(t,n){e.push(n)})),d(e)},u.prototype.values=function(){var e=[];return this.forEach((function(t){e.push(t)})),d(e)},u.prototype.entries=function(){var e=[];return this.forEach((function(t,n){e.push([n,t])})),d(e)},n&&(u.prototype[Symbol.iterator]=u.prototype.entries);var g=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];function y(e,t){var n,i,o=(t=t||{}).body;if(e instanceof y){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new u(e.headers)),this.method=e.method,this.mode=e.mode,this.signal=e.signal,o||null==e._bodyInit||(o=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"same-origin",!t.headers&&this.headers||(this.headers=new u(t.headers)),this.method=(n=t.method||this.method||"GET",i=n.toUpperCase(),g.indexOf(i)>-1?i:n),this.mode=t.mode||this.mode||null,this.signal=t.signal||this.signal,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&o)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(o)}function b(e){var t=new FormData;return e.trim().split("&").forEach((function(e){if(e){var n=e.split("="),i=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");t.append(decodeURIComponent(i),decodeURIComponent(o))}})),t}function w(e,t){t||(t={}),this.type="default",this.status=void 0===t.status?200:t.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new u(t.headers),this.url=t.url||"",this._initBody(e)}y.prototype.clone=function(){return new y(this,{body:this._bodyInit})},m.call(y.prototype),m.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new u(this.headers),url:this.url})},w.error=function(){var e=new w(null,{status:0,statusText:""});return e.type="error",e};var x=[301,302,303,307,308];w.redirect=function(e,t){if(-1===x.indexOf(t))throw new RangeError("Invalid status code");return new w(null,{status:t,headers:{location:e}})},e.DOMException=self.DOMException;try{new e.DOMException}catch(t){e.DOMException=function(e,t){this.message=e,this.name=t;var n=Error(e);this.stack=n.stack},e.DOMException.prototype=Object.create(Error.prototype),e.DOMException.prototype.constructor=e.DOMException}function P(t,n){return new Promise((function(o,r){var a=new y(t,n);if(a.signal&&a.signal.aborted)return r(new e.DOMException("Aborted","AbortError"));var s=new XMLHttpRequest;function l(){s.abort()}s.onload=function(){var e,t,n={status:s.status,statusText:s.statusText,headers:(e=s.getAllResponseHeaders()||"",t=new u,e.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach((function(e){var n=e.split(":"),i=n.shift().trim();if(i){var o=n.join(":").trim();t.append(i,o)}})),t)};n.url="responseURL"in s?s.responseURL:n.headers.get("X-Request-URL");var i="response"in s?s.response:s.responseText;o(new w(i,n))},s.onerror=function(){r(new TypeError("Network request failed"))},s.ontimeout=function(){r(new TypeError("Network request failed"))},s.onabort=function(){r(new e.DOMException("Aborted","AbortError"))},s.open(a.method,a.url,!0),"include"===a.credentials?s.withCredentials=!0:"omit"===a.credentials&&(s.withCredentials=!1),"responseType"in s&&i&&(s.responseType="blob"),a.headers.forEach((function(e,t){s.setRequestHeader(t,e)})),a.signal&&(a.signal.addEventListener("abort",l),s.onreadystatechange=function(){4===s.readyState&&a.signal.removeEventListener("abort",l)}),s.send(void 0===a._bodyInit?null:a._bodyInit)}))}P.polyfill=!0,self.fetch||(self.fetch=P,self.Headers=u,self.Request=y,self.Response=w),e.Headers=u,e.Request=y,e.Response=w,e.fetch=P,Object.defineProperty(e,"__esModule",{value:!0})})),define("PoE/Shop/KakaoPaymentWidget",["require","PoE/View/Widget/ConfirmDialog","PoE/Backbone/EventBus","PoE/Helpers","es6-promise","nodelist","fetch"],(function(e){var t=e("PoE/View/Widget/ConfirmDialog"),n=e("PoE/Backbone/EventBus"),i=e("PoE/Helpers");return e("es6-promise"),e("nodelist"),e("fetch"),function(){function e(n,o){_classCallCheck(this,e),this.options=_objectSpread({},o),this.dialog=new t(n,i.translate("Would you like to proceed with the purchase?"),i.translate("Purchase"),i.translate("Cancel"),"500px","300px"),this.dialog.theme="kakao",this.loadDaumBalance()}return _createClass(e,[{key:"loginRequired",value:function(){this.dialog.confirm({title:i.translate("Login Required"),confirmText:i.translate("Login"),cancelText:i.translate("Cancel"),notes:" .  ?"}).then((function(e){e&&(window.location="/login?redir="+encodeURIComponent(window.location.pathname))}))}},{key:"accountRequired",value:function(){this.dialog.confirm({title:i.translate("Account Creation Required"),confirmText:i.translate("Create"),cancelText:i.translate("Cancel"),notes:"   "}).then((function(e){e&&(window.location="/login?redir="+encodeURIComponent(window.location.pathname))}))}},{key:"insufficientBalance",value:function(e){var t=this;this.dialog.confirm({title:i.translate("Insufficient Balance"),confirmText:i.translate("Top Up"),cancelText:i.translate("Cancel"),notes:"    .  ?"}).then((function(n){if(n){var i=window.top.outerHeight/2+window.top.screenY-350,o=window.top.outerWidth/2+window.top.screenX-250;window.open(e,"","height=".concat(700,",width=").concat(500,",top=").concat(i,",left=").concat(o,",scrollbars=1")),t.dialog.hide()}}))}},{key:"recharge",value:function(e){return this.options.hasKakao?this.options.hasAccount?(n.trigger("shop.purchaseStart"),e.disabled=!0,fetch("/shop/kakao-recharge",{headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"},method:"POST"}).then((function(e){if(e.ok)return e.json();throw new Error(e.statusText)})).then((function(e){if(e.chargeUrl){var t=window.top.outerHeight/2+window.top.screenY-200,n=window.top.outerWidth/2+window.top.screenX-150,i=window.open(e.chargeUrl,"recharge","height=".concat(400,",width=").concat(300,",top=").concat(t,",left=").concat(n,",scrollbars=1"));try{var o=!1;i.onload=function(){return o=!0},i.onunload=function(){o&&location.reload(!0)}}catch(e){}i.focus()}})).catch((function(e){alert(i.translate("An error occurred. Please try again later."))})).then((function(){n.trigger("shop.purchaseEnd"),e.disabled=!1})),!0):(this.accountRequired(),!0):(this.loginRequired(),!0)}},{key:"purchase",value:function(e){var t=this;if(!this.options.hasKakao)return this.loginRequired(),!0;if(!this.options.hasAccount)return this.accountRequired(),!0;if(e.shipping)return!1;var o=document.createElement("div");return o.innerHTML=this.disclaimer(),n.trigger("shop.purchaseStart"),this.dialog.confirm({title:i.translate("Would you like to proceed with the purchase?"),confirmText:i.translate("Purchase"),cancelText:i.translate("Cancel"),notes:o}).then((function(o){o&&(t.dialog.loading(),fetch("/shop/kakao-purchase",{headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}).then((function(e){if(e.ok)return e.json();throw new Error(e.statusText)})).then((function(e){e.success?(t.dialog.success(i.translate("Purchase Successful")),window.location=e.redirectUrl):e.chargeUrl?(t.dialog.hide(),t.insufficientBalance(e.chargeUrl)):e.errorMessage?(t.dialog.error(i.translate("Error")+": "+e.errorMessage),t.dialog.render()):t.dialog.render()}))),n.trigger("shop.purchaseEnd")})),!0}},{key:"loadDaumBalance",value:function(){var e=document.querySelector("#daumBal");e&&fetch("/api/daum-balance",{headers:{"X-Requested-With":"XMLHttpRequest","Content-Type":"application/json"},method:"POST"}).then((function(e){if(e.ok)return e.json();throw new Error(e.statusText)})).then((function(t){t.bal&&(e.innerHTML=t.bal+"")})).catch((function(t){e.classList.add("error"),e.innerHTML="",console.warn("Failed to fetch balance",t)})).then((function(){e.classList.remove("loading-inline")}))}},{key:"delegateEvents",value:function(){var e=this;document.querySelectorAll(".kakaoBuy").forEach((function(t){t.onclick=function(n){var i=t.getAttribute("data-purchaseInfo"),o={};if((o=i&&i.length>0?{token:i}:{packageID:t.getAttribute("data-packId")}).shipping=t.getAttribute("data-shipping"),e.purchase(o))return n.preventDefault(),!1}}));var t=document.querySelector("#kakaoRecharge");t&&(t.onclick=function(t){if(e.recharge(t.target))return t.preventDefault(),!1})}},{key:"disclaimer",value:function(){return""}}]),e}()})),define("text!PoE/Widget/League/EventCalendar/EventCalendar.hbt",[],(function(){return'<h1>{{translate \'Events Schedule\'}}</h1>\r\n{{#unless weeks}}\r\n<p class="description">{{translate \'There are no current events.\'}}</p>\r\n{{else}}\r\n<p class="description">{{translate \'Please note that the times on this schedule are shown in your local timezone.\'}}</p>\r\n<div class="entries">\r\n    <div class="header">\r\n        <div class="col"></div>\r\n        <div class="col">{{translate \'Monday\'}}</div>\r\n        <div class="col">{{translate \'Tuesday\'}}</div>\r\n        <div class="col">{{translate \'Wednesday\'}}</div>\r\n        <div class="col">{{translate \'Thursday\'}}</div>\r\n        <div class="col">{{translate \'Friday\'}}</div>\r\n        <div class="col">{{translate \'Saturday\'}}</div>\r\n        <div class="col">{{translate \'Sunday\'}}</div>\r\n    </div>\r\n    {{#each weeks}}\r\n    <div class="week">\r\n        <div class="periodsInfo">\r\n            <div class="label">{{moment startAt format=\'YYYY MMM\'}}</div>\r\n            <div class="periods">\r\n                {{#each periods}}\r\n                <div class="period" index="{{@index}}">\r\n                    {{#switch @root.realmRegion}}\r\n                    {{#case \'ru_RU\'}}{{moment this format=\'HH:mm\'}}{{/case}}\r\n                    {{#default}}{{moment this format=\'h:mm A\'}}{{/default}}\r\n                    {{/switch}}\r\n                </div>\r\n                {{/each}}\r\n            </div>\r\n        </div>\r\n        {{#each days}}\r\n        <div class="day">\r\n            {{#if @index}}\r\n            <div class="label">{{moment startAt format=\'D\'}}</div>\r\n            {{else}}\r\n            <div class="label first">{{moment startAt format=\'MMM D\'}}</div>\r\n            {{/if}}\r\n            <div class="periods">\r\n                {{#each periods}}\r\n                <div class="period" index="{{@index}}">{{#each this}}{{> event this}}{{/each}}</div>\r\n                {{/each}}\r\n            </div>\r\n        </div>\r\n        {{/each}}\r\n    </div>\r\n    {{/each}}\r\n</div>\r\n{{/unless}}'})),define("text!PoE/Widget/League/EventCalendar/Event.hbt",[],(function(){return'<div class="event{{#if inProgress}} inProgress{{/if}}{{#if complete}} complete{{/if}}">\r\n    {{#if url}}\r\n    <a href="{{url}}">{{id}}</a>\r\n    {{else}}\r\n    {{id}}\r\n    {{/if}}\r\n</div>'})),define("PoE/Collection/League/EventsCollection",["require","Backbone","jquery","PoE/Model/League/Event","moment-tz"],(function(e){var t=e("Backbone"),n=(e("jquery"),e("PoE/Model/League/Event")),i=e("moment-tz");return t.Collection.extend({model:n,sortByStartDate:function(){this.comparator=function(e,t){return e.get("startAt")&&t.get("startAt")?i(e.get("startAt")).diff(i(t.get("startAt"))):0},this.sort()}})})),define("PoE/Widget/League/EventCalendar/EventCalendar",["require","Backbone","moment-tz","Underscore","Handlebars","PoE/Handlebars/TemplateCollection","PoE/Helpers","text!PoE/Widget/League/EventCalendar/EventCalendar.hbt","text!PoE/Widget/League/EventCalendar/Event.hbt","PoE/Collection/League/EventsCollection"],(function(e){var t=e("Backbone"),n=e("moment-tz"),i=e("Underscore"),o=e("Handlebars"),r=e("PoE/Handlebars/TemplateCollection");e("PoE/Helpers");return e("text!PoE/Widget/League/EventCalendar/EventCalendar.hbt"),e("text!PoE/Widget/League/EventCalendar/Event.hbt"),e("PoE/Collection/League/EventsCollection"),t.View.extend({initialize:function(){var e=this;this.realm=this.options.realm?this.options.realm:"pc",this.realms=this.options.realms?this.options.realms:{},this.realmRegion=this.options.realmRegion?this.options.realmRegion:"ggg",this.startDay=1,this.$el.addClass("eventCalendar"),this.collection.season=this.model,this.collection.realm=this.realm,this.collection.sortByStartDate(),this.collection.on("update",(function(){return e.collection.sort()})),this.collection.on("sort",(function(){return e.render()}))},initElementRefs:function(){this.$entries=this.$el.find(".entries")},render:function(){var e=this,t=[];return t.push(r.load("PoE/Widget/League/EventCalendar/EventCalendar.hbt")),t.push(r.load("PoE/Widget/League/EventCalendar/Event.hbt")),$.when.apply($,t).done((function(t,n){o.registerPartial("event",n);var i={weeks:e.buildWeeks()};e.$el.html(t(i)),e.initElementRefs(),e.$entries.find(".week").each((function(e,t){var n=[];$(t).find("div > .periods > .period").each((function(e,t){var i=$(t).attr("index"),o=$(t).height();n[i]=Math.max(o,n[i]||0)})),$(t).find("div > .periods > .period").each((function(e,t){var i=$(t).attr("index");$(t).height(n[i])}))})),e.delegateEvents()}))},buildWeeks:function(){var e=this;if(this.collection.isEmpty())return[];var t=[],o=this.collection.first(),r=this.collection.last(),a=n(o.get("startAt")),s=n(r.get("startAt")),l=a.clone().day(0).hours(0).minutes(0).seconds(0).milliseconds(0);l.add(this.startDay,"days"),a.diff(l)<0&&l.add(-1,"weeks");var c=l.clone();c.add(1,"weeks");for(var d=function(){var o=e.collection.filter((function(e){return e.has("startAt")&&n(e.get("startAt")).isBetween(l,c)}));if(o.length){var r=e.collectMinutes(o),a=r.map((function(e){return l.clone().add(e,"minutes")})),s=[0,1,2,3,4,5,6].map((function(t){var a=l.clone().add(t,"days"),s=a.clone().add(1,"days"),c=i.chain(o).filter((function(e){return n(e.get("startAt")).isBetween(a,s)})).groupBy((function(t){return e.getEventMinutesOffset(t)})).value();return 0===Object.keys(c).length?{startAt:a,periods:[]}:{startAt:a,periods:r.map((function(e){return e in c?c[e].map((function(e){return e.toJSON()})):[]}))}}));t.push({startAt:l.clone(),endAt:c.clone(),periods:a,days:s})}l=c,(c=c.clone()).add(1,"weeks")};l.diff(s)<=0;)d();return t},getEventMinutesOffset:function(e){var t=n(e.get("startAt"));return 60*t.hours()+t.minutes()},collectMinutes:function(e){var t=this;return i.chain(e).map((function(e){return t.getEventMinutesOffset(e)})).sort().uniq(!0).value()}})})),define("PoE/Collection/League/Signature",["jquery","Backbone","PoE/Model/League/LadderEntry","PoE/Backbone/Paginator","./LadderEntries"],(function(e,t,n,i,o){return o.extend({paginator_core:{url:"/api/signature-ladders",dataType:"json"},server_api:{offset:function(){return(this.currentPage-1)*this.perPage},limit:function(){return this.perPage},id:function(){return this.id},characterClass:function(){return this.characterClass}},perPageOptions:[],parse:function(e){return e.limit&&(this.perPage=parseInt(e.limit,10)),e.id&&(this.id=e.id),e.characterClass&&(this.characterClass=e.characterClass),this.totalRecords=e.total,this.totalPages=Math.ceil(e.total/this.perPage),e.entries}})})),define("text!PoE/View/Season/ViewSignatureRaces.hbt",[],(function(){return'<div class="races">\r\n</div>\r\n'})),define("PoE/View/Season/ViewSignatureRaces",["require","plugins","Backbone","PoE/Handlebars/TemplateCollection","PoE/Collection/Season/Seasons","PoE/Collection/League/Signature","PoE/Widget/League/Ladder/Ladder","text!PoE/View/Season/ViewSignatureRaces.hbt"],(function(e){var t=e("plugins"),n=e("Backbone"),i=e("PoE/Handlebars/TemplateCollection"),o=(e("PoE/Collection/Season/Seasons"),e("PoE/Collection/League/Signature")),r=e("PoE/Widget/League/Ladder/Ladder");return e("text!PoE/View/Season/ViewSignatureRaces.hbt"),n.View.extend({initialize:function(){this.season=!!this.options.season&&this.options.season,this.$el.addClass("adminTheme1"),this.$races=null,this.classes=this.options.classes},render:function(){var e=this;i.load("PoE/View/Season/ViewSignatureRaces.hbt").done((function(n){for(var i in e.$el.html(n({})),e.delegateEvents(),e.$races=e.$el.find(".races"),e.$races.html(""),e.classes){var a=new o;a.id=e.season.get("id"),a.characterClass=e.classes[i],a.characterClassName=i,a.fetch({success:function(n){var i=new r({collection:n,title:n.characterClassName,unfilterable:!0});i.render().done((function(){i.$el.addClass("layoutBox1").addClass("layoutBoxFull").addClass("defaultTheme"),i.$el.find("h2").each((function(){t(this).replaceWith("<h1>"+t(this).html()+"</h1>")})),i.$el.find("h1").addClass("topBar").addClass("first").addClass("last").addClass("layoutBoxTitle")})),e.$races.append(i.el)}})}}))}})})),define("text!PoE/View/Season/PlayerHistory.hbt",[],(function(){return'<div class="row league">\r\n    <div class="name cell info">{{name}}</div>\r\n    <div class="points cell info">{{points}}</div>\r\n    <div class="rank cell info">\r\n        {{rank}}\r\n        {{#ifCond pinned \'===\' false}}\r\n        <a class="showcase-pin button add" data-type="{{#if pvp}}pvp_rank{{else}}event_rank{{/if}}" data-subtype="{{name}}"></a>\r\n        {{/ifCond}}\r\n    </div>\r\n</div>\r\n<div class="row trophy even">\r\n    {{#each trophies}}\r\n    <div class="name cell info">&gt; {{description}}</div>\r\n    <div class="points cell info">{{points}}</div>\r\n    {{/each}}\r\n</div>'})),define("PoE/View/Season/PlayerHistory",["require","plugins","Backbone","PoE/Handlebars/TemplateCollection","PoE/Helpers","text!PoE/View/Season/PlayerHistory.hbt"],(function(e){var t=e("plugins"),n=e("Backbone"),i=e("PoE/Handlebars/TemplateCollection"),o=e("PoE/Helpers");return e("text!PoE/View/Season/PlayerHistory.hbt"),n.View.extend({initialize:function(){},events:{"click .showcase-pin.add":"pin"},pin:function(e){var n=t(e.target);t.ajax({url:"/api/account/showcase-pins",dataType:"json",data:JSON.stringify(n.data()),contentType:"application/json",type:"POST",success:function(e){t(".showcase-message").length?t(".showcase-message").html(o.translate("Added pin")).animate({opacity:1},800,(function(){setTimeout((function(){t(".showcase-message").animate({opacity:0},1500)}),2e3)})):alert("Added pin")},error:function(e){alert(o.translate("There was an error adding this pin"))}})},render:function(){var e=this;return i.load("PoE/View/Season/PlayerHistory.hbt").done((function(t){var n=e.model.toJSON();n.rank=n.rank?n.rank:"-",n.pins=!!e.options.pins,e.$el.html(t(n))}))}})})),define("PoE/Model/Season/PlayerHistory",["require","Backbone","./Season"],(function(e){var t=e("Backbone"),n=e("./Season");return t.RelationalModel.extend({relations:[{type:t.HasOne,key:"season",relatedModel:n}]})})),define("PoE/Collection/Season/PlayerHistory",["require","Backbone","PoE/Model/Season/PlayerHistory","PoE/Backbone/Paginator"],(function(e){e("Backbone");var t=e("PoE/Model/Season/PlayerHistory");return e("PoE/Backbone/Paginator").extend({model:t,paginator_core:{url:"/api/season-player-history",dataType:"json"},paginator_ui:{firstPage:1,currentPage:1,perPage:5},server_api:{page:function(){return this.currentPage},perPage:function(){return this.perPage},seasonId:"",id:"",realm:""},perPageOptions:[5,10,20],parse:function(e){return this.totalRecords=e.total,this.totalPages=Math.ceil(this.totalRecords/this.perPage),e.entries}})})),define("text!PoE/View/Season/PlayerHistoryViewer.hbt",[],(function(){return'<div class="loading-inline">{{translate "Loading"}}...</div>\r\n\r\n{{#if showSeasonSelect}}\r\n<select name="seasons">\r\n    <option value=""></option>\r\n    {{#each seasons}}\r\n    <option value="{{id}}">{{name}}</option>\r\n    {{/each}}\r\n</select>\r\n<span class="loading-inline"></span>\r\n{{/if}}\r\n\r\n<div class="historyContainer">\r\n    <div class="history">\r\n        <div class="row heading">\r\n            <div class="name cell">{{translate "League"}}</div>\r\n            <div class="points cell">{{translate "Points"}}</div>\r\n            <div class="rank cell">{{translate "Rank"}}</div>\r\n        </div>\r\n    </div>\r\n</div>\r\n\r\n<div class="pagination"></div>'})),define("PoE/View/Season/PlayerHistoryViewer",["require","plugins","Backbone","PoE/Handlebars/TemplateCollection","PoE/View/Season/PlayerHistory","PoE/Collection/Season/Seasons","PoE/Collection/Season/PlayerHistory","PoE/View/Widget/Pagination","PoE/Helpers","text!PoE/View/Season/PlayerHistoryViewer.hbt"],(function(e){var t=e("plugins"),n=e("Backbone"),i=e("PoE/Handlebars/TemplateCollection"),o=e("PoE/View/Season/PlayerHistory"),r=e("PoE/Collection/Season/Seasons"),a=e("PoE/Collection/Season/PlayerHistory"),s=e("PoE/View/Widget/Pagination"),l=e("PoE/Helpers");return e("text!PoE/View/Season/PlayerHistoryViewer.hbt"),n.View.extend({initialize:function(){var e=this,n=t.Deferred();this.$el.addClass("playerHistoryViewer").addClass("table"),this.history=new a,this.history.server_api.id=this.model.get("name"),this.history.server_api.realm=this.model.get("realm"),this.pagination=new s({collection:this.history}),this.pins=!!this.options.pins,this.seasons=new r,this.options.pvp&&(this.seasons.url="/api/seasons?pvp=true"),this.deps=n.promise(),this.seasons.fetch({success:function(){n.resolve()}}),this.history.on("change",(function(){e.updateHistory()})),this.history.on("reset",(function(){e.updateHistory(),e.$el.find(".loading-inline").hide()}))},events:{'change select[name="seasons"]':"changeSeason"},changeSeason:function(e){var t=this;t.$loader.show(),this.history.server_api.seasonId=this.seasons.get(t.options.seasonId?t.options.seasonId:this.$seasons.val()).get("id"),this.history.fetch({success:function(){t.updateHistory(),t.$loader.hide()},error:function(){alert(l.translate("Failed to load history")),t.$loader.hide()}})},updateHistory:function(){var e=this;this.$history.children("div:not(:first)").remove(),this.history.each((function(t){var n=new o({model:t,pins:e.pins});n.render(),e.$history.append(n.$el)}))},render:function(){var e=this,n=t.Deferred();this.rendered=n.promise(),this.deps.done((function(){i.load("PoE/View/Season/PlayerHistoryViewer.hbt").done((function(t){var i={seasons:e.seasons.toJSON(),showSeasonSelect:!e.options.seasonId};e.$el.html(t(i)),e.delegateEvents(),e.$el.find(".pagination").replaceWith(e.pagination.el),e.$seasons=e.$el.find('select[name="seasons"]'),e.$loader=e.$el.find(".loading-inline").hide(),e.$history=e.$el.find(".history"),e.pagination.render(),e.pagination.delegateEvents(),n.resolve(),e.options.seasonId&&e.changeSeason()}))}))}})})),define("PoE/Model/Account/ShowcasePin",["Backbone"],(function(e){return e.RelationalModel.extend({relations:[]})})),define("PoE/Collection/Account/ShowcasePins",["jquery","Backbone","PoE/Model/Account/ShowcasePin","PoE/Backbone/Paginator"],(function(e,t,n,i){return i.extend({model:n,paginator_core:{url:"/api/account/showcase-pins",dataType:"json"},paginator_ui:{firstPage:1,currentPage:1,perPage:10,totalPages:10},server_api:{offset:function(){return(this.currentPage-1)*this.perPage},limit:function(){return this.perPage},account:"",realm:""},parse:function(e){return e.limit&&(this.perPage=parseInt(e.limit,10)),e.seasonId&&(this.server_api.id=e.seasonId),this.totalRecords=e.total,this.totalPages=Math.ceil(e.total/this.perPage),e.entries.map((function(e){return _objectSpread(_objectSpread(_objectSpread({},e),"character"===e.type?{deleteEvent:"unpin-character",deleteData:e.character}:{}),"achievement_count"===e.type?e.challenges?{deleteEvent:"unpin-challenges"}:{deleteEvent:"unpin-achievements"}:{})}))}})})),define("text!PoE/View/Profile/ShowcasePins.hbt",[],(function(){return'{{#if noResult}}\r\n{{#if ../curAccountProfile}}\r\n<div class="showcase-item">\r\n    <p><em>{{translate "Your showcase is empty. Click a {PIN} to pin a notable item here." PIN="<img src=\'/image/profile/pin.png\' />"}}</em></p>\r\n</div>\r\n{{/if}}\r\n{{else}}\r\n\r\n{{#each showcasePins}}\r\n<div class="showcase-item">\r\n    <img class="icon" src="{{icon}}" />\r\n\r\n    {{#if ../curAccountProfile}}\r\n    <div class="showcase-manage fr">\r\n        {{#if refreshable}}\r\n        <a class="button refresh" data-id="{{id}}" title="{{translate \'This pin can be refreshed to show changes since the pin was created\'}}"></a>\r\n        {{/if}}\r\n        <div class="showcase-move">\r\n            <a class="button up" data-id="{{id}}" data-direction="up"></a>\r\n            <a class="button down" data-id="{{id}}" data-direction="down"></a>\r\n        </div>\r\n        <a class="showcase-pin button delete" data-id="{{id}}"{{#if deleteEvent}} data-unpin-event="{{deleteEvent}}" data-unpin-data="{{deleteData}}"{{/if}}></a>\r\n    </div>\r\n    {{/if}}\r\n\r\n    <h2>{{label}}</h2>\r\n</div>\r\n{{/each}}\r\n\r\n{{/if}}'})),define("PoE/View/Profile/ShowcasePins",["require","plugins","Backbone","PoE/Handlebars/TemplateCollection","PoE/Collection/Account/ShowcasePins","PoE/Helpers","PoE/Backbone/EventBus","text!PoE/View/Profile/ShowcasePins.hbt"],(function(e){var t=e("plugins"),n=e("Backbone"),i=e("PoE/Handlebars/TemplateCollection"),o=e("PoE/Collection/Account/ShowcasePins"),r=e("PoE/Helpers"),a=e("PoE/Backbone/EventBus");return e("text!PoE/View/Profile/ShowcasePins.hbt"),n.View.extend({initialize:function(){var e=t.Deferred();this.messageTimer=!1,this.showcasepins=new o,this.deps=e.promise(),this.showcasepins.server_api.account=this.options.account,this.showcasepins.server_api.realm=this.options.realm,a.on("refresh-pins",this.refresh.bind(this)),this.showcasepins.fetch({success:function(){e.resolve()}})},events:{"click .showcase-pin.button.delete":"unpin","click .showcase-move .button":"move","click .button.refresh":"refreshPin"},callApi:function(e,n,i,o,r){return t.ajax({url:"/api/account/showcase-pins/"+e,dataType:"json",data:i?JSON.stringify(i):void 0,contentType:"application/json",type:n,success:o,error:r})},unpin:function(e){var n=this,i=t(e.target);i.hasClass("disabled")||this.callApi(i.data("id"),"DELETE",null,(function(){n.showMessage(r.translate("Deleted pin")),n.refresh();var e=i.data("unpin-event");if(e)if(a.trigger(e,i.data("unpin-data")),"unpin-character"===e){var o=i.data("unpin-data");t(".profile-box.characters .profile-character").each((function(){t(this).find(".characterName").text()===o&&t(this).find(".showcase-pin.button.add").show()}))}else"unpin-achievements"===e?t(".profile-box .achievements .showcase-pin.add").show():"unpin-challenges"===e&&t(".profile-box .challenges .showcase-pin.add").show()}),(function(){alert(r.translate("There was an error deleting this pin"))}))},move:function(e){var n=this,i=t(e.target);i.hasClass("disabled")||this.callApi(i.data("id"),"PUT",i.data(),(function(){n.showMessage(r.translate("Moved pin")),n.refresh()}),(function(){alert(r.translate("There was an error moving this pin"))}))},refresh:function(){var e=this;e.showcasepins.fetch({success:function(){e.render()}})},refreshPin:function(e){var n=this,i=t(e.target);this.callApi(i.data("id"),"PUT",_objectSpread(_objectSpread({},i.data()),{},{action:"refresh"}),(function(){n.showMessage(r.translate("Refreshed pin")),n.refresh()}),(function(){alert(r.translate("There was an error refreshing this pin"))}))},showMessage:function(e){var n=this,i=t(".showcase-message");i.html(e).animate({opacity:1},800,(function(){clearTimeout(n.messageTimer),n.messageTimer=setTimeout((function(){i.stop().animate({opacity:0},1500)}),2e3)}))},render:function(){var e=this;this.deps.done((function(){i.load("PoE/View/Profile/ShowcasePins.hbt").done((function(t){var n={showcasePins:e.showcasepins.toJSON(),curAccountProfile:e.options.curAccountProfile,noResult:0===e.showcasepins.totalRecords};e.$el.html(t(n)),e.$el.find(".showcase-move .up:first, .showcase-move .down:last").addClass("disabled")}))}))}})})),define("PoE/Form/Account/SignUpBase",["require","plugins","moment-tz"],(function(e){var t=e("plugins"),n=e("moment-tz");return function(e){var i=e instanceof t?e:t(e),o=i.find('input[name="submit"]');i.find('input[name="timezone"]').val(n.tz.guess()),i.submit((function(){return o.attr("disabled",!0).val("Loading..."),!0}))}})),define("PoE/Form/CaptchaRow",["require","plugins"],(function(e){var t=e("plugins");return function(e){var n=e.find(".row.captcha:not(.recaptcha)"),i=n.find("img"),o=n.find('input[name="captcha[id]"]'),r=t('<div class="refresh" title="Refresh captcha"></div>');n.find(".element").append(r),r.click((function(){t.ajax({url:"/default/account/refresh-captcha",dataType:"json",success:function(e){0!=e?(i.hide().attr("src","/gen/image/captcha/"+e+".png"),o.attr("value",e)):(0==t('input[name="captcha[input]"]').parent().find(".errors").length&&t('input[name="captcha[input]"]').parent().find(".refresh").after('<ul class="errors"></ul>'),t('input[name="captcha[input]"]').parent().find(".errors").html(""),t('input[name="captcha[input]"]').parent().find(".errors").append("<li>Too many captcha refresh requests, please wait</li>")),i.fadeIn()}})}))}})),define("PoE/Form/Account/SignUp",["require","plugins","PoE/Form/Account/SignUpBase","PoE/Form/CaptchaRow"],(function(e){var t=e("plugins"),n=e("PoE/Form/Account/SignUpBase"),i=e("PoE/Form/CaptchaRow");return function(){var e=t("#sign-up-container .layoutBoxContent"),o=t("#create_account"),r=t("#terms_of_use");n(o),i(o),t((function(){r.height(e.height())}))}})),define("PoE/Form/Account/LostPassword",["require","plugins","PoE/Form/CaptchaRow"],(function(e){var t=e("plugins"),n=e("PoE/Form/CaptchaRow");return function(){n(t("#lost_password"))}})),define("PoE/Form/Account/SteamSignUp",["require","plugins","PoE/Form/Account/SignUpBase"],(function(e){var t=e("plugins"),n=e("PoE/Form/Account/SignUpBase");return function(){var e=t("#create_account"),i=t("#sign-up-container .layoutBoxContent"),o=t("#terms_of_use");n(e),t((function(){o.height(i.height())}))}})),define("PoE/Profile/FollowAccount",["require","plugins","PoE/Helpers"],(function(e){var t=e("plugins"),n=e("PoE/Helpers");t("body").on("click",".uiFollowButton",(function(e){var i=t(this),o=i.data("name");e.preventDefault(),i.css("opacity",.4),t.ajax({url:"/api/follow/"+o,type:"PUT",success:function(e){i.removeClass("uiFollowButton").addClass("uiUnfollowButton");var t=n.translate("Unfollow {NAME}",{"{NAME}":o});i.attr("title",t),i.find("span").text(t)},error:function(e){},complete:function(){i.css("opacity","")}})})),t("body").on("click",".uiUnfollowButton",(function(e){var i=t(this),o=i.data("name");e.preventDefault(),i.css("opacity",.4),t.ajax({url:"/api/follow/"+o,type:"DELETE",success:function(e){i.removeClass("uiUnfollowButton").addClass("uiFollowButton");var t=n.translate("Follow {NAME}",{"{NAME}":o});i.attr("title",t),i.find("span").text(t)},error:function(e){},complete:function(){i.css("opacity","")}})}))})),define("PoE/Inventory/LinkedStashTab",["plugins","Backbone","PoE/Handlebars/TemplateCollection","./StashPanel"],(function(e,t,n,i){})),define("PoE/Inventory/LinkedStashRenderer",["plugins","Backbone","./LinkedStashTab"],(function(e,t,n){return!1})),define("PoE/Widget/GuildStashHistory/Viewer",["require","es6-promise","vue","vuex","plugins","Underscore","moment","PoE/Helpers","vue-flatpickr"],(function(e){e("es6-promise");var t=e("vue"),n=e("vuex"),i=e("plugins"),o=(e("Underscore"),e("moment")),r=e("PoE/Helpers"),a=e("vue-flatpickr");t.use(n);var s={state:{guildId:null,range:{startAt:null,endAt:null},entries:[],fetching:!1,progress:0},mutations:{setCurrentHistory:function(e,t){e.range=t.range,e.entries=t.entries},resetCurrentHistory:function(e){e.range={startAt:null,endAt:null},e.entries=[]},setFetching:function(e,t){var n=t.fetching,i=t.progress;e.fetching=n,e.progress=Math.max(Math.min(i,100),0)},setGuildId:function(e,t){e.guildId=t}},actions:{fetch:function(e,t){return new Promise((function(n,o){if(e.state.guildId){if(!e.state.fetching){e.commit("setFetching",{fetching:!0,progress:0}),e.commit("setCurrentHistory",{entries:[],range:{startAt:t.startAt,endAt:t.endAt}});var r=[],a=0;!function o(s,l,c){var d={from:l,end:c};s&&(d.fromid=s),i.ajax({url:"/api/guild/"+e.state.guildId+"/stash/history",method:"get",cache:"false",data:d}).done((function(i){var s=i.entries,l=i.truncated;if(r.push.apply(r,_toConsumableArray(s)),s.length&&l){var d=s[s.length-1],u=Math.abs(t.startAt-t.endAt),h=Math.abs(t.startAt-d.time),p=u?Math.floor(h/u*100):100;e.commit("setFetching",{fetching:!0,progress:p});var f=1.04*a++*250;setTimeout((function(){o(d.id,d.time,c)}),f)}else n(r)})).fail((function(e,t,i){console.error(i),n(r)}))}(null,t.startAt,t.endAt)}}else o("No guild id")})).then((function(n){e.commit("setCurrentHistory",{entries:n,range:{startAt:t.startAt,endAt:t.endAt}})})).finally((function(){e.commit("setFetching",{fetching:!0,progress:100}),setTimeout((function(){e.commit("setFetching",{fetching:!1,progress:0})}),400)}))}}},l=new n.Store({strict:!0,modules:{history:s}});return function(e){t.component("flat-pickr",a),t.mixin({methods:{translate:r.translate,distUrl:r.distUrl,unixToDate:function(e){return o.unix(e).calendar()}}});var n=new Date;n.setHours(23,59,59);var i=new Date;i.setHours(0,0,0),window.app=new t({store:l,data:{debug:e.debug||!1,datePickerConfig:{mode:"range",defaultHour:23,defaultMinute:59,defaultDate:[n,i],closeOnSelect:!0,maxDate:n,parseDate:function(e,t,n){return new Date(e)}}},computed:{history:function(){return this.$store.state.history},date:function(){var e=this.history.range;return[e.startAt?new Date(1e3*e.startAt):n,e.endAt?new Date(1e3*e.endAt):i]},csv:function(){var e=this.history.entries,t=this.$refs.table;if(0===e.length||!t)return null;var n=[];n.push(Array.from(t.querySelectorAll("thead > tr > th")).map((function(e){return e.textContent})).join(","));var i,o=_createForOfIteratorHelper(e);try{for(o.s();!(i=o.n()).done;){var r;entry=i.value,n.push([new Date(1e3*entry.time).toLocaleString(),entry.league,null===(r=entry.account)||void 0===r?void 0:r.name,this.translate(entry.action),entry.stash,entry.item].map((function(e){return"string"==typeof e?'"'.concat(e.replace('"','""'),'"'):""})).join(","))}}catch(e){o.e(e)}finally{o.f()}var a=new Blob([new Uint8Array([239,187,191]),n.join("\r\n")],{encoding:"UTF-8",type:"text/csv;charset=UTF-8"});return window.URL.createObjectURL(a)},csvName:function(){return"GuildStashHistory.csv"}},methods:{reset:function(){this.$store.commit("resetCurrentHistory"),this.updateDate([i,n])},updateDate:function(e){2===e.length&&(e[1].setHours(23,59,59),e[0].setHours(0,0,0),this.$store.dispatch("fetch",{startAt:Math.floor(e[1].getTime()/1e3),endAt:Math.floor(e[0].getTime()/1e3)}))}},created:function(){this.$store.commit("setGuildId",e.guildId||null)},mounted:function(){this.updateDate([i,n])}}),window.app.$mount("#guild-stash-history-viewer")}})),define("PoE/Collection/PrivateLeague/Members",["require","PoE/Backbone/Paginator"],(function(e){return e("PoE/Backbone/Paginator").extend({start:"",end:"",paginator_core:{url:function(){var e=this.privateLeague.selectedRole?"&role="+this.privateLeague.selectedRole:"",t=this.privateLeague.search||""==this.privateLeague.search?"&search="+this.privateLeague.search:"";return"/api/private-league-member/"+this.privateLeague.id+"?sort="+this.privateLeague.selectedSort+e+t},dataType:"json"},paginator_ui:{firstPage:1,currentPage:1,perPage:20,totalPages:10},server_api:{offset:function(){return(this.currentPage-1)*this.perPage},limit:function(){return this.perPage}},perPageOptions:[5,20,50,100],parse:function(e){return e.limit&&(this.perPage=parseInt(e.limit,10)),this.totalRecords=e.total,this.totalPages=Math.ceil(e.total/this.perPage),this.invitation=e.invitation,this.editable=e.editable,this.roles=e.roles,this.eligibleAccounts=e.eligibleAccounts,e.members}})})),define("text!PoE/View/PrivateLeague/Member.hbt",[],(function(){return'<div class="">\r\n    {{memberName}}\r\n</div>\r\n<div class="right half">\r\n    {{#if isAcceptable}}\r\n    <div class="row"><label for="accept_request_{{id}}">{{ translate \'Accept\' }}</label>\r\n        <div class="element">\r\n            <input type="checkbox" id="accept_request_{{id}}" name="accept" value="{{id}}"> </div>\r\n    </div>\r\n\r\n    {{/if}}\r\n    {{#if promote}}\r\n    <div class="row"><label for="promote_{{id}}">{{ translate \'Promote\' }}</label>\r\n        <div class="element">\r\n            <input type="checkbox" id="promote_{{id}}" name="promote" value="{{id}}">\r\n        </div>\r\n    </div>\r\n    {{/if}}\r\n    {{#if makeOwner}}\r\n    <div class="row"><label for="owner_{{id}}">{{ translate \'Make Owner\' }}</label>\r\n        <div class="element">\r\n            <input type="checkbox" id="owner_{{id}}" class="make-owner" name="owner" value="{{id}}">\r\n        </div>\r\n    </div>\r\n    {{/if}}\r\n</div>\r\n<div class="right">\r\n    <div class="{{privateLeagueRoleClassName role}} role">\r\n        {{roleName}}\r\n    </div>\r\n    <div class="remove">\r\n        {{#if isAcceptable}}\r\n        <div class="element">\r\n            <input type="checkbox" id="deny_request_{{id}}" name="deny" value="{{id}}">\r\n        </div>\r\n        {{/if}}\r\n        {{#if isRemovable}}\r\n        <div class="element">\r\n            <input type="checkbox" id="remove_{{id}}" name="remove" value="{{id}}">\r\n        </div>\r\n        {{/if}}\r\n    </div>\r\n</div>'})),define("PoE/Model/PrivateLeague/Member",["require","jquery","Backbone","PoE/Handlebars/TemplateCollection","PoE/Helpers","text!PoE/View/PrivateLeague/Member.hbt"],(function(e){e("jquery");var t=e("Backbone"),n=e("PoE/Handlebars/TemplateCollection");return e("PoE/Helpers"),e("text!PoE/View/PrivateLeague/Member.hbt"),t.View.extend({initialize:function(){this.$el.addClass("member-row")},events:{"change input.make-owner":"makeOwner"},makeOwner:function(e){e.preventDefault(),this.trigger("selectOneOwner",this.model)},render:function(){var e=this;n.load("PoE/View/PrivateLeague/Member.hbt").done((function(t){var n=e.model.toJSON();e.$el.html(t(n)),e.delegateEvents()}))}})})),define("text!PoE/View/PrivateLeague/Members.hbt",[],(function(){return'<form class="t1 manage-member">\r\n    <div class="custom-leagues-member-filter FontinSmallCaps">\r\n        {{#ifCond editable "===" true}}\r\n        <div>\r\n            <label>{{ translate \'Search\' }}</label>\r\n            <input type="search" class="search" placeholder="{{ translate \'Type Account Name\' }}" />\r\n            <button class="red search-name">{{ translate \'Go\' }}</button>\r\n        </div>\r\n        {{/ifCond}}\r\n        <div class="filter-role-container">\r\n        </div>\r\n    </div>\r\n    <div class="custom-leagues-member-filter FontinSmallCaps">\r\n        <div class="total-count"></div>\r\n    </div>\r\n    <div class="member-list-header">\r\n        <div class="member-row">\r\n            <div class="left">\r\n                <a class="update-sort name">\r\n                    {{ translate \'Name\' }}\r\n                </a>\r\n            </div>\r\n            <div class="right">\r\n                <a class="update-sort arrow-up">\r\n                    {{ translate \'Role\' }}\r\n                </a>\r\n                {{#ifCond editable "==" true}}\r\n                <span class="remove">\r\n                    {{ translate \'Remove\' }}\r\n                </span>\r\n                {{/ifCond}}\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <div class="member-list">\r\n    </div>\r\n    <div class="clear"></div>\r\n    <div class="custom-leagues-pagination"></div>\r\n    <div class="add-members"></div>\r\n</form>'})),define("text!PoE/View/PrivateLeague/ManageMember.hbt",[],(function(){return'{{#ifCond editable "===" true}}\r\n{{#if invitation}}\r\n<div>\r\n    <fieldset class="generate-link-container">\r\n        <div class="row">\r\n            <h4 class="section-header">{{ translate \'Generate Invitation Link\' }}</h4>\r\n            {{#ifCond invitation.validKeys.length "<" 10}}\r\n            <div class="row generate-link-form">\r\n                <input type="radio" name="set-expiration-time" id="24-hours" value="true" checked="checked"><label for="24-hours">{{ translate \'Expire in 24 hours\' }}</label>\r\n                <input type="radio" name="set-expiration-time" id="no-expiration-time" value="false"><label for="no-expiration-time">{{ translate \'No Expiration Time\' }}</label>\r\n                <button class="generate-link red">{{ translate \'Generate Link\' }}</button>\r\n            </div>\r\n            <div class="error generate-link-error hidden">\r\n               {{ translate \'Sorry, an error occurred.\' }}\r\n            </div>\r\n            {{/ifCond}}\r\n            <div class="element">\r\n            {{#if invitation.validKeys}}\r\n            {{#each invitation.validKeys}}\r\n                <div class="invitation-link-container">\r\n                    <input class="invitation-link" readonly="readonly" type="text" id="invitation-link-{{@index}}"\r\n                        aria-label="Link to share" value="{{link}}">\r\n                    <button class="copy-text red" data-index="{{@index}}">{{ translate \'Copy\' }}</button>\r\n                    <p>\r\n                        {{ translate \'Generated By:\' }} <span class="invitation-generated-account">{{account}}</span>\r\n                    </p>\r\n                    <p class="invitation-expiration">\r\n                        {{ translate \'Expiration Time:\' }}\r\n                         <span class="invitation-expiration-time">\r\n                        {{#if endTime}}\r\n                            {{moment endTime.date}}\r\n                        {{else}}\r\n                            {{ translate \'Forever\' }}\r\n                        {{/if}}\r\n                    </span>\r\n                    </p>\r\n                </div>\r\n            {{/each}}\r\n            {{/if}}\r\n            </div>\r\n        </div>\r\n        <div class="row">\r\n            {{#ifCond invitation.expiredKeys.length ">" 0}}\r\n                <a class="show-expired" href="">{{ translate \'Show Expired Links\' }}</a>\r\n            {{/ifCond}}\r\n        </div>\r\n    </fieldset>\r\n    {{#ifCond invitation.expiredKeys.length ">" 0}}\r\n    <fieldset class="generate-link-container expired-links-container hidden">\r\n        <h3>{{ translate \'Expired Links\' }}</h3>\r\n        <div class="row">\r\n            {{#each invitation.expiredKeys}}\r\n                <p class="invitation-expiration">{{link}}</p>\r\n                <p>{{ translate \'Generated By:\' }} {{account}}</p>\r\n                <p>{{ translate \'Expiration Time:\' }} {{#if endTime}}{{moment endTime.date}}{{/if}}</p>\r\n                <br/>\r\n            {{/each}}\r\n        </div>\r\n    </fieldset>\r\n    {{/ifCond}}\r\n</div>\r\n{{/if}}\r\n<fieldset>\r\n    <div class="row">\r\n        <div class="element">\r\n            <textarea name="add"\r\n                placeholder="{{bulkInvitePlaceholder}}"></textarea>\r\n            <ul>\r\n                <li class="add-error error"></li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n    <fieldset class="member-line-items">\r\n        <fieldset>\r\n            <div class="row">\r\n                <div class="element">\r\n                    <select name="invite">\r\n                        <option value="">{{ translate \'Invite Account\' }}</option>\r\n                        {{#each eligibleAccounts}}\r\n                        <option value="{{@key}}">{{this}}</option>\r\n                        {{/each}}\r\n                    </select> </div>\r\n            </div>\r\n        </fieldset>\r\n    </fieldset>\r\n    <div class="row">\r\n        <div class="element">\r\n            <input type="submit" class="update-member" value="{{ translate \'Update Members\' }}"> </div>\r\n    </div>\r\n</fieldset>\r\n{{/ifCond}}'})),define("text!PoE/View/PrivateLeague/Roles.hbt",[],(function(){return'<label>{{ translate \'Role\' }}</label>\r\n<select class="filter-role">\r\n    <option value="">{{ translate \'Show All Players\' }}</option>\r\n    {{#each .}} \r\n    <option value="{{key}}">{{value}}</option>\r\n    {{/each}}\r\n</select>\r\n\r\n'})),define("PoE/Model/PrivateLeague/Members",["require","jquery","Backbone","moment","PoE/Handlebars/TemplateCollection","PoE/Collection/PrivateLeague/Members","./Member","PoE/View/Widget/Pagination","PoE/Helpers","PoE/Loader","text!PoE/View/PrivateLeague/Members.hbt","text!PoE/View/PrivateLeague/ManageMember.hbt","text!PoE/View/PrivateLeague/Roles.hbt"],(function(e){var t=e("jquery"),n=e("Backbone"),i=(e("moment"),e("PoE/Handlebars/TemplateCollection")),o=e("PoE/Collection/PrivateLeague/Members"),r=e("./Member"),a=e("PoE/View/Widget/Pagination"),s=e("PoE/Helpers"),l=e("PoE/Loader");return e("text!PoE/View/PrivateLeague/Members.hbt"),e("text!PoE/View/PrivateLeague/ManageMember.hbt"),e("text!PoE/View/PrivateLeague/Roles.hbt"),n.View.extend({initialize:function(){var e=this;this.collection=new o,this.model.selectedSort="roleAsc",this.collection.privateLeague=this.model,this.pagination=new a({collection:this.collection}),this.format="dddd, DD-MMM-YYYY HH:mm:ss zz",this.collection.on("reset",(function(){e.addAll()}))},events:{"click .update-member":"updateMember","click .generate-link":"generateInvitationLink","click .copy-text":"copyLink","focus .invitation-link":"copyLink","click .show-expired":"showExpiredLink","click .update-sort":"updateSort","change .filter-role":"search","click .search-name":"search"},selectOneOwner:function(e){e&&e.id&&this.$el.find("input.make-owner").each((function(n,i){t(i).prop("checked")&&e.id!=t(i).val()&&t(i).prop("checked",!1)}))},generateInvitationLink:function(e){e.preventDefault();var n=this;if($error=n.$el.find(".generate-link-error"),n.collection.invitation&&n.collection.invitation.validKeys.length>=10){var i=s.translate("You have reached the maximum number of invitation links.");$error.show().text(i)}else{$error.hide();var o=n.$el.find('input[name="set-expiration-time"]:checked').val();t.ajax({method:"GET",url:"/api/private-league/".concat(n.model.name,"/generate-link?setExpirationTime=").concat(o)}).done((function(e){n.fetchAll()})).fail((function(e){$error.show()}))}},copyLink:function(e){e.preventDefault();var t=e.currentTarget.id;""==t&&e.currentTarget.dataset&&e.currentTarget.dataset.index&&(t="invitation-link-"+e.currentTarget.dataset.index),""!=t&&(document.querySelector("#".concat(t)).select(),document.execCommand("copy"))},showExpiredLink:function(e){e.preventDefault(),$expired=this.$el.find(".expired-links-container");var n=$expired.hasClass("hidden")?s.translate("Hide Expired Links"):s.translate("Show Expired Links");t(e.currentTarget).text(n),$expired.toggleClass("hidden")},updateMember:function(e){if(e.preventDefault(),!(this.$el.find("input.make-owner:checked").length>0)||confirm(s.translate("Are you sure you want to change Owner?"))){l.start();var n=this;n.$el.find(".add-error").html("");var i=this.$el.find("form.manage-member").serializeArray().filter((function(e){return"set-expiration-time"!==e.name}));t.ajax({url:"/api/private-league-member/"+encodeURIComponent(this.model.id),type:"POST",dataType:"json",contentType:"application/json",data:JSON.stringify(i),success:function(e){if(e.success)n.fetchAll();else if(e.error&&e.error.add)for(var t in l.done(),e.error.add)e.error.add.hasOwnProperty(t)&&n.$el.find(".add-error").text(e.error.add[t])},error:function(e){if(l.done(),e&&e.responseText){var t=JSON.parse(e.responseText);alert(t.error.message)}}})}},updateSort:function(e){e.preventDefault();var n=t(e.currentTarget).hasClass("role")?"role":"name";n+=t(e.currentTarget).hasClass("arrow-up")?"Desc":"Asc",this.$el.find(".update-sort").removeClass("arrow-up arrow-down"),t(e.currentTarget).addClass(n.includes("Asc")?"arrow-up":"arrow-down"),this.collection.privateLeague.selectedSort=n,this.search(e)},search:function(e){e.preventDefault(),this.collection.privateLeague.search=this.$el.find(".search").val(),this.collection.privateLeague.selectedRole=this.$el.find(".filter-role").val(),this.fetchAll()},fetchAll:function(){var e=this;e.collection.currentPage=1,this.$members.html(""),l.start(),this.collection.fetch().done((function(){e.addAll(),e.collection.totalRecords&&e.$el.find(".total-count").text(s.translate("Total")+": "+e.collection.totalRecords.toLocaleString()),l.done(),e.loadManageMember(e.collection),0==e.$el.find(".filter-role").length&&i.load("PoE/View/PrivateLeague/Roles.hbt").done((function(t){e.$el.find(".filter-role-container").html(t(e.collection.roles))}))}))},loadManageMember:function(e){var n=this;if(e){var o={invitation:e.invitation,editable:e.editable,eligibleAccounts:e.eligibleAccounts,bulkInvitePlaceholder:t("body").hasClass("tencent")?s.translate("Bulk Invite By QQ Number (Comma separated eg/ 111, 222, 333)"):s.translate("Bulk Invite By Name (Comma separated eg/ AccountName1, AccountName2, AccountName3)")};i.load("PoE/View/PrivateLeague/ManageMember.hbt").done((function(e){n.$el.find(".add-members").html(e(o))}))}},addAll:function(){var e=this;this.$members.empty();var t=0;this.collection.each((function(n){var i=new r({model:n});e.$members.append(i.$el),i.render(),i.on("selectOneOwner",(function(t){e.selectOneOwner(t)})),t++})),0===t&&e.$members.html(s.translate("No members."))},render:function(){var e=this,t={roleOptions:this.model.roleOptions,editable:this.model.editable,started:this.model.started};i.load("PoE/View/PrivateLeague/Members.hbt").done((function(n){e.$el.html(n(t)),e.delegateEvents(),e.$members=e.$el.find(".member-list"),e.fetchAll(),e.$el.find(".custom-leagues-pagination").append(e.pagination.el),e.pagination.render(),e.pagination.delegateEvents()}))}})})),define("text!PoE/View/PrivateLeague/Cart.hbt",[],(function(){return'<div class="line-item {{#unless permanent}}remove{{/unless}}" data-input-id="{{id}}">\r\n    <div class="cart-line-item">\r\n        <div class="remove-item">X</div>\r\n        <div class="icon"></div>\r\n        {{#if removeOnly}}\r\n        <div class="item-name disable-text-select remove">- {{name}}</div>\r\n        {{else}}\r\n        <div class="item-name disable-text-select">{{name}}</div>\r\n        {{/if}}\r\n        <div class="item-cost">{{#ifCond displayCost "!=" 0}}{{displayCost}}{{/ifCond}}</div>\r\n    </div>\r\n</div>'})),define("PoE/Model/PrivateLeague/Cart",["require","jquery","Backbone","PoE/Handlebars/TemplateCollection","PoE/Helpers","text!PoE/View/PrivateLeague/Cart.hbt"],(function(e){var t=e("jquery"),n=e("Backbone"),i=e("PoE/Handlebars/TemplateCollection");return e("PoE/Helpers"),e("text!PoE/View/PrivateLeague/Cart.hbt"),n.View.extend({initialize:function(){this.render()},events:{"click .line-item":"remove"},remove:function(){var e=this.$el.find(".line-item").data("inputId");if(e){var n=document.querySelector('[id="'+e+'"]');"checkbox"==n.type?n.checked=!n.checked:"number"==n.type&&n.value>0&&(n.value=parseInt(n.value)-1),t(".custom-league-view").trigger("updateMod")}},render:function(){var e=this;i.load("PoE/View/PrivateLeague/Cart.hbt").done((function(t){var n=e.model;e.$el.html(t(n)),e.delegateEvents()}))}})})),define("text!PoE/View/PrivateLeague/Countdown.hbt",[],(function(){return'<div class="days">{dn}</div>\r\n<div class="hours">{hn}</div>\r\n<div class="minutes">{mn}</div>\r\n<div class="seconds">{sn}</div>'})),define("PoE/PrivateLeague/PrivateLeague",["jquery","moment","Underscore","PoE/Helpers","flatpickr","Handlebars","PoE/Model/PrivateLeague/Members","PoE/Model/PrivateLeague/Cart","PoE/Handlebars/TemplateCollection","text!PoE/View/PrivateLeague/Countdown.hbt"],(function(e,t,n,i,o,r,a,s,l){var c="",d="",u=[],h=null,p=0,f=0,v={init:function(n){(this.countdownSelector="#mini-countdown",n&&n.countdownSelector&&(this.countdownSelector=n.countdownSelector),n&&n.leagueId&&(this.leagueId=n.leagueId),n&&n.leagueName&&(this.leagueName=n.leagueName),n&&n.editable&&(this.editable=n.editable),n&&n.editable&&(this.started=n.started),n&&n.maxDurationString&&(c=n.maxDurationString),n&&n.maxPlayersString&&(d=n.maxPlayersString),n&&n.cart&&n.cart,n&&n.permanentCartItems&&(h=n.permanentCartItems),n&&(p=n.currentDuration?n.currentDuration:0,f=n.currentPlayers?n.currentPlayers:0),this.isNew=n.isNew||!1,this.timezone=t.tz.guess(),this.pickr=null,this.defaultTime=t().toDate(),this.startTimeMessage=i.translate("This private league starts at {START_TIME}."),this.currentTimeMessage=i.translate("The League will start when it is created."),this.leagueStartMessage=i.translate("after league start, are you sure?"),this.startHoursMessage=i.translate("from now, are you sure?"),this.currentTimeText=i.translate("Now"),this.countdownElement=e(this.countdownSelector+" .countdown"),this.leagueId&&this.leagueId>0)&&(this.registerHelper(),new a({el:e(document).find(".members-container"),model:{id:this.leagueId,name:this.leagueName,editable:this.editable,started:this.started}}).render());var o=this;e(".custom-league-view").on("updateMod",(function(){o.updateCart(),o.prepareExcludes()})),document.getElementById("crowdfund-amount")&&(this.showFundErrors(),document.getElementById("crowdfund-amount").addEventListener("change",(function(){o.showFundErrors()})));var r=e('select[name="league_type"]');r.length&&r.on("change",o.onUpdateLeagueType)},onUpdateLeagueType:function(){var t=e('select[name="league_type"]'),n=t.find("option:selected");if(t.length){!n.data()||Object.hasOwn(n.data(),"modifiable")&&!n.data("modifiable")?(e(".customisation-option").hide(),e(".cart-container h2").text(i.translate("Details")),e("input[type=submit][name=pay_now]").val(i.translate("Create")),e("input[type=submit][name=submit]").hide(),e(".selectable-mod input").prop("disabled",!0),e("#cart").addClass("not-cart"),e(".league-property").each((function(){e(this).val(0)}))):(e(".customisation-option").show(),e(".cart-container h2").text(i.translate("Cart")),e("input[type=submit][name=pay_now]").val(i.translate("Pay Now")),e("input[type=submit][name=submit]").show(),e(".selectable-mod input").prop("disabled",!1),e("#cart").removeClass("not-cart")),e(".hidden-mod").remove();var o=n.data("mods");if(Array.isArray(o)&&o.length){var r=e(".template-mod"),a=r.parent();o.forEach((function(t){var n=t.name,i=t.description,o=t.icon;o&&($mod=r.clone(),$mod.removeClass("template-mod").addClass("hidden-mod"),$mod.find(".name").text(n),$mod.find(".mod-icon").append(e("<img />").attr("src",o).attr("alt","")),$mod.find(".tooltip").text(i),$mod.prependTo(a),$mod.show())}))}var s=e(".parent-league-warning");s.hide(),n.data("start")&&!n.data("end")&&s.show();var l=e(".league-end-time");l.hide(),n.data("end")&&(l.find(".time-text").text(v.getLocalTimeString(n.data("end"))),l.show()),v.prepareExcludes(),v.updateCart()}else v.updateCart()},showFundErrors:function(){if(!document.getElementById("tc-points")){var e=document.getElementById("no-points-error"),t=document.getElementById("invalid-points-error"),n=document.getElementById("fund-button"),i=document.getElementById("crowdfund-amount").value;e.classList.add("hidden"),t.classList.add("hidden"),n.disabled=!1,""==i||parseInt(i)<=0?(t.classList.remove("hidden"),n.disabled=!0):parseInt(i)>currentBal&&(e.classList.remove("hidden"),n.disabled=!0)}},getDefaultTime:function(){return this.defaultTime},getBrowserTimezone:function(){return this.timezone},getLocalTime:function(e){return t(e).tz(this.timezone).toDate()},getLocalTimeString:function(e){return t(e).tz(this.timezone).format("YYYY-MM-DD HH:mm")},initDateAndCountdown:function(e,t,n){var i=e&&this.getMaxDate(e,this.defaultTime)>this.defaultTime?this.getLocalTime(e):null,o=i||this.defaultTime,r=i?this.getLocalTimeString(i):this.currentTimeText,a=t?this.getMaxDate(t,o):o,s=i||this.getMinDate(o,n);return this.pickr.set("minDate",s),this.pickr.setDate(a),this.showCountdown(a,!1),r},getMinDate:function(e,t){return this.getLocalTime(e)<this.getLocalTime(t)?this.getLocalTime(e):this.getLocalTime(t)},getMaxDate:function(e,t){return this.getLocalTime(e)>this.getLocalTime(t)?this.getLocalTime(e):this.getLocalTime(t)},getStartTimeWarning:function(e,n){var i=[];i.hours=0;var o=this.getLocalTime(new Date),r=n?this.getMaxDate(n,o):o;if(e=t.tz(e,this.timezone).toDate(),!this.isValidStartTime(e,r))return i.html=this.currentTimeMessage,i;var a=this.startTimeMessage.replace("{START_TIME}",this.getLocalTimeString(e)),s=this.getDiffHours(e,r);return s>0&&(i.hours=s,i.startMessage=n&&this.isFutureStartTime(r)?this.leagueStartMessage:this.startHoursMessage),i.html=a,i},isValidStartTime:function(e,t){return e-t>=0},isFutureStartTime:function(e){return e-this.getLocalTime(new Date)>0},getDiffHours:function(e,t){var n=e-t;return n>0?Math.floor(n/1e3/60/60):0},showCountdown:function(e,t){this.initCountdown(e,t)},initCountdown:function(n,i){var o=this;l.load("PoE/View/PrivateLeague/Countdown.hbt").done((function(r){var a=e(o.countdownSelector+" .league-start-message"),s=n-t().toDate(),l=[0,0,0,0,0,0,0];if(a.hide(),o.countdownElement.countdown("destroy"),s<0&&o.isNew)e(".countdown-container").hide();else{e(".countdown-container").show();var c=s>0?{until:Math.floor(s/1e3)}:{since:n};o.countdownElement.countdown(_objectSpread(_objectSpread({},c),{},{layout:r(),onTick:function(e){var t=function(t,n){e[t]!==l[t]&&(l[t]=e[t],o.countdownElement.find(n).addClass("start"),setTimeout((function(){o.countdownElement.find(n).addClass("done")}),0),0===e[t]&&6===t&&o.countdownElement.find(n).addClass("zero"))};t(6,".seconds"),t(5,".minutes"),t(4,".hours"),t(3,".days")},onExpiry:function(){setTimeout((function(){i?e(o.countdownSelector).parent(".countdown-container").hide():(a.show(),o.countdownElement.find(".seconds").removeClass("start zero done"))}),1e3)}}))}}))},destroyCountdown:function(){this.countdownElement.countdown("destroy"),e(this.countdownSelector).parent(".countdown-container").hide()},initFlatpickr:function(n,i,r){var a=this;return a.pickr=o(n,{enableTime:!0,time_24hr:!0,minDate:t(i).toDate(),maxDate:t(r).toDate(),parseDate:function(e,t,n){return new Date(e)},onChange:function(t,i,o){t.length>0&&a.showCountdown(t[0],!1),"block"==e(n).css("display")&&(a.pickr.toggle(),a.pickr.open())}}),a.pickr},registerHelper:function(){r.registerHelper("privateLeagueRoleClassName",(function(e){return e?e.toLowerCase():""})),r.registerHelper("momentPrivateLeague",(function(e,n){return t(e).format("YYYY/MM/DD h:mm Z")}))},confirmDialog:function(t){if(!prevTarget)return!1;var i=document.querySelector("#cl-popup-container"),o=i.querySelector("#crowdfund-confirm"),r=i.querySelector("#fund-confirm"),a=i.querySelector("#leave-private-league"),l=i.querySelector(".total.coin-icon");checkoutContainer=i.querySelector(".total"),checkoutContainer.innerHTML="";var c=document.createElement("div"),d=e(".start-confirm-checkbox"),h=e("#confirm-ok");switch(t){case"confirmChanges":if(changeSet&&void 0===changeSet.length){changeSetContainer=i.querySelector(".previous-change-set"),changeSetContainer.innerHTML="";var p=document.createElement("div"),f=n.groupBy(changeSet.properties,"name");for(var v in f=n.sortBy(f,(function(e){return Object.keys(e).length})),f)if(f.hasOwnProperty(v)){var m=f[v];(y=document.createElement("div")).classList.add("line-item"),y.innerHTML=m[0].name+(m.length>1?" X"+m.length:""),e(p).append(y)}var g=document.createElement("div");for(var v in changeSet.mods){var y;m=changeSet.mods[v];(y=document.createElement("div")).classList.add("line-item"),y.innerHTML=m.name,e(g).append(y)}e(changeSetContainer).append(p),e(changeSetContainer).append(g),fundStatusContainer=i.querySelector(".fund-status"),fundStatusContainer.innerHTML="";var b=document.createElement("div");b.innerHTML=changeSet.paid.toLocaleString()+" / "+changeSet.cost.toLocaleString(),e(fundStatusContainer).append(b)}for(var v in cartContainer=i.querySelector(".cart"),cartContainer.innerHTML="",u){var w=new s({model:u[v]});e(cartContainer).append(w.$el)}c.innerHTML=("pay_now"==prevTarget.name?total.toLocaleString():0)+" / "+total.toLocaleString();var x=e("#start_time").val();if(x){var P=e('select[name="league_type"] option:selected').data("start"),E=this.getStartTimeWarning(x,P);E.hours>0?(e(".start-hour-confirm-message .start-hour").text(E.hours),e(".start-hour-confirm-message .confirm-message").text(E.startMessage),d.find("#start-time-confirm").prop("checked",!1),d.show(),h.attr("disabled",!0),e(".start-hour-confirm-message").show()):(d.hide(),h.removeAttr("disabled"),e(".start-hour-confirm-message").hide()),e(".start-confirm-message").html(E.html),e("#start-time-warning").show()}else e("#start-time-warning").hide();o.style.display="block",r.style.display="none",a.style.display="none",l.style.display="inline-block",total>0?e(i).find(".total-section").show():e(i).find(".total-section").hide();break;case"confirmFund":o.style.display="none",r.style.display="block",a.style.display="none",l.style.display="inline-block";var C=parseInt(document.querySelector("#crowdfund-amount").value);c.innerHTML=C>0?C.toLocaleString():C;break;case"confirmLeave":o.style.display="none",r.style.display="none",a.style.display="block",l.style.display="none"}e(checkoutContainer).append(c),i.style.display="block",i.querySelector("#cl-popup-content").addEventListener("click",(function(e){e.stopPropagation()})),i.querySelector(".confirm-buttons").addEventListener("click",(function(e){"confirm-ok"==e.target.getAttribute("id")?prevTarget.click():"confirm-cancel"==e.target.getAttribute("id")&&(prevTarget=!1),i.style.display="none"})),i.addEventListener("click",(function(e){prevTarget=!1,i.style.display="none"})),d.find("#start-time-confirm").on("click",(function(e){d.find("#start-time-confirm").prop("checked")?h.removeAttr("disabled"):h.attr("disabled",!0)}))},updateCart:function(){u=[];var t,n=(t=e("select[name=league_type] option:selected")).length?_objectSpread(_objectSpread({},t.data()),{},{name:t.text()}):{};n.cost&&u.push({id:"base",name:n.name,cost:n.cost,displayCost:n.cost,permanent:!0}),n.mods&&n.mods.forEach((function(e){u.push({id:e.id,name:e.name,cost:e.cost,displayCost:e.cost,permanent:!0})}));var i=document.querySelectorAll(".league-property");for(var o in i){var r=i[o],a=parseInt(r.value);if(a>0){var l={id:r.getAttribute("id"),name:r.getAttribute("data-item-name")+" x"+a,cost:parseInt(r.getAttribute("data-item-cost"))*a,displayCost:(parseInt(r.getAttribute("data-item-cost"))*a).toLocaleString()};if(type=r.getAttribute("data-type")){var v=parseInt(r.getAttribute("data-value"));l.type=type,l.value=v*a}u.push(l)}}var m=document.querySelectorAll(".modInput");Object.values(m).forEach((function(t){if(!e(t).prop("disabled")){var n=t.parentElement&&"true"===t.parentElement.getAttribute("data-remove-only");(t.checked&&!n||!t.checked&&t.parentElement&&n)&&u.push({id:t.getAttribute("id"),name:t.parentElement.getAttribute("data-name"),cost:t.parentElement.getAttribute("data-cost"),displayCost:t.parentElement.getAttribute("data-cost").toLocaleString(),removeOnly:n})}})),cartEl&&(cartEl.innerHTML=""),total=0;var g=[],y=f,b=p;if(forceShowCart||u.length!=h.length){for(var o in u){var w=u[o],x=new s({model:w});w.type&&("players"==w.type?y+=w.value:"duration"==w.type&&(b+=w.value)),e(cartEl).append(x.$el),total+=parseInt(w.cost)}var P=document.querySelector(".add-duration .errors");valid=!0,b>maxDuration?(P.innerHTML=c,valid=!1):P.innerHTML="";var E=document.querySelector(".add-players .errors");y>maxPlayers?(E.innerHTML=d,valid=!1):E.innerHTML=""}window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),i.forEach((function(e){var t=e.getAttribute("id"),n=document.querySelector('[data-for-id="'+t+'"]'),i=parseInt(e.getAttribute("data-value"));(type=e.getAttribute("data-type"))&&("players"==type&&i+y>maxPlayers||"duration"==type&&i+b>maxDuration?n.disabled=!0:n.disabled=!1)})),totalBuffer=document.createElement("div"),totalBuffer.classList.add("total-buffer"),e(cartEl).append(totalBuffer),document.querySelector("#total").innerHTML=total.toLocaleString();var C=document.querySelector(".cart-container");if(C){var k=C.querySelector(".errors");for(var o in k.innerHTML="",g){var S=document.createElement("div");S.innerHTML=g[o],e(k).append(S)}C.querySelectorAll(".pay-button").forEach((function(e){e.disabled=!valid,"pay_now"==e.name&&total>currentBal&&(e.disabled=!0)})),C.style.display=u.length>0||forceShowCart?"block":"none"}},swapExcludesAndClick:function(t){var n=t.currentTarget,i=n.getAttribute("data-exclude-mods").split(","),o=n.querySelector("input");o.removeAttribute("disabled"),!1!==e('select[name="league_type"] option:selected').data("modifiable")&&(i.forEach((function(e){var t=document.querySelector('[id="'+e+'"]');t&&(t.checked=!1)})),o.checked=!0,n.classList.remove("swap"),n.click())},prepareExcludes:function(){var t=document.querySelectorAll(".modInput"),n={};if(!1!==e('select[name="league_type"] option:selected').data("modifiable")){for(var i in t)if(t.hasOwnProperty(i)){var o=t[i];o.parentElement.getAttribute("data-exclude-mods").split(",").forEach((function(e){document.querySelector('[id="'+e+'"]')&&(n[e]=n[e]||o.checked)}))}for(var i in n)if(n.hasOwnProperty(i)){var r=document.querySelector('[id="'+i+'"]');n[i]?(r.setAttribute("disabled","disabled"),r.parentElement.classList.add("swap")):r.removeAttribute("disabled")}}},updateDateOptions:function(t){var n=e('select[name="league_type"]'),i=n.val(),o=e(n).find('option[value="'+i+'"]'),r=e(o).data("start"),a=this.initDateAndCountdown(r,t,"$minTimeStr");e(".selected-date").text(a)},toggleStartTimeOptions:function(t){var n=e(".toggle-button-container");n.find(".selected-date").is(":visible")?(n.find(".selected-date").hide(),n.find("input[type=text]").show(0,(function(){setTimeout((function(){t.open()}),300)})),n.find("button").text(i.translate("Set to ASAP"))):(n.find(".selected-date").show(),n.find("input[type=text]").hide(),n.find("input[type=text]").val(0),n.find("button").text(i.translate("Change")),this.destroyCountdown())}};return v})),define("PoE/PassiveSkillTree/Skill",["require","PoE/Helpers"],(function(e){e("PoE/Helpers");return function(){function e(t){_classCallCheck(this,e),this.hash=t.skill||null,this.icon=t.icon||null,this.skillDescription=t.stats,this.displayName=t.name,this.flavourText=t.flavourText,this.reminderText=t.reminderText,this.sa=t.grantedStrength||0,this.da=t.grantedDexterity||0,this.ia=t.grantedIntelligence||0,this.item=t.item,this.jewel=t.jewel,this.recipe=t.recipe||[],t.isKeystone?this.type="keystone":t.isJewelSocket?this.type="jewel":t.ascendancyName?this.type="ascendancy":t.isNotable?this.type="notable":this.type="normal"}return _createClass(e,[{key:"getHash",value:function(){return this.hash}},{key:"getType",value:function(){return this.type}},{key:"isJewel",value:function(){return!!this.jewel}}]),e}()})),define("PoE/PassiveSkillTree/SkillPopup",["require","PoE/Layout/Popup/Popup","PoE/Item/Popup/Constants","PoE/Geom/Point","PoE/Geom/Bounds","Handlebars"],(function(e){var t=e("PoE/Layout/Popup/Popup"),n=(e("PoE/Item/Popup/Constants"),e("PoE/Geom/Point")),i=e("PoE/Geom/Bounds"),o=e("Handlebars"),r=function(){function e(n){var i=this;_classCallCheck(this,e);var o=document.createElement("div");o.innerHTML=e.prototype.Template({name:n.displayName,stats:n.skillDescription,flavourText:n.flavourText,reminderText:n.reminderText,recipe:n.recipe}).trim(),this.$el=o.firstElementChild,this.$el.classList.add("".concat(n.getType(),"Popup")),this.popup=new t(this.$el),this.popup.create(),this.popup.events.prePosition=function(){i.updatePopupWidth()}}return _createClass(e,[{key:"destroy",value:function(){delete this.popup,this.$el.remove()}},{key:"updatePopupWidth",value:function(){this.$el.style.position="relative",this.$el.style.top="0",this.$el.style.left="0",this.$el.style.width="auto";var e=60;this.$el.querySelectorAll(".skillName, .recipe").forEach((function(t){e+=t.offsetWidth})),this.$el.querySelectorAll(".lc").forEach((function(t){e=Math.max(e,t.offsetWidth+14)}));var t=Math.min(e,760);this.$el.style.width="".concat(t,"px")}},{key:"reposition",value:function(e){var t=new n(e.viewport.x+e.x,e.viewport.y+e.y),o=new i(new n(e.viewport.x,e.viewport.y),new n(e.viewport.x+e.viewport.width,e.viewport.y+e.viewport.height));this.popup.positionSmartLeft(new i(t,t),o)}},{key:"handleMouseover",value:function(e){this.hoverStart(),this.reposition(e)}},{key:"handleMouseout",value:function(){this.popup.hide(),this.hoverEnd()}},{key:"hoverStart",value:function(){this.$el.classList.add("hovered")}},{key:"hoverEnd",value:function(){this.$el.classList.remove("hovered")}}]),e}();return r.prototype.Template=o.compile('\n        <div class="skillPopupContainer skillPopup">\n            <div class="skillHeader">\n                <div class="skillName">\n                    <span class="lc">{{name}}</span>\n                </div>\n                {{#if recipe}}\n                <div class="recipe">\n                    {{#each recipe}}\n                    <span class="component {{this}}"></span>\n                    {{/each}}\n                </div>\n                {{/if}}\n            </div>\n            <div class="content">\n            {{#if stats}}\n                {{#each stats}}<div class="explicitMod"><span class="lc">{{{this}}}</span></div>{{/each}}\n            {{/if}}\n            {{#if reminderText}}\n                <br>\n                {{#each reminderText}}<div class="descrText"><span class="lc">{{this}}</span></div>{{/each}}\n            {{/if}}\n            {{#if flavourText}}\n                <br>\n                {{#each flavourText}}<div class="flavourText"><span class="lc">{{{this}}}</span></div>{{/each}}\n            {{/if}}\n            </div>\n        </div>\n    '),r})),define("text!PoE/Ascendancy/Ascendancy.hbt",[],(function(){return'<svg version="1.1" viewBox="0 0 {{frameW}} {{frameH}}" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\r\n    \x3c!-- defining image icons and lines --\x3e\r\n    <defs>\r\n        <filter id="Darken">\r\n            <feColorMatrix in="SourceGraphic" type="saturate" values="0.3" />\r\n        </filter>\r\n        {{#each sprites}}\r\n        <image id="{{@key}}" {{#with (lookup this "0.8")~}} xlink:href="{{filename}}" width="{{w}}" height="{{h}}" {{/with}} preserveAspectRatio="none" />\r\n        {{/each}}\r\n        {{#each sprites}}\r\n        {{#each this}}\r\n        {{#each coords}}\r\n        <symbol id="{{@key}}" viewBox="0 0 {{w}} {{h}}">\r\n          <use xlink:href="#{{@../../key}}" transform="translate(-{{x}}, -{{y}})" />\r\n        </symbol>\r\n        {{/each}}\r\n        {{/each}}\r\n        {{/each}}\r\n        <clipPath id="background-clip" clipPathUnits="userSpaceOnUse">\r\n          <circle cx="{{math frameW \'/\' 2}}" cy="{{math frameH \'/\' 2}}" r="{{math frameW \'/\' 2}}" />\r\n        </clipPath>\r\n    </defs>\r\n    <g>\r\n      \x3c!-- frame --\x3e\r\n      <use xlink:href="#{{fixIconPaths ascData.background}}" x="0" y="0" width="{{frameW}}" height="{{frameH}}" clip-path="url(#background-clip)"></use>\r\n      <use xlink:href="#{{fixIconPaths titlePlaque.image}}" x="{{titlePlaque.x}}" y="{{titlePlaque.y}}" width="{{titlePlaque.width}}" height="{{titlePlaque.height}}"></use>\r\n      <text text-anchor="middle" fill="#7CB29C" x="{{titlePlaque.centerX}}" y="{{math titlePlaque.height \'/\' 1.6}}" class="FontinItalic" style="font-size: 18px; font-style: italic; paint-order: stroke; stroke-width: 1px; stroke-linecap: butt; stroke-linejoin: miter; stroke: #525252; user-select: none;">{{ascData.displayName}}</text>\r\n      \x3c!-- flavour text --\x3e\r\n      {{drawAscendancyFlavourText flavourText}}\r\n      \x3c!-- draw lines --\x3e\r\n      {{drawAscendancyLines nodes}}\r\n      \x3c!-- draw icons --\x3e\r\n      {{#each nodes}}\r\n        <g class="node-group">\r\n          {{drawAscendancyNode this @key}}\r\n      </g>\r\n      {{/each}}\r\n    </g>\r\n</svg>\r\n'})),define("PoE/Ascendancy/Ascendancy",["require","jquery","Backbone","PoE/Handlebars/TemplateCollection","PoE/PassiveSkillTree/Skill","PoE/PassiveSkillTree/SkillPopup","text!PoE/Ascendancy/Ascendancy.hbt"],(function(e){e("jquery");var t=e("Backbone"),n=e("PoE/Handlebars/TemplateCollection"),i=e("PoE/PassiveSkillTree/Skill"),o=e("PoE/PassiveSkillTree/SkillPopup");return e("text!PoE/Ascendancy/Ascendancy.hbt"),t.View.extend({initialize:function(e){this.sprites=e.sprites,this.render()},mousemove:function(e){var t=e.currentTarget.getAttribute("data-node");if(t!=this.model.startNode){var n=this.$el.offset(),r={x:e.pageX-n.left,y:e.pageY-n.top,viewport:{x:n.left,y:n.top,width:this.$el.width(),height:this.$el.height()}};t in this.popups||(this.popups[t]=new o(new i(this.model.nodes[t]))),this.popups[t].handleMouseover(r)}},mouseleave:function(e){var t=e.currentTarget.getAttribute("data-node");t in this.popups&&(this.popups[t].handleMouseout(),this.popups[t].destroy(),delete this.popups[t])},render:function(){this.popups=[];var e=this,t=this.$el,i=this.model;i.sprites=this.sprites,n.load("PoE/Ascendancy/Ascendancy.hbt").done((function(e){t.html(e(i))})).then((function(){var n=t[0].querySelectorAll(".node");for(var i in n)n.hasOwnProperty(i)&&(n[i].addEventListener("mouseenter",(function(t){e.mousemove(t)})),n[i].addEventListener("mousemove",(function(t){e.mousemove(t)})),n[i].addEventListener("mouseleave",(function(t){e.mouseleave(t)})))}))}})})),define("PoE/Ascendancy/AscendancyRenderer",["require","jquery","Handlebars","PoE/Ascendancy/Ascendancy"],(function(e){var t=e("jquery"),n=e("Handlebars"),i=e("PoE/Ascendancy/Ascendancy"),o=window.navigator.userAgent.toLowerCase(),r=o&&/msie|trident/.test(o),a={SPRITES:void 0,init:function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:675,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:700;this.registerHelper();var r=n,a=o;if(void 0!==this.SPRITES)for(var s in e){var l=e[s];l.frameW=r,l.frameH=a,new i({el:t("#"+l.elementId),model:l,sprites:this.SPRITES})}else console.error("No Ascendancy sprites! Cannot render")},registerHelper:function(){var e=this;n.registerHelper("drawAscendancyLines",(function(t){return new n.SafeString(e.drawAscendancyLines(t))})),n.registerHelper("drawAscendancyFlavourText",(function(t){return new n.SafeString(e.drawAscendancyFlavourText(t))})),n.registerHelper("drawAscendancyNode",(function(){var t;return new n.SafeString((t=e.drawAscendancyNode).call.apply(t,[this].concat(Array.prototype.slice.call(arguments))))})),n.registerHelper("fixIconPaths",(function(e){return/\/gen\/image\//.test(e)?e=e.split(/[\\/]/).pop().replace(/\.[^/.]+$/,""):/\/image\/Art\/2DArt\//.test(e)&&(e=e.match(/\/(Art\/2DArt\/.*)$/).at(1)),"NameBackground"===e?"AscendancyNamePlaque":e}))},drawAscendancyLines:function(e){var t=[];for(var n in e)for(var i in e[n].out){var o=e[e[n].out[i]];if(o){var r=parseFloat(e[n].x),a=parseFloat(e[n].y),s=parseFloat(o.x),l=parseFloat(o.y);t.push('<line x1="'.concat(r,'" y1="').concat(a,'" x2="').concat(s,'" y2="').concat(l,'" style="stroke-width: 5px; stroke: #746543" />')),t.push('<line x1="'.concat(r,'" y1="').concat(a,'" x2="').concat(s,'" y2="').concat(l,'" style="stroke-width: 2px; stroke: #231c0c" />'))}}return t.join("\n")},drawAscendancyFlavourText:function(e){var t=e.flavourText.split("\n"),n=24,i=e.fontSize>24?24:e.fontSize,o=parseFloat(e.x),a=[];for(var s in t)n+=0==s?i/2:i,t.length>s&&a.push('<tspan x="'.concat(o,'" y="').concat(parseFloat(e.y)+n,'">').concat(t[s].replace(/\s/g,"&nbsp;"),"</tspan>"));var l="\n                font-size: ".concat(i,"px;\n                font-style: italic;\n                paint-order: stroke;\n                stroke-width: 1px;\n                stroke-linecap: butt;\n                stroke-linejoin: miter;\n                stroke: black;\n                font-weight: ").concat(r?"bold":"normal",";\n                user-select: none;\n            ").split("\n").map((function(e){return e.trim()})).join(" ");return'\n            <text fill="rgb('.concat(e.flavourTextColour,')" x="').concat(o,'" y="').concat(e.y,'" width="').concat(e.width,'" height="').concat(e.height,'" class="FontinItalic" style="').concat(l,';">\n                ').concat(a.join("\n"),"\n            </text>\n            ")},drawAscendancyNode:function(e,t){if(e.isAscendancyStart)return'<use xlink:href="#AscendancyMiddle" class="node node-'.concat(t,'" data-node="').concat(t,'" x="').concat(e.x-e.ir,'" y="').concat(e.y-e.ir,'" width="').concat(2*e.ir,'" height="').concat(2*e.ir,'" opacity="1" />');var i=n.helpers.fixIconPaths(e.icon);return'\n            <use xlink:href="#'.concat(i,'" filter="url(#Darken)" x="').concat(e.x-e.ir,'" y="').concat(e.y-e.ir,'" width="').concat(2*e.ir,'" height="').concat(2*e.ir,'" opacity="1" />\n            <use xlink:href="#').concat(e.isNotable?"AscendancyFrameLargeNormal":"AscendancyFrameSmallNormal",'" class="node node-').concat(t,'" data-node="').concat(t,'" x="').concat(e.x-e.or,'" y="').concat(e.y-e.or,'" width="').concat(2*e.or,'" height="').concat(2*e.or,'" opacity="1" />\n            ')}};return a})),define("text!PoE/View/DivinationCard/Preview.hbt",[],(function(){return'<h5 class="card-draft">Preview</h5>\r\n<div class="FontinSmallCaps card-preview">\r\n    <div class="card-face">\r\n        <img class="card-face-image" alt="" src="{{cardFace}}" width="237" height="170">\r\n    </div>\r\n    <div class="card-frame">\r\n        <div class="card-content card-name">{{#if name }}{{name}}{{else}}{{translate "Name"}}{{/if}}</div>\r\n        <div class="card-content card-reward">\r\n            <div class="card-content card-stack-size">*</div>\r\n            {{translate "Reward"}}\r\n        </div>\r\n        <div class="card-content card-divider"></div>\r\n        <div class="card-content card-flavour-text"><div>{{#if flavourText }}{{flavourText}}{{else}}{{translate "Flavour Text"}}{{/if}}</div></div>\r\n    </div>\r\n    {{#unless manageCard}}\r\n    <p class="card-warning">Please do not reveal your Divination Card prior to its release. Contact us for more information.</p>\r\n    {{/unless}}\r\n</div>'})),define("PoE/View/DivinationCard/Preview",["Handlebars","Backbone","jquery","Underscore","PoE/Helpers","PoE/Handlebars/TemplateCollection","text!PoE/View/DivinationCard/Preview.hbt"],(function(e,t,n,i,o,r){return t.View.extend({initialize:function(e){this.defaultImagePath="divination-card/TheVoid.png",this.manageCard=!(!e||!e.manageCard),this.render()},prepare:function(){var e=this.model;if(e.showImage){if(e.cardImage)return void(e.cardFace=e.cardImage);if(e.artFilePath)return void(e.cardFace=o.imageUrl(e.artFilePath))}e.cardFace=o.imageUrl(this.defaultImagePath)},render:function(){var e=this,t=this;t.prepare(),r.load("PoE/View/DivinationCard/Preview.hbt").done((function(n){var r=i.extend(t.model,{manageCard:e.manageCard});t.$el.html(n(r)),t.$el.find("img.card-face-image").error((function(){var e=o.imageUrl(t.defaultImagePath);try{var n=new Image(237,170);n.src=e,n.onload=function(){t.$el.find("img.card-face-image").attr("src",e)}}catch(e){}}))}))}})})),define("text!PoE/View/Microtransactions/Microtransaction.hbt",[],(function(){return'<div class="shopItem-container">\n    <a data-href="{{imageUrl}}" class="itemImage progressive replace" alt="{{name}}"></a>\n    <h4 class="name-container">\n        <a class="name" href="/shop/item/{{id}}">{{name}}</a>\n    </h4>\n    <div class="mtx-details">\n        <div class="price">\n            {{#if minCost}}\n            {{minCost}} &mdash; {{maxCost}}\n            {{else}}\n            {{#ifCond cost \'===\' 0}}\n            {{translate \'Free\'}}\n            {{else}}\n            {{cost}}\n            {{/ifCond}}\n            {{/if}}\n            <div class="coin-icon"></div>\n            {{#if variantGroup}}\n            {{else}}\n            {{#if onSpecial}}\n            {{#ifCond cost "!=" originalCost}}\n            <div class="original-cost">{{originalCost}}<div class="coin-icon"></div></div>\n            {{/ifCond}}\n            {{/if}}\n            {{/if}}\n            <div></div>\n        </div>\n        <div class="description">\n            {{description}}\n        </div> \n    </div>\n    {{#ifCond bundle \'&&\' isMysteryPack}}\n    <div class="bundleInfo">\n        <div class="label">X<span class="bundle-count">{{bundleCount}}</span></div>\n    </div>\n    {{/ifCond}}\n    {{#if variantGroup}}\n    <div class="variantGroupInfo">{{translate "x{COUNT} Variations" COUNT=items.length}}</div>\n    {{/if}}\n</div>\n<div class="controls">\n    {{#if owned}}\n    <div class="singleOwnedIcon" alt="{{translate "Already Owned"}}"></div>\n    {{else}}\n    <a class="button-text buyButton" href="/shop/item/{{id}}">{{translate "Buy"}}</a>\n    {{/if}}\n    {{#if bundle}}\n    {{#if discount}}\n    <div class="savingsInfo">\n        <div class="label">{{translate "Saves"}} {{discount}}</div>\n        <div class="coin-icon"></div>\n    </div>\n    {{/if}}\n    {{/if}}\n    {{#if loggedIn}}\n    <a class="watchlist {{#if onWatchlist}}added{{/if}}" href="#">{{#if onWatchlist}}{{translate "Remove from Watchlist"}}{{else}}{{translate "Add to Watchlist"}}{{/if}}</a>\n    {{/if}}\n</div>\n    \n{{#if showSpecial}}\n<div class="onSaleIcon"></div>\n{{/if}}\n<div class="shopShowDuringReload disablingLoadingContainer">\n    <div class="loadingText">Loading...</div>\n    <div class="loading"></div>\n</div>\n\n{{#with modalDetails}}\n<div class="shopBuyItemModal{{#if ../discount}} showSaveMessage{{/if}}{{#if ../variantGroup}} variantGroup{{/if}}{{#if ../friends}} hasFriends{{/if}}\n{{#if ../guild}} guild{{#if ../hasGuildBuyPermissions}} guildNotEnoughPoints{{else}} guildNoPermissions{{/if}}{{/if}}">\n    <div class="borderedContent">\n        {{#if largeImageUrl}}\n        <div class="largeImage" id="{{id}}Image">\n            <img src="{{largeImageUrl}}" alt="" />\n            {{#if ../variantGroup}}\n            <div class="imageBanner">\n                <h2>{{name}}</h2>\n                {{#if ../youtubeVideoId}}\n                <button class="button-text showVideo">{{translate \'Watch video\'}}</button>\n                {{/if}}\n            </div>\n            {{/if}}\n        </div>\n        {{/if}}\n        {{#if ../youtubeVideoId}}\n        <div class="videoEmbed"{{#if ../selectedVariant}} style="display: none;"{{/if}}>\n            <div class="video deferLoad" data-width="100%" data-height="100%" data-id="{{../youtubeVideoId}}"\n                 data-allowfullscreen="true"></div>\n        </div>\n        {{else}}\n        {{#if ../tencentVideoUrl}}\n        <div class="videoContainer"{{#if ../selectedVariant}} style="display: none;"{{/if}}>\n            <iframe class="video" width="640" height="360" src="{{../tencentVideoUrl}}" frameborder="0" allowfullscreen></iframe>\n        </div>\n        {{/if}}\n        {{/if}}\n\n        <div class="content">\n            <div class="heading">\n                <h1 class="name">{{name}}</h1>\n            </div>\n            <div class="details poeScroll{{#if onSpecial}} onSpecial{{/if}}{{#if discount}} discounted{{/if}}">\n                <div class="description">{{description}}</div>\n                {{#if ../secondaryDescription}}\n                <div class="secondaryDescription">{{../secondaryDescription}}</div>\n                {{/if}}\n                {{#if bundle}}\n                <div class="lineItems">\n                    {{#each items}}\n                    {{#ifCond cost ">" 0}}\n                    <div class="lineItem">\n                        <div class="name">{{quantity}}x {{name}}</div>\n                        {{#ifCond ../bundle \'&&\' ../discount}}\n                        {{#ifCond cost \'<\' 10000}}\n                        <div class="cost">{{cost}}</div>\n                        {{/ifCond}}\n                        {{/ifCond}}\n                    </div>\n                    {{/ifCond}}\n                    {{/each}}\n                </div>\n                {{/if}}\n            </div>\n            {{#if discount}}\n            <div class="savings">\n                <div class="label">{{translate "You save"}}:</div>\n                <div class="value">{{discount}}</div>\n            </div>\n            {{/if}}\n\n            {{#if onSpecial}}\n            {{#ifCond cost "!=" originalCost}}\n            <div class="savings">\n                <div class="label">{{translate "Was"}}:</div>\n                <div class="value">{{originalCost}}</div>\n            </div>\n            {{/ifCond}}\n            <div class="onSaleIcon"></div>\n            {{/if}}\n\n\n            <div class="costRow">\n                {{#if ../friends}}\n                <div class="buy-for-friend poeForm"><label>\n                    <input type="checkbox" class="buy-for-friend-checkbox" value="1">\n                    {{translate "Buy for a friend"}}\n                </label></div>\n                {{/if}}\n                <div class="totalCost">\n                    {{#ifCond ../minCost \'&&\' ../noSelectedVariant}}\n                    {{../minCost}} &mdash; {{../maxCost}}\n                    {{else}}\n                    {{#ifCond cost \'===\' 0}}\n                    {{translate \'Free\'}}\n                    {{else}}\n                    {{cost}}\n                    {{/ifCond}}\n                    {{/ifCond}}\n                </div>\n            </div>\n            {{#ifCond ../variantGroup \'&&\' ../noSelectedVariant}}\n            <span class="button-text selectAVariant">{{translate "Select a variant"}}</span>\n            {{else}}\n            {{#if ../loggedIn}}\n                {{#if ../guild}}\n                <a class="button-text buyButton hidden" href="#" data-quick-buy="{{../quickBuy}}">{{translate "Buy"}}</a>\n                <div class="givePointsToGuild">\n                    {{#if ../isInGuild}}\n                    {{#if ../hasGuildBuyPermissions}}\n                    <div class="guildMessage">{{translate "Your Guild does not have enough points to purchase this item"}}.</div>\n                    {{else}}\n                    <div class="guildMessage">{{translate "You must be a Guild leader to purchase this"}}.</div>\n                    {{/if}}\n                    <a class="button-text shopGivePointsToGuildButton" href="/my-guild/transactions">{{translate "GIVE POINTS TO GUILD"}}</a>\n                    {{else}}\n                    <span class="button-text shopGivePointsToGuildButton shopBuyButtonDisabled" href="/my-guild/transactions">{{translate "Requires a guild"}}</span>\n                    {{/if}}\n                </div>\n                {{else}}\n                {{#ifCond limitedToN \'>\' 0}}\n                <div class="singleOwnedIcon {{#unless owned}}hidden{{/unless}}" alt="{{translate \'Already Owned\'}}" data-owned="{{#if owned}}true{{else}}false{{/if}}"></div>\n                <a class="button-text buyButton {{#if owned}}hidden{{/if}}" href="#" data-quick-buy="{{../quickBuy}}">{{translate "Buy"}}</a>\n                {{/ifCond}}\n                <a class="button-text buyButton hidden" href="#" data-quick-buy="{{../quickBuy}}">{{translate "Buy"}}</a>\n                <a class="button-text buyPointsButton" href="/purchase">{{translate "Buy Points"}}</a>\n                {{/if}}\n            {{else}}\n            <a class="button-text buyPointsButton" href="/purchase">{{translate "Buy Points"}}</a>\n            {{/if}}\n            {{/ifCond}}\n            <div class="purchasingInfo"><span class="loading-inline"></span>{{translate "Purchasing..."}}</div>\n            <div class="purchasedInfo {{#if ../showRemoveWatchlist}}{{onWatchlist}}{{/if}}">{{translate "Purchase complete."}}\n                {{#if ../showRemoveWatchlist}}\n                <div class="remove-watchlist watchlist-message ">{{translate "Do you want to keep this item watchlisted?"}}</div>\n                {{/if}}\n            </div>\n            <div class="errorInfo">\n                <div>{{translate "Failed to purchase."}}</div>\n                <div class="message"></div>\n            </div>\n            <div class="button-text buyButtonDisabled">{{translate "Buy"}}</div>\n            <a class="button-text shopBackButton" href="#">{{translate "Back"}}</a>\n            {{#if ../showRemoveWatchlist}}\n            <div class="remove-watchlist-container remove-watchlist">\n                <a class="watchlist added button-text red hideMessage" href="#" data-item-id="{{id}}">{{translate "Keep"}}</a>\n                <a class="watchlist added button-text" href="#" data-item-id="{{id}}">{{translate "Remove"}}</a>\n            </div>\n            {{/if}}\n        </div>\n        {{#unless ../guild}}\n        {{#if ../friends}}\n        <div class="friends poeForm">\n            <h3>{{translate "Choose a Friend"}}</h3>\n            <div class="friend-selector">\n                {{#each ../friends}}\n                <div data-name="{{this}}" data-item-id="{{../id}}"\n                    class="row {{#ifCond @index \'==\' 0}}selected{{/ifCond}}">{{this}}</div>\n                {{/each}}\n            </div>\n        </div>\n        {{/if}}\n        {{/unless}}\n    </div>\n\n    {{#if ../variantGroup}}\n    <div class="variantSelector">\n        {{#each ../items}}\n        <button class="variant{{#ifCond id \'===\' ../id}} active{{/ifCond}}" data-variant="{{id}}" data-group="{{../../id}}">\n            <img src="{{imageUrl}}" alt="{{translate \'Select {NAME}\' NAME=name}}" title="{{name}}" />\n            {{#ifCond cost "!=" originalCost}}\n            <div class="onSaleIcon"></div>\n            {{/ifCond}}\n        </button>\n        {{/each}}\n    </div>\n    <div class="variantScroll"></div>\n    {{/if}}\n</div>\n{{/with}}'})),define("PoE/View/Microtransactions/Microtransaction",["jquery","Backbone","PoE/Handlebars/TemplateCollection","PoE/Backbone/EventBus","text!PoE/View/Microtransactions/Microtransaction.hbt"],(function(e,t,n,i){var o=["cost","description","discount","id","largeImageUrl","limitedToOne","name","onSpecial","onWatchlist","originalCost","owned"];return t.View.extend({initialize:function(e){var t=this;if(this.friends=e.friends||[],this.selected=e.selected||!1,this.connected=e.connected||!1,this.model.set("isInGuild",e.isInGuild),this.model.set("friends",this.friends),this.model.set("connected",this.connected),this.model.set("loggedIn",e.loggedIn||!1),this.model.set("hasGuildBuyPermissions",e.hasGuildBuyPermissions||!1),this.model.set("noSelectedVariant",!0),this.model.set("selectedVariant",!1),this.$el.addClass("shopItemBase FontinSmallCaps"),this.$el.attr("id",this.model.get("id")),this.model.get("variantGroup")){var n=this.model.get("items").reduce((function(e,t){var n=_slicedToArray(e,2),i=n[0],o=n[1];return[i>t.cost?t.cost:i,o<t.cost?t.cost:o]}),[1/0,0]),r=_slicedToArray(n,2),a=r[0],s=r[1];a===s?this.model.set("cost",a):(this.model.set("minCost",a),this.model.set("maxCost",s)),this.groupDetails=_objectSpread({},o.reduce((function(e,n){return _objectSpread(_objectSpread({},e),{},_defineProperty({},n,t.model.get(n)))}),{}));var l=e.keyword?this.model.get("items").filter((function(t){return t.name.toLowerCase().includes(e.keyword.toLowerCase())})):[];this.updateVariant(1===l.length?l[0]:null,e.reload)}else this.model.set("modalDetails",this.model.toJSON());if(this.model.get("bundle")){if(this.$el.addClass("shopItemPackage"),this.model.has("items")&&0===this.model.get("discount")){var c=this.model.get("items");1===c.length&&c[0].isMysteryPack&&this.model.set("bundleCount",c[0].quantity)}}else this.$el.addClass("shopItem");this.model.get("guild")&&this.$el.addClass("guild"),this.model.get("owned")&&this.$el.addClass("singleItemOwned"),i.on("shop-modal:select-variant",(function(e){if(e.group&&e.group===t.model.get("id")){var n=t.model.get("items").find((function(t){return t.id===e.variant}));n&&t.updateVariant(n)}}))},events:{"click .shopItem-container, .buyButton":"showBuyItemModal","click .watchlist":"toggleWatchlistItem"},updateVariant:function(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n||this.groupDetails;this.model.set("modalDetails",_objectSpread({},o.reduce((function(e,t){return _objectSpread(_objectSpread({},e),{},_defineProperty({},t,r[t]))}),{}))),this.model.set("noSelectedVariant",!n),this.model.set("selectedVariant",n);var a=e("#colorbox"),s=a.is(":visible"),l=s&&a.find(".scroll-content"),c=l.length?l.get(0).scrollLeft:0;this.render().done((function(){var o=t.$el.find(".shopBuyItemModal"),l=r.cost,d=t.model.get("guild"),u=d?!!t.model.get("hasGuildBuyPermissions")&&POE.Shop.guildPoints>=l:POE.Shop.accountPoints>=l;s&&!i&&(e.colorbox.prep(o.show()),POE.Shop.setupModal(o,n&&n.id,u,d),a.find(".scroll-content")&&a.find(".scroll-content").scrollLeft(c))}))},showBuyItemModal:function(t){var n=this;t&&t.preventDefault();var i=this.model.get("selectedVariant"),o=i?i.cost:this.model.get("cost"),r=i?i.id:this.model.get("id"),a=this.model.get("guild"),s=a?!!this.model.get("hasGuildBuyPermissions")&&POE.Shop.guildPoints>=o:POE.Shop.accountPoints>=o;POE.Shop.showBuyItemModal(this.model.get("id"),s,a,r),this.model.get("variantGroup")&&e(document).bind("cbox_cleanup",(function(){n.render()}))},toggleWatchlistItem:function(t){t.preventDefault();var n=!e(t.currentTarget).hasClass("added");POE.Shop.toggleWatchlistItem(this.model.get("id"),n,e(t.currentTarget))},render:function(){var e=this;return n.load("PoE/View/Microtransactions/Microtransaction.hbt").done((function(t){e.$el.html(t(_objectSpread(_objectSpread({},e.model.toJSON()),{},{showSpecial:e.model.get("onSpecial")&&(e.model.get("cost")!==e.model.get("originalCost")||e.model.get("variantGroup"))}))),e.$el.data("item-id",e.model.get("id"))}))}})})),define("PoE/View/Microtransactions/Category",["jquery","Backbone","PoE/Helpers","PoE/View/Microtransactions/Microtransaction","PoE/Shop"],(function(e,t,n,i,o){return t.View.extend({initialize:function(t){var n=this;this.items=t.items||[],this.id=t.id,this.name=t.name,this.friends=t.friends&&t.friends.length>0?t.friends:null,this.accountPoints=t.accountPoints||0,this.guildPoints=t.guildPoints||0,this.connected=t.connected||!1,this.loggedIn=t.loggedIn||!1,this.hasGuildBuyPermissions=t.hasGuildBuyPermissions||!1,this.isInGuild=t.isInGuild,this.loading=!1,POE.Shop=o,this.currentCount=0,this.perPage=this.items.length>0?this.items.length:20,this.currentPage=1,this.total=parseInt(t.total||0),this.keyword=""!==t.keyword?t.keyword:null,this.initSelectedItem(),e(document).bind("cbox_cleanup",(function(){n.selectedItemId=null})),this.$searchText=e(".shopTopBar1 .search-text"),this.$searchForm=e(".shopTopBar1 .search-form"),this.$selectedKeyword=e("#selected-keyword"),this.$searchText&&this.$searchForm&&this.$searchForm.on("submit",(function(e){e.preventDefault(),n.keyword=n.$searchText.val(),n.keyword&&(n.keyword=n.keyword.trim()),n.search()})),this.$selectedKeyword&&this.$selectedKeyword.on("click",(function(e){e.preventDefault(),n.$searchText.val(""),n.keyword=n.$searchText.val(),n.search()})),this.setCategoryData(),this.$el.append(e("<div />",{id:"mtx-list",class:"category"})).append(e("<div />",{class:"top-btn"}).append(e("<span />",{class:"arrow"}))),this.render()},events:{"click .top-btn":"scrollTop"},initSelectedItem:function(){this.selectedItemId=null;var e="#microtransaction-";if(window.location.hash.indexOf(e)>=0){var t=window.location.hash.substring(e.length-1),n=t.indexOf(",");return-1===n?void(this.selectedItemId=t.substring(1)):void(this.selectedItemId=t.substring(1,n))}var i=window&&window.location.toString().match(/shop\/item\/([^\/?#]+)/);i&&(this.selectedItemId=i[1])},scrollTop:function(t){var n=this;t.preventDefault(),e("html, body").animate({scrollTop:0},{duration:300,complete:function(){n.toggleBackToTop()}})},setCategoryData:function(){POE.Shop.setCategoryData({urlId:this.id,accountPoints:this.accountPoints,guildPoints:this.guildPoints,connected:this.connected,name:this.name})},addAll:function(e){var n=this;if(n.foundItem=!1,this.$mtxList){n.appendHtml="";var i=null;this.items.forEach((function(o){o=new t.Model(o),n.renderMtx(o,e),n.selectedItemId===o.get("id")&&(i=o,n.foundItem=!0)})),n.currentCountText.text(n.currentCount),n.counter.toggleClass("hidden",n.currentCount<=1),i&&setTimeout((function(){var e=i.get("cost"),t=i.get("guild"),o=t?POE.Shop.guildPoints>=e:POE.Shop.accountPoints>=e;POE.Shop.showBuyItemModal(n.selectedItemId,o,t)}),300)}},renderMtx:function(e,t){var n=e.get("id");if(!t&&0!==this.$mtxList.find("#".concat(n)).length)return!1;var o=this.selectedItemId===e.get("id"),r=new i({model:e,friends:this.friends,selected:o,connected:this.connected,loggedIn:this.loggedIn,isInGuild:this.isInGuild,hasGuildBuyPermissions:this.hasGuildBuyPermissions,keyword:this.keyword,reload:t});if(r.render(),t)return this.$mtxList.find("#".concat(n)).html(r.$el.html()),!1;this.$mtxList[0].appendChild(r.$el[0]),++this.currentCount},reload:function(e){var t=this,n=this;n.beforeLoad(),n.$mtxList.find("#".concat(e," .shopShowDuringReload")).show(),n.getItems(e).then((function(i){0===i.items.length&&n.$mtxList.find("#".concat(e)).remove(),t.items=i.items,n.setResponse(i,!0)}))},beforeLoad:function(){var e=n.translate("Loading...");this.accountCurrentCoinValueEls.text(e),this.guildCurrentCoinValueEls.text(e),this.loading=!0},setResponse:function(e,t){var n=this;n.addAll(t),n.$loading.hide(),n.$mtxList.fadeIn(100),n.loadingMessage.hide(),n.loading=!1,e&&(n.connected!==e.connected&&n.$mtxList.find(".buyButton").toggleClass("buyButtonDisabled",!e.connected),n.accountPoints=e.accountPoints,n.guildPoints=e.guildPoints,n.connected=e.connected,n.accountCurrentCoinValueEls.text(n.accountPoints),n.guildCurrentCoinValueEls.text(n.guildPoints),n.setCategoryData())},loadNextPage:function(){var e=this;e.loading||e.total<=e.currentCount||(this.currentPage=++this.currentPage,this.beforeLoad(),e.loadingMessage.show(),this.getItems().then((function(t){e.items=t.items,0==t.items.length&&e.total!=e.currentCount&&(e.total=e.currentCount,e.totalText.text(e.total)),e.setResponse(t,!1)})))},isVisible:function(e){var t=e.getBoundingClientRect(),n=t.top;e=e.parentNode;do{t=e.getBoundingClientRect(),e=e.parentNode}while(e!=document.body);return n<=1.5*document.documentElement.clientHeight},checkLoadNextItems:function(){this.isVisible(document.querySelector(".footer"))&&this.loadNextPage()},getItems:function(t){var n=this,i="";if(t)i="?itemId=".concat(t);else{var o=(this.currentPage-1)*this.perPage;i="?offset=".concat(o)}return this.keyword&&(i+="&search=".concat(this.keyword)),new Promise((function(t,o){e.ajax({url:"/api/shop-microtransaction-categories/".concat(n.id).concat(i),type:"GET",dataType:"json",success:function(e){t(e)},error:function(e){o(e)}})}))},toggleBackToTop:function(){e(window).scrollTop()<88?"block"===this.backToTopButton.css("display")&&this.backToTopButton.fadeOut(300):"none"===this.backToTopButton.css("display")&&this.backToTopButton.fadeIn(300)},search:function(){var e=this;this.$loading.show(),this.$mtxList.empty(),this.beforeLoad(),this.currentCount=0,this.currentPage=1,this.total=0,this.totalText.text(this.total),this.totalText.text(this.total),this.counter.toggleClass("hidden",!0),this.updateUrl(),this.getItems().then((function(t){e.items=t.items,e.total=t.total,e.totalText.text(t.total),e.setResponse(t,!1)}))},updateUrl:function(){if(history.pushState){var e="".concat(window.location.protocol,"//").concat(window.location.host).concat(window.location.pathname).concat(""!=this.keyword?"?search="+this.keyword:"");window.history.pushState({path:e},"",e)}this.$selectedKeyword.text(this.keyword),this.$selectedKeyword.parents(".search-results-text").toggleClass("hidden",""==this.keyword)},render:function(){var t=this,n=this;n.$mtxList=n.$el.find("#mtx-list"),n.$mtxList.on("updateMtx",(function(e,t){n.reload(t.itemId)})),n.accountCurrentCoinValueEls=e(".shopCurrentCoinValue.account"),n.guildCurrentCoinValueEls=e(".shopCurrentCoinValue.guild"),n.$loading=e("#shop-item-loading"),n.loadingMessage=e("#loading-message-container"),n.currentCountText=e("#current-count"),n.$emptyMessage=e("#empty-message"),n.totalText=e("#total-count"),n.counter=e("#counter"),n.backToTopButton=n.$el.find(".top-btn"),n.setResponse(null,!1),this.$emptyMessage&&this.$emptyMessage.length&&(0!==this.items.length||this.keyword?this.$emptyMessage.hide():this.$emptyMessage.show()),n.selectedItemId&&!n.foundItem&&n.getItems(n.selectedItemId).then((function(e){t.items=e.items,n.addAll()})),n.total>n.currentCount&&(window.addEventListener("scroll",(function(){n.checkLoadNextItems()})),n.checkLoadNextItems());var i=null;window.addEventListener("scroll",(function(){null!==i&&clearTimeout(i),i=setTimeout((function(){n.toggleBackToTop()}),500)})),n.toggleBackToTop()}})})),define("default/showcase-pins",["jquery","PoE/Helpers"],(function(e,t){e(document).ready((function(){e(".showcase-pin.button.add").click((function(n){var i=e(this);e.ajax({url:"/api/account/showcase-pins",dataType:"json",contentType:"application/json",data:JSON.stringify(i.data()),type:"POST",success:function(n){e(".showcase-message").length?e(".showcase-message").html(t.translate("Added pin")).animate({opacity:1},800,(function(){setTimeout((function(){e(".showcase-message").animate({opacity:0},1500)}),2e3)})):alert(t.translate("Added pin")),i.hide();try{getShowcasePins()}catch(e){}},error:function(e){alert(t.translate("There was an error adding this pin"))}})}))}))})),define("default/private-messages/compose",["jquery"],(function(e){e(document).ready((function(){e("#pm-form").on("click",".remove",(function(t){var n=e(this).closest("fieldset");n.find("ul.recipients > li").length>1?(e(this).unbind("click"),e(this).parent().slideUp("fast").promise().done((function(){e(this).remove()}))):n.remove(),t.preventDefault()}))}))})),define("default/private-messages/folder-view",["jquery"],(function(e){e(document).ready((function(){e("#select-all").on("click",(function(t){e(".pm-list .controls input[type=checkbox]").prop("checked",!0),t.preventDefault()})),e("#deselect-all").on("click",(function(t){e(".pm-list .controls input[type=checkbox]").prop("checked",!1),t.preventDefault()}));var t=e("#pm-list-controls .view-mode");t.change((function(){window.location.search="?mode="+e(this).val()})),t.prop("disabled",!1)}))})),define("PoE/Form/CharacterLimitCounter",["PoE/Helpers"],(function(e){return{init:function(e){if(e){var t=this.getCounterSelector(e);document.getElementById(t)||e.insertAdjacentHTML("afterend",'<div id="'+t+'" class="character-limit-count"></div>'),this.render(e);var n=this;e.addEventListener("input",(function(){n.render(this)}))}},getCounterSelector:function(e){return(null==e?"":e.id+"-")+"character-count"},countCharacters:function(e){var t=e.getAttribute("maxlength");if(t&&!((t=parseInt(t))<=0))return t-e.value.length},renderCharactersMessage:function(t,n){var i="";i=n<=0?e.translate("You have reached the maximum number of characters."):1==n?n+" "+e.translate("character left"):n+" "+e.translate("characters left");var o=document.getElementById(t);o&&(o.textContent=i)},render:function(e){var t=this.getCounterSelector(e),n=this.countCharacters(e);this.renderCharactersMessage(t,n)}}})),define("default/shop/divination-cards",["jquery","PoE/Form/CharacterLimitCounter","PoE/View/DivinationCard/Preview"],(function(e,t,n){return{init:function(){var i=this,o=document.getElementsByTagName("input"),r=document.getElementsByTagName("textarea"),a=new n({el:e(document).find(".card-container"),model:this.getModel()});Array.prototype.forEach.call(o,(function(e){"text"===e.type&&(t.init(e),e.addEventListener("input",(function(e){a.model=i.getModel(),a.render()})))})),Array.prototype.forEach.call(r,(function(e){t.init(e),e.addEventListener("input",(function(e){"flavourText"==e.currentTarget.id&&(a.model=i.getModel(),a.render())}))}))},getArtFilePath:function(){if(document.getElementById("cardImage")&&document.getElementById("cardImage").value)return null;if(document.getElementById("cardName").value){var e=document.getElementById("cardName").value.replace(/^(.)|\s+(.)/g,(function(e){return e.toUpperCase()}));return"divination-card/"+(e=e.replace(/ |\'/g,""))+".png"}return null},getModel:function(){var e=document.getElementById("status"),t=document.getElementById("cardImage");return{name:document.getElementById("cardName").value,flavourText:document.getElementById("flavourText").value,reward:null,artFilePath:this.getArtFilePath(),showImage:e&&"submitted"!=e.value&&"returned"!=e.value,cardImage:t?t.value:null}}}})),define("main",["plugins","PoE/Environment/Font","PoE/Loader","PoE/Item/Item","PoE/BetaCountdown","PoE/Item/DeferredItemRenderer","PoE/Forum","PoE/Forum/Thread/Autosave","PoE/Forum/Thread/Tags","PoE/Forum/Thread/DatePicker","PoE/View/Profile/Badges","PoE/Forum/Post/Autosave","PoE/Form","PoE/Shop","PoE/Profile/SelectAvatar","PoE/Ladder/Ladder","PoE/Widget/League/Ladder/Ladder","PoE/Inventory/InventoryControls","PoE/Widget/Guild/MemberPanel","PoE/Widget/Guild/LeaderPanel","PoE/Widget/Guild/AccreditTransactionsPanel","PoE/Widget/TwitchTV","PoE/Widget/YoutubeModal","PoE/Widget/Countdown","PoE/Widget/R16Label","PoE/Widget/Season/SeasonInfo","PoE/Widget/Season/Ladder/Ladder","PoE/Widget/League/Event/Event","PoE/Widget/ProfileLink/TwitchPopup","PoE/Shop/XsollaPaymentWidget","PoE/Shop/KakaoPaymentWidget","PoE/Widget/League/EventCalendar/EventCalendar","PoE/View/Season/ViewSignatureRaces","PoE/View/Season/PlayerHistory","PoE/View/Season/PlayerHistoryViewer","PoE/View/Profile/ShowcasePins","PoE/Form/Account/SignUp","PoE/Form/Account/LostPassword","PoE/Form/Account/SteamSignUp","PoE/Profile/FollowAccount","PoE/Inventory/LinkedStashRenderer","PoE/Widget/GuildStashHistory/Viewer","PoE/View/Widget/Modal","PoE/View/Widget/ConfirmDialog","PoE/PrivateLeague/PrivateLeague","PoE/Ascendancy/AscendancyRenderer","PoE/Ascendancy/Ascendancy","PoE/View/DivinationCard/Preview","PoE/View/Microtransactions/Category","default/showcase-pins","default/private-messages/compose","default/private-messages/folder-view","default/shop/divination-cards"],(function(e,t){e(window).resize((function(){e("body > .container").css("min-height",e(window).height())})),t.loadFonts(),e(".header > .navigation > li > a").on("touchstart",(function(t){var n=e(this);n.is(":hover")||n.data("touch-prevent","true")})).on("click",(function(t){var n=e(this);n.data("touch-prevent")&&(t.preventDefault(),n.data("touch-prevent",""))}))}));